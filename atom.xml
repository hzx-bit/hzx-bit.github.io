<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>hzx&#39;s blog</title>
  
  
  <link href="http://example.com/atom.xml" rel="self"/>
  
  <link href="http://example.com/"/>
  <updated>2024-12-21T14:23:00.229Z</updated>
  <id>http://example.com/</id>
  
  <author>
    <name>huangzhixin</name>
    
  </author>
  
  <generator uri="https://hexo.io/">Hexo</generator>
  
  <entry>
    <title>es6</title>
    <link href="http://example.com/2024/12/20/es6/"/>
    <id>http://example.com/2024/12/20/es6/</id>
    <published>2024-12-20T07:02:49.000Z</published>
    <updated>2024-12-21T14:23:00.229Z</updated>
    
    <content type="html"><![CDATA[<h1 id="ES6新特性"><a href="#ES6新特性" class="headerlink" title="ES6新特性"></a>ES6新特性</h1><div class="story post-story"><h2 id="let"><a href="#let" class="headerlink" title="let"></a>let</h2><ul><li>变量不能重复声明</li><li>产生块级作用域</li><li>不存在变量提升</li><li>不影响作用域链</li></ul></div><div class="story post-story"><h2 id="const"><a href="#const" class="headerlink" title="const"></a>const</h2><ul><li>声明常量，要赋初始值，不能重复声明</li><li>产生块级作用域</li><li>对数组或对象元素的修改，不算对常量的修改</li><li>不存在变量提升</li><li>不影响作用域链</li></ul><h3 id="作用域"><a href="#作用域" class="headerlink" title="作用域"></a>作用域</h3><ul><li><p>局部作用域</p><ul><li>函数作用域：函数内部声明的变量只能在函数内部访问</li><li>块作用域：使用{}包裹的代码块内部声明的变量外部有可能无法访问<ul><li>let和const产生块作用域</li><li>var不会产生块作用域</li></ul></li></ul></li><li><p>全局作用域：<code>&lt;script&gt;</code>标签和js文件的最外层，声明的变量在其他任何作用域都能访问</p><ul><li>window对象动态添加的属性也是全局的</li><li>函数中未使用任何关键字声明的变量也是全局的</li></ul></li><li><p>作用域链：优先查找当前，依次查找父级作用域</p></li></ul><h3 id="闭包"><a href="#闭包" class="headerlink" title="闭包"></a>闭包</h3><ul><li>闭包 &#x3D; 内层函数+外层函数的变量</li><li>作用：函数内部可以访问函数外部的变量</li><li>闭包可能会引起内存泄漏</li></ul><h3 id="变量和函数提升"><a href="#变量和函数提升" class="headerlink" title="变量和函数提升"></a>变量和函数提升</h3><p>代码执行前，所有var声明的变量被提升到当前作用域的最前面。只提升声明，不提升赋值。</p><p>代码执行前，所有函数声明被提升到当前作用域的最前面。</p></div><div class="story post-story"><h2 id="解构赋值"><a href="#解构赋值" class="headerlink" title="解构赋值"></a>解构赋值</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">//数组解构赋值</span><br><span class="line">const F4 = [&#x27;小沈阳&#x27;,&#x27;刘能&#x27;,&#x27;赵四&#x27;,&#x27;宋小宝&#x27;];</span><br><span class="line">const [xiao,liu,zhao,song]= F4;</span><br><span class="line">//对象解构赋值</span><br><span class="line">const obj = &#123;</span><br><span class="line">name:&#x27;hzx&#x27;,</span><br><span class="line">age:18,</span><br><span class="line">sayHello: function()&#123;</span><br><span class="line">console.log(&#x27;hello&#x27;);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">const &#123;name,age,sayHello&#125; = obj;</span><br></pre></td></tr></table></figure></div><div class="story post-story"><h2 id="模板字符串"><a href="#模板字符串" class="headerlink" title="模板字符串"></a>模板字符串</h2><ul><li>声明方式：&#96;&#96; </li><li>可以直接出现换行符</li><li>${}实现字符串拼接</li></ul></div><div class="story post-story"><h2 id="箭头函数"><a href="#箭头函数" class="headerlink" title="箭头函数"></a>箭头函数</h2><ul><li>func &#x3D; ()&#x3D;&gt;{}</li><li>this是静态的，始终指向函数声明时所在作用域下的this</li><li>不能作为构造函数</li><li>不能使用arguments参数</li><li>形参只有一个可以省略(),代码语句只有一句return可以省略{return}</li><li>适用于定时器和数组方法，不适用于函数回调和对象方法</li></ul></div><div class="story post-story"><h2 id="rest参数"><a href="#rest参数" class="headerlink" title="rest参数"></a>rest参数</h2><ul><li>func(…args){}</li><li>必须放在参数列表最后</li></ul><h3 id="与arguments的区别"><a href="#与arguments的区别" class="headerlink" title="与arguments的区别"></a>与arguments的区别</h3><ul><li>语法：arguments是一个内置对象，而rest参数是通过…语法创建的。</li><li>类型：arguments是一个类数组对象，而rest参数是一个真正的数组。</li><li>位置：rest参数必须放在函数参数列表的最后面，而arguments对象在任何函数中都可用。</li><li>功能：rest参数提供了一个数组，可以直接使用数组的方法，而arguments对象需要转换才能使用数组方法。</li></ul></div><div class="story post-story"><h2 id="扩展运算符"><a href="#扩展运算符" class="headerlink" title="扩展运算符"></a>扩展运算符</h2><p><code>...</code>将数组转化为逗号分隔参数序列</p></div><div class="story post-story"><h2 id="Symbol"><a href="#Symbol" class="headerlink" title="Symbol"></a>Symbol</h2><ul><li>Symbol的值是唯一的，用来解决命名冲突问题</li><li>Symbol值不能与其他数据进行运算</li><li>Symbol定义的对象属性不能使用for in或for of循环遍历，但是可以使用Object.getOwnPropertySymbols() 和 Reflect.ownKeys()来获取对象的所有键名</li></ul></div><div class="story post-story"><h2 id="迭代器"><a href="#迭代器" class="headerlink" title="迭代器"></a>迭代器</h2><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> banji = &#123;</span><br><span class="line">            <span class="attr">name</span>:<span class="string">&quot;终极一班&quot;</span>,</span><br><span class="line">            <span class="attr">students</span>:[</span><br><span class="line">                <span class="string">&#x27;xiaoming&#x27;</span>,</span><br><span class="line">                <span class="string">&#x27;xiaoning&#x27;</span>,</span><br><span class="line">                <span class="string">&#x27;xiaotian&#x27;</span>,</span><br><span class="line">                <span class="string">&#x27;knight&#x27;</span></span><br><span class="line">            ],</span><br><span class="line">            [<span class="title class_">Symbol</span>.<span class="property">iterator</span>]()&#123;</span><br><span class="line">                <span class="keyword">let</span> index = <span class="number">0</span>;</span><br><span class="line">                <span class="keyword">return</span> &#123;</span><br><span class="line">                    <span class="attr">next</span>:<span class="function">()=&gt;</span>&#123;</span><br><span class="line">                        <span class="keyword">if</span>(index&lt;<span class="variable language_">this</span>.<span class="property">students</span>.<span class="property">length</span>)&#123;</span><br><span class="line">                            <span class="keyword">const</span> res = &#123;<span class="attr">value</span>:<span class="variable language_">this</span>.<span class="property">students</span>[index],<span class="attr">done</span>:<span class="literal">false</span>&#125;</span><br><span class="line">                            index++</span><br><span class="line">                            <span class="keyword">return</span> res</span><br><span class="line">                        &#125; </span><br><span class="line">                        <span class="keyword">return</span> &#123;<span class="attr">value</span>: <span class="literal">undefined</span>, <span class="attr">done</span>:<span class="literal">true</span>&#125;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">let</span> v <span class="keyword">of</span> banji)&#123;</span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">log</span>(v)</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">const</span> iterator = banji[<span class="title class_">Symbol</span>.<span class="property">iterator</span>]()</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(iterator.<span class="title function_">next</span>())</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(iterator.<span class="title function_">next</span>())</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(iterator.<span class="title function_">next</span>())</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(iterator.<span class="title function_">next</span>())</span><br><span class="line"> <span class="variable language_">console</span>.<span class="title function_">log</span>(iterator.<span class="title function_">next</span>())</span><br><span class="line"><span class="comment">//输出</span></span><br><span class="line">xiaoming</span><br><span class="line">xiaoning</span><br><span class="line">xiaotian</span><br><span class="line">knight</span><br><span class="line">&#123;<span class="attr">value</span>: <span class="string">&#x27;xiaoming&#x27;</span>, <span class="attr">done</span>: <span class="literal">false</span>&#125;<span class="attr">done</span>: <span class="literal">false</span></span><br><span class="line">&#123;<span class="attr">value</span>: <span class="string">&#x27;xiaoning&#x27;</span>, <span class="attr">done</span>: <span class="literal">false</span>&#125;</span><br><span class="line">&#123;<span class="attr">value</span>: <span class="string">&#x27;xiaotian&#x27;</span>, <span class="attr">done</span>: <span class="literal">false</span>&#125;</span><br><span class="line">&#123;<span class="attr">value</span>: <span class="string">&#x27;knight&#x27;</span>, <span class="attr">done</span>: <span class="literal">false</span>&#125;</span><br><span class="line">&#123;<span class="attr">value</span>: <span class="literal">undefined</span>, <span class="attr">done</span>: <span class="literal">true</span>&#125;</span><br></pre></td></tr></table></figure></div><div class="story post-story"><h2 id="生成器"><a href="#生成器" class="headerlink" title="生成器"></a>生成器</h2><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> * <span class="title function_">generator</span>(<span class="params"></span>)&#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;111&#x27;</span>)</span><br><span class="line">    <span class="keyword">yield</span> <span class="string">&#x27;一只没有耳朵&#x27;</span></span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;222&#x27;</span>)</span><br><span class="line">    <span class="keyword">yield</span> <span class="string">&#x27;一只没有尾巴&#x27;</span></span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;333&#x27;</span>)</span><br><span class="line">    <span class="keyword">yield</span> <span class="string">&#x27;真奇怪&#x27;</span></span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;444&#x27;</span>)</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">const</span> iterator = <span class="title function_">generator</span>()</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">let</span> v <span class="keyword">of</span> <span class="title function_">generator</span>())&#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(v)</span><br><span class="line">&#125;</span><br><span class="line">iterator.<span class="title function_">next</span>()</span><br><span class="line">iterator.<span class="title function_">next</span>()</span><br><span class="line">iterator.<span class="title function_">next</span>()</span><br><span class="line">iterator.<span class="title function_">next</span>()</span><br><span class="line"><span class="comment">//输出</span></span><br><span class="line"><span class="number">111</span></span><br><span class="line">一只没有耳朵</span><br><span class="line"><span class="number">222</span></span><br><span class="line">一只没有尾巴</span><br><span class="line"><span class="number">333</span></span><br><span class="line">真奇怪</span><br><span class="line"><span class="number">444</span></span><br><span class="line"><span class="number">111</span></span><br><span class="line"><span class="number">222</span></span><br><span class="line"><span class="number">333</span></span><br><span class="line"><span class="number">444</span></span><br></pre></td></tr></table></figure><h3 id="应用实例"><a href="#应用实例" class="headerlink" title="应用实例"></a>应用实例</h3><ol><li>解决回调地狱</li></ol><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//回调地狱</span></span><br><span class="line"><span class="comment">// setTimeout(() =&gt; &#123;</span></span><br><span class="line"><span class="comment">//     console.log(&#x27;111&#x27;)</span></span><br><span class="line"><span class="comment">//     setTimeout(() =&gt; &#123;</span></span><br><span class="line"><span class="comment">//         console.log(&#x27;222&#x27;)</span></span><br><span class="line"><span class="comment">//         setTimeout(() =&gt; &#123;</span></span><br><span class="line"><span class="comment">//             console.log(&#x27;333&#x27;)</span></span><br><span class="line"><span class="comment">//         &#125;, 3000)</span></span><br><span class="line"><span class="comment">//     &#125;, 2000)</span></span><br><span class="line"><span class="comment">// &#125;, 1000)</span></span><br><span class="line"><span class="comment">//生成器函数解决回调地狱</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">one</span>(<span class="params"></span>)&#123;</span><br><span class="line">    <span class="built_in">setTimeout</span>(<span class="function">()=&gt;</span>&#123;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;111&#x27;</span>)</span><br><span class="line">        iterator.<span class="title function_">next</span>()</span><br><span class="line">    &#125;,<span class="number">1000</span>)</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">function</span> <span class="title function_">two</span>(<span class="params"></span>)&#123;</span><br><span class="line">    <span class="built_in">setTimeout</span>(<span class="function">()=&gt;</span>&#123;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;222&#x27;</span>)</span><br><span class="line">        iterator.<span class="title function_">next</span>()</span><br><span class="line">    &#125;,<span class="number">2000</span>)</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">function</span> <span class="title function_">three</span>(<span class="params"></span>)&#123;</span><br><span class="line">    <span class="built_in">setTimeout</span>(<span class="function">()=&gt;</span>&#123;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;333&#x27;</span>)</span><br><span class="line">        iterator.<span class="title function_">next</span>()</span><br><span class="line">    &#125;,<span class="number">3000</span>)</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">function</span> * <span class="title function_">generator</span>(<span class="params"></span>)&#123;</span><br><span class="line">    <span class="keyword">yield</span> <span class="title function_">one</span>()</span><br><span class="line">    <span class="keyword">yield</span> <span class="title function_">two</span>()</span><br><span class="line">    <span class="keyword">yield</span> <span class="title function_">three</span>()</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">let</span> iterator = <span class="title function_">generator</span>()</span><br><span class="line">iterator.<span class="title function_">next</span>()</span><br></pre></td></tr></table></figure><ol start="2"><li>异步编程</li></ol><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">getUsers</span>(<span class="params"></span>)&#123;</span><br><span class="line">    <span class="built_in">setTimeout</span>(<span class="function">()=&gt;</span>&#123;</span><br><span class="line">        <span class="keyword">let</span> data = <span class="string">&#x27;用户数据&#x27;</span></span><br><span class="line">        iterator.<span class="title function_">next</span>(data)</span><br><span class="line">    &#125;,<span class="number">1000</span>)</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">function</span> <span class="title function_">getOrders</span>(<span class="params"></span>)&#123;</span><br><span class="line">    <span class="built_in">setTimeout</span>(<span class="function">()=&gt;</span>&#123;</span><br><span class="line">        <span class="keyword">let</span> data = <span class="string">&#x27;订单数据&#x27;</span></span><br><span class="line">        iterator.<span class="title function_">next</span>(data)</span><br><span class="line">    &#125;,<span class="number">2000</span>)</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">function</span> <span class="title function_">getGoods</span>(<span class="params"></span>)&#123;</span><br><span class="line">    <span class="built_in">setTimeout</span>(<span class="function">()=&gt;</span>&#123;</span><br><span class="line">        <span class="keyword">let</span> data = <span class="string">&#x27;商品数据&#x27;</span></span><br><span class="line">        iterator.<span class="title function_">next</span>(data)</span><br><span class="line">    &#125;,<span class="number">3000</span>)</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">function</span> * <span class="title function_">generator</span>(<span class="params"></span>)&#123;</span><br><span class="line">    <span class="keyword">const</span> users = <span class="keyword">yield</span> <span class="title function_">getUsers</span>()</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(users)</span><br><span class="line">    <span class="keyword">const</span> orders = <span class="keyword">yield</span> <span class="title function_">getOrders</span>()</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(orders)</span><br><span class="line">    <span class="keyword">const</span> goods = <span class="keyword">yield</span> <span class="title function_">getGoods</span>()</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(goods)</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">let</span> iterator = <span class="title function_">generator</span>()</span><br><span class="line">iterator.<span class="title function_">next</span>()</span><br></pre></td></tr></table></figure></div><div class="story post-story"><h2 id="Promise"><a href="#Promise" class="headerlink" title="Promise"></a>Promise</h2><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> fs = <span class="built_in">require</span>(<span class="string">&quot;fs&quot;</span>)</span><br><span class="line"><span class="keyword">const</span> p =  <span class="keyword">new</span> <span class="title class_">Promise</span>(<span class="function">(<span class="params">resolve,reject</span>)=&gt;</span>&#123;</span><br><span class="line">    fs.<span class="title function_">readFile</span>(<span class="string">&#x27;./静夜思.md&#x27;</span>,<span class="function">(<span class="params">err,data</span>)=&gt;</span>&#123;</span><br><span class="line">        <span class="title function_">resolve</span>(data)</span><br><span class="line">    &#125;)</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">p.<span class="title function_">then</span>(<span class="function"><span class="params">value</span>=&gt;</span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Promise</span>(<span class="function">(<span class="params">resolve,reject</span>)=&gt;</span>&#123;</span><br><span class="line">        fs.<span class="title function_">readFile</span>(<span class="string">&#x27;./琵琶行.md&#x27;</span>,<span class="function">(<span class="params">err,data</span>)=&gt;</span>&#123;</span><br><span class="line">            <span class="title function_">resolve</span>([...value,data])</span><br><span class="line">        &#125;)</span><br><span class="line">    &#125;)</span><br><span class="line">&#125;).<span class="title function_">then</span>(<span class="function"><span class="params">value</span>=&gt;</span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Promise</span>(<span class="function">(<span class="params">resolve,reject</span>)=&gt;</span>&#123;</span><br><span class="line">        fs.<span class="title function_">readFile</span>(<span class="string">&#x27;./滕王阁序.md&#x27;</span>,<span class="function">(<span class="params">err,data</span>)=&gt;</span>&#123;</span><br><span class="line">            <span class="title function_">resolve</span>([...value,data])</span><br><span class="line">        &#125;)</span><br><span class="line">    &#125;)</span><br><span class="line">&#125;).<span class="title function_">then</span>(<span class="function"><span class="params">value</span>=&gt;</span>&#123;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(value.<span class="title function_">join</span>(<span class="string">&#x27;\n&#x27;</span>))</span><br><span class="line">&#125;</span><br><span class="line">)</span><br></pre></td></tr></table></figure></div><div class="story post-story"><h2 id="Set"><a href="#Set" class="headerlink" title="Set"></a>Set</h2><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> arr1 = [<span class="number">3</span>,<span class="number">1</span>,<span class="number">4</span>,<span class="number">1</span>,<span class="number">5</span>,<span class="number">9</span>,<span class="number">2</span>,<span class="number">6</span>]</span><br><span class="line"><span class="keyword">const</span> arr2 = [<span class="number">4</span>,<span class="number">8</span>,<span class="number">6</span>,<span class="number">9</span>]</span><br><span class="line"><span class="keyword">const</span> s2 = <span class="keyword">new</span> <span class="title class_">Set</span>(arr2)</span><br><span class="line"><span class="comment">//数组去重</span></span><br><span class="line"><span class="keyword">let</span> result = [...<span class="keyword">new</span> <span class="title class_">Set</span>(arr1)]</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(result)</span><br><span class="line"><span class="comment">//求交集</span></span><br><span class="line"><span class="keyword">const</span> intersection = [...<span class="keyword">new</span> <span class="title class_">Set</span>(arr1)].<span class="title function_">filter</span>(<span class="function"><span class="params">item</span>=&gt;</span>s2.<span class="title function_">has</span>(item))</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(intersection)</span><br><span class="line"><span class="comment">//求并集</span></span><br><span class="line"><span class="keyword">const</span> union = [...<span class="keyword">new</span> <span class="title class_">Set</span>([...arr1,...arr2])]</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(union)</span><br><span class="line"><span class="comment">//求差集</span></span><br><span class="line"><span class="keyword">const</span> diff = [...<span class="keyword">new</span> <span class="title class_">Set</span>(arr1)].<span class="title function_">filter</span>(<span class="function"><span class="params">item</span>=&gt;</span>!s2.<span class="title function_">has</span>(item))</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(diff)</span><br></pre></td></tr></table></figure></div><div class="story post-story"><h2 id="class"><a href="#class" class="headerlink" title="class"></a>class</h2><h3 id="构造函数执行过程"><a href="#构造函数执行过程" class="headerlink" title="构造函数执行过程"></a>构造函数执行过程</h3><ol><li>创建新对象</li><li>构造函数this指向新对象</li><li>执行构造函数代码，修改this，添加新的属性</li><li>返回新对象</li></ol><h3 id="原型对象"><a href="#原型对象" class="headerlink" title="原型对象"></a>原型对象</h3><ul><li>每个构造函数都有一个<strong>prototype属性</strong>，指向<strong>原型对象</strong></li><li>这个对象可以挂载函数，对象实例化不会多次创建原型上的函数，节约内存</li><li>构造函数通过原型分配的函数是所有对象所<strong>共享</strong>的，可以将不变的方法直接定义在prototype对象上，这样所有对象的实例就可以共享这些方法</li><li>构造函数和原型对象中的this都指向实例化的对象</li></ul><h3 id="constructor-NaN"><a href="#constructor-NaN" class="headerlink" title="constructor"></a>constructor</h3><p>原型对象上的构造器，指向构造函数</p><h3 id="对象原型"><a href="#对象原型" class="headerlink" title="对象原型"></a>对象原型</h3><p>实例对象的<code>__proto__</code>属性,指向构造函数的原型对象</p><h3 id="原型链"><a href="#原型链" class="headerlink" title="原型链"></a>原型链</h3><ol><li>当访问一个对象的属性和方法时，首先查找这个对象自身有没有该属性。</li><li>如果没有就查找它的原型（就是<code>__proto__</code>指向的prototype原型对象。</li><li>如果还没有就继续查找原型对象的原型，直至查找到null</li><li>可以用 instanceof 运算符检测构造函数的prototype属性是否出现在某个实例对象的原型链上。</li></ol></div>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;ES6新特性&quot;&gt;&lt;a href=&quot;#ES6新特性&quot; class=&quot;headerlink&quot; title=&quot;ES6新特性&quot;&gt;&lt;/a&gt;ES6新特性&lt;/h1&gt;&lt;div class=&quot;story post-story&quot;&gt;&lt;h2 id=&quot;let&quot;&gt;&lt;a href=&quot;#let&quot;</summary>
      
    
    
    
    <category term="学习笔记" scheme="http://example.com/categories/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/"/>
    
    
    <category term="es6" scheme="http://example.com/tags/es6/"/>
    
  </entry>
  
  <entry>
    <title>分布式实验4_多物理机环境搭建和词频统计</title>
    <link href="http://example.com/2024/12/20/%E5%88%86%E5%B8%83%E5%BC%8F%E5%AE%9E%E9%AA%8C4-%E5%A4%9A%E7%89%A9%E7%90%86%E6%9C%BA%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA%E5%92%8C%E8%AF%8D%E9%A2%91%E7%BB%9F%E8%AE%A1/"/>
    <id>http://example.com/2024/12/20/%E5%88%86%E5%B8%83%E5%BC%8F%E5%AE%9E%E9%AA%8C4-%E5%A4%9A%E7%89%A9%E7%90%86%E6%9C%BA%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA%E5%92%8C%E8%AF%8D%E9%A2%91%E7%BB%9F%E8%AE%A1/</id>
    <published>2024-12-20T02:34:38.000Z</published>
    <updated>2024-12-20T03:24:54.712Z</updated>
    
    <content type="html"><![CDATA[<h1 id="实验4-多物理机环境搭建和词频统计"><a href="#实验4-多物理机环境搭建和词频统计" class="headerlink" title="实验4 多物理机环境搭建和词频统计"></a>实验4 多物理机环境搭建和词频统计</h1><div class="story post-story"><h2 id="实验环境搭建及集群配置"><a href="#实验环境搭建及集群配置" class="headerlink" title="实验环境搭建及集群配置"></a>实验环境搭建及集群配置</h2><h3 id="软件环境"><a href="#软件环境" class="headerlink" title="软件环境"></a>软件环境</h3><ul><li>CentOS-7.5</li><li>Hadoop3.1.3</li><li>jdk-8</li></ul><h3 id="集群配置"><a href="#集群配置" class="headerlink" title="集群配置"></a>集群配置</h3><p>在实验一中已经完成了Hadoop集群环境的搭建，包括静态ip的设置、jdk配置、无密钥登录的ssh服务、以及hadoop集群的配置。</p></div><div class="story post-story"><h2 id="实验过程"><a href="#实验过程" class="headerlink" title="实验过程"></a>实验过程</h2><ol><li><p>在hadoop的sbin目录下启动Hadoop集群后先查看liveDataNode数量</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">/sbin/start-all.sh</span><br><span class="line">hadoop dfsadmin -report</span><br></pre></td></tr></table></figure><p>![](C:\Users\33100\Pictures\Screenshots\屏幕截图 2024-12-20 104703.png)</p></li><li><p>在实验三中已经将词频统计的代码打包成jar包，并通过ssh上传到本地虚拟机了，所以直接查看jar是否上传成功</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">ls</span> /home/hadoop</span><br></pre></td></tr></table></figure><p>![](C:\Users\33100\Pictures\Screenshots\屏幕截图 2024-12-20 105029.png)</p></li><li><p>创建HDFS数据目录<br>创建一个多级目录，保存MapReduce的输入文件,这里继续使用之前实验三生成的input目录；创建一个目录，保存MapReduce的输出文件，最后查看（由于实验三中运行生成了output文件所以要先删除原本的）</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">hdfs dfs -<span class="built_in">rm</span> -r /user/hadoop/output</span><br><span class="line">hadoop fs -<span class="built_in">mkdir</span> -p /user/hadoop/output</span><br><span class="line">hadoop fs -<span class="built_in">ls</span> /user/hadoop</span><br></pre></td></tr></table></figure><p>![](C:\Users\33100\Pictures\Screenshots\屏幕截图 2024-12-20 111013.png)</p></li><li><p>创建一个文件用于词频统计并上传到HDFS的input文件中,这里继续使用之前实验三上传的input.txt</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hadoop fs -<span class="built_in">ls</span> /user/hadoop/input</span><br></pre></td></tr></table></figure><p>![](C:\Users\33100\Pictures\Screenshots\屏幕截图 2024-12-20 111318.png)</p></li><li><p>运行WordCount程序</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hadoop jar /home/hadoop/MapReduceDemo-1.0-SNAPSHOT.jar org.example.WordCountDriver /user/hadoop/input /user/hadoop/output</span><br></pre></td></tr></table></figure><p>查看输出</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">hdfs dfs -ls /user/hadoop/output</span><br><span class="line">hadoop fs -cat /user/hadoop/output/part-r-00000</span><br></pre></td></tr></table></figure><p>输出如下</p><p>![](C:\Users\33100\Pictures\Screenshots\屏幕截图 2024-12-20 112045.png)</p></li></ol><p>​ 对比输入文件可知程序运行正确</p><pre><code><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hadoop fs -<span class="built_in">cat</span> /user/hadoop/input/input.txt</span><br></pre></td></tr></table></figure></code></pre><p>![](C:\Users\33100\Pictures\Screenshots\屏幕截图 2024-12-20 112307.png)</p></div><div class="story post-story"><h2 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h2><p>MapReduce框架基于“分布式计算”原则，通常采用主从模式（Master-Worker）来协调和执行计算任务。它的工作原理大致如下：</p><ul><li>Master节点：负责将任务分配给多个Worker节点，并监控整个任务的执行。Master节点的任务通常包括：初始化作业，分配任务，跟踪任务进度，失败恢复等。</li><li>Worker节点：每个Worker节点会处理Map任务或Reduce任务，具体取决于任务的阶段。Worker节点的任务包括：读取输入数据，执行Map操作，输出中间结果，执行Reduce操作等。</li></ul></div>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;实验4-多物理机环境搭建和词频统计&quot;&gt;&lt;a href=&quot;#实验4-多物理机环境搭建和词频统计&quot; class=&quot;headerlink&quot; title=&quot;实验4 多物理机环境搭建和词频统计&quot;&gt;&lt;/a&gt;实验4 多物理机环境搭建和词频统计&lt;/h1&gt;&lt;div class=&quot;s</summary>
      
    
    
    
    <category term="学习笔记" scheme="http://example.com/categories/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/"/>
    
    
    <category term="分布式实验4_多物理机环境搭建和词频统计" scheme="http://example.com/tags/%E5%88%86%E5%B8%83%E5%BC%8F%E5%AE%9E%E9%AA%8C4-%E5%A4%9A%E7%89%A9%E7%90%86%E6%9C%BA%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA%E5%92%8C%E8%AF%8D%E9%A2%91%E7%BB%9F%E8%AE%A1/"/>
    
  </entry>
  
  <entry>
    <title>Eslint</title>
    <link href="http://example.com/2024/12/16/Eslint/"/>
    <id>http://example.com/2024/12/16/Eslint/</id>
    <published>2024-12-16T03:28:59.000Z</published>
    <updated>2024-12-16T14:11:00.772Z</updated>
    
    <content type="html"><![CDATA[<h1 id="Eslint"><a href="#Eslint" class="headerlink" title="Eslint"></a>Eslint</h1><p>ESLint 是一个用于识别和报告在 ECMAScript&#x2F;JavaScript 代码中发现的模式的工具，其目标是使代码更加一致并避免错误。</p><div class="story post-story"><h2 id="安装"><a href="#安装" class="headerlink" title="安装"></a>安装</h2><p><strong>确保事先运行 npm init,已经有 package.json 文件。</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm init -D @eslint/config@latest</span><br></pre></td></tr></table></figure><p>使用托管在 npm 上的特定可共享配置</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm init -D @eslint/config@latest -- --config packageName</span><br></pre></td></tr></table></figure><p>在项目中添加 eslint.config.js文件</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">touch</span> eslint.config.js</span><br></pre></td></tr></table></figure></div><div class="story post-story"><h2 id="运行"><a href="#运行" class="headerlink" title="运行"></a>运行</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npx eslint your-project-dir/yourfile.js</span><br></pre></td></tr></table></figure></div><div class="story post-story"><h2 id="配置"><a href="#配置" class="headerlink" title="配置"></a>配置</h2><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// eslint.config.js</span></span><br><span class="line"><span class="keyword">import</span> js <span class="keyword">from</span> <span class="string">&quot;@eslint/js&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> [</span><br><span class="line">    js.<span class="property">configs</span>.<span class="property">recommended</span>,</span><br><span class="line"></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="attr">rules</span>: &#123;</span><br><span class="line">            <span class="string">&quot;no-unused-vars&quot;</span>: <span class="string">&quot;warn&quot;</span>,</span><br><span class="line">            <span class="string">&quot;no-undef&quot;</span>: <span class="string">&quot;warn&quot;</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">];</span><br></pre></td></tr></table></figure><p><a href="https://eslint.nodejs.cn/docs/latest/use/configure">配置文档</a></p></div><div class="story post-story"><h2 id="实践问题"><a href="#实践问题" class="headerlink" title="实践问题"></a>实践问题</h2><h3 id="要关闭-ESLint-中的vue-multi-word-component-names提示"><a href="#要关闭-ESLint-中的vue-multi-word-component-names提示" class="headerlink" title="要关闭 ESLint 中的vue&#x2F;multi-word-component-names提示"></a>要关闭 ESLint 中的vue&#x2F;multi-word-component-names提示</h3><p>在eslint.config.js中添加</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">  <span class="attr">&quot;rules&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;vue/multi-word-component-names&quot;</span><span class="punctuation">:</span> <span class="string">&quot;off&quot;</span></span><br><span class="line">  <span class="punctuation">&#125;</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure></div>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;Eslint&quot;&gt;&lt;a href=&quot;#Eslint&quot; class=&quot;headerlink&quot; title=&quot;Eslint&quot;&gt;&lt;/a&gt;Eslint&lt;/h1&gt;&lt;p&gt;ESLint 是一个用于识别和报告在 ECMAScript&amp;#x2F;JavaScript 代码中发现的模式</summary>
      
    
    
    
    <category term="学习笔记" scheme="http://example.com/categories/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/"/>
    
    
    <category term="Eslint" scheme="http://example.com/tags/Eslint/"/>
    
  </entry>
  
  <entry>
    <title>分布式实验3_mapreduce配置与操作</title>
    <link href="http://example.com/2024/11/30/%E5%88%86%E5%B8%83%E5%BC%8F%E5%AE%9E%E9%AA%8C3-mapreduce%E9%85%8D%E7%BD%AE%E4%B8%8E%E6%93%8D%E4%BD%9C/"/>
    <id>http://example.com/2024/11/30/%E5%88%86%E5%B8%83%E5%BC%8F%E5%AE%9E%E9%AA%8C3-mapreduce%E9%85%8D%E7%BD%AE%E4%B8%8E%E6%93%8D%E4%BD%9C/</id>
    <published>2024-11-30T03:42:11.000Z</published>
    <updated>2024-12-14T08:21:34.719Z</updated>
    
    <content type="html"><![CDATA[<h1 id="实验3-mapreduce配置与操作"><a href="#实验3-mapreduce配置与操作" class="headerlink" title="实验3 mapreduce配置与操作"></a>实验3 mapreduce配置与操作</h1><div class="story post-story"><h2 id="MapReduce编程规范"><a href="#MapReduce编程规范" class="headerlink" title="MapReduce编程规范"></a>MapReduce编程规范</h2><h3 id="1．Mapper阶段"><a href="#1．Mapper阶段" class="headerlink" title="1．Mapper阶段"></a>1．Mapper阶段</h3><p>（1）用户自定义的Mapper要继承自己的父类</p><p>（2）Mapper的输入数据是KV对的形式（KV的类型可自定义）</p><p>（3）Mapper中的业务逻辑写在map()方法中</p><p>（4）Mapper的输出数据是KV对的形式（KV的类型可自定义）</p><p>（5）map()方法（MapTask进程）对每一个&lt;K,V&gt;调用一次</p><h3 id="2．Reducer阶段"><a href="#2．Reducer阶段" class="headerlink" title="2．Reducer阶段"></a>2．Reducer阶段</h3><p>（2）Reducer的输入数据类型对应Mapper的输出数据类型，也是KV<br>（3）Reducer的业务逻辑写在reduce()方法中<br>（4）ReduceTask进程对每一组相同k的&lt;k,v&gt;组调用一次reduce()方法</p><h3 id="3．Driver阶段"><a href="#3．Driver阶段" class="headerlink" title="3．Driver阶段"></a>3．Driver阶段</h3><p>相当于YARN集群的客户端，用于提交我们整个程序到YARN集群，提交的是封装了MapReduce程序相关运行参数的job对象</p></div><div class="story post-story"><h2 id="环境搭建"><a href="#环境搭建" class="headerlink" title="环境搭建"></a>环境搭建</h2><p>（1）创建 maven 工程，MapReduceDemo<br>（2）在 pom.xml 文件中添加如下依赖</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependencies</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- Hadoop Common --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.apache.hadoop<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>hadoop-common<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">version</span>&gt;</span>3.1.3<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- Hadoop HDFS --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.apache.hadoop<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>hadoop-hdfs<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">version</span>&gt;</span>3.1.3<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- Hadoop MapReduce --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.apache.hadoop<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>hadoop-mapreduce-client-core<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">version</span>&gt;</span>3.1.3<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependencies</span>&gt;</span></span><br></pre></td></tr></table></figure><p>（3）创建包名：org.example.mapreduce.wordcount</p></div><div class="story post-story"><h2 id="编写程序"><a href="#编写程序" class="headerlink" title="编写程序"></a>编写程序</h2><p>（1）编写 Mapper 类</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> org.example.mapreduce.wordcount;</span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> org.apache.hadoop.io.IntWritable;</span><br><span class="line"><span class="keyword">import</span> org.apache.hadoop.io.LongWritable;</span><br><span class="line"><span class="keyword">import</span> org.apache.hadoop.io.Text;</span><br><span class="line"><span class="keyword">import</span> org.apache.hadoop.mapreduce.Mapper;</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">WordCountMapper</span> <span class="keyword">extends</span> <span class="title class_">Mapper</span>&lt;LongWritable, Text, Text, IntWritable&gt;&#123;</span><br><span class="line"><span class="type">Text</span> <span class="variable">k</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Text</span>();</span><br><span class="line"><span class="type">IntWritable</span> <span class="variable">v</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">IntWritable</span>(<span class="number">1</span>);</span><br><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title function_">map</span><span class="params">(LongWritable key, Text value, Context context)</span> <span class="keyword">throws</span> IOException, InterruptedException &#123;</span><br><span class="line"><span class="comment">// 1 获取一行</span></span><br><span class="line"><span class="type">String</span> <span class="variable">line</span> <span class="operator">=</span> value.toString();</span><br><span class="line"><span class="comment">// 2 切割</span></span><br><span class="line">String[] words = line.split(<span class="string">&quot; &quot;</span>);</span><br><span class="line"><span class="comment">// 3 输出</span></span><br><span class="line"><span class="keyword">for</span> (String word : words) &#123;</span><br><span class="line">k.set(word);</span><br><span class="line">context.write(k, v);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>（2）编写 Reducer 类</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> org.example.mapreduce.wordcount;</span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> org.apache.hadoop.io.IntWritable;</span><br><span class="line"><span class="keyword">import</span> org.apache.hadoop.io.Text;</span><br><span class="line"><span class="keyword">import</span> org.apache.hadoop.mapreduce.Reducer;</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">WordCountReducer</span> <span class="keyword">extends</span> <span class="title class_">Reducer</span>&lt;Text, IntWritable, Text, IntWritable&gt;&#123;</span><br><span class="line"><span class="type">int</span> sum;</span><br><span class="line"><span class="type">IntWritable</span> <span class="variable">v</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">IntWritable</span>();</span><br><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title function_">reduce</span><span class="params">(Text key, Iterable&lt;IntWritable&gt; values,Context context)</span> <span class="keyword">throws</span> IOException, InterruptedException &#123;</span><br><span class="line"><span class="comment">// 1 累加求和</span></span><br><span class="line">sum = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span> (IntWritable count : values) &#123;</span><br><span class="line">sum += count.get();</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 2 输出</span></span><br><span class="line"> v.set(sum);</span><br><span class="line">context.write(key,v);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>（3）编写 Driver 驱动类</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> org.example.mapreduce.wordcount;</span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> org.apache.hadoop.conf.Configuration;</span><br><span class="line"><span class="keyword">import</span> org.apache.hadoop.fs.Path;</span><br><span class="line"><span class="keyword">import</span> org.apache.hadoop.io.IntWritable;</span><br><span class="line"><span class="keyword">import</span> org.apache.hadoop.io.Text;</span><br><span class="line"><span class="keyword">import</span> org.apache.hadoop.mapreduce.Job;</span><br><span class="line"><span class="keyword">import</span> org.apache.hadoop.mapreduce.lib.input.FileInputFormat;</span><br><span class="line"><span class="keyword">import</span> org.apache.hadoop.mapreduce.lib.output.FileOutputFormat;</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">WordCountDriver</span> &#123;</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> IOException, ClassNotFoundException, InterruptedException &#123;</span><br><span class="line"><span class="comment">// 1 获取配置信息以及获取 job 对象</span></span><br><span class="line"><span class="type">Configuration</span> <span class="variable">conf</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Configuration</span>();</span><br><span class="line"><span class="type">Job</span> <span class="variable">job</span> <span class="operator">=</span> Job.getInstance(conf);</span><br><span class="line"><span class="comment">// 2 关联本 Driver 程序的 jar</span></span><br><span class="line">job.setJarByClass(WordCountDriver.class);</span><br><span class="line"><span class="comment">// 3 关联 Mapper 和 Reducer 的 jar</span></span><br><span class="line">job.setMapperClass(WordCountMapper.class);</span><br><span class="line">job.setReducerClass(WordCountReducer.class);</span><br><span class="line"><span class="comment">// 4 设置 Mapper 输出的 kv 类型</span></span><br><span class="line">job.setMapOutputKeyClass(Text.class);</span><br><span class="line">job.setMapOutputValueClass(IntWritable.class);</span><br><span class="line"><span class="comment">// 5 设置最终输出 kv 类型</span></span><br><span class="line">job.setOutputKeyClass(Text.class);</span><br><span class="line">job.setOutputValueClass(IntWritable.class);</span><br><span class="line"><span class="comment">// 6 设置输入和输出路径</span></span><br><span class="line">FileInputFormat.setInputPaths(job, <span class="keyword">new</span> <span class="title class_">Path</span>(args[<span class="number">0</span>]));</span><br><span class="line">FileOutputFormat.setOutputPath(job, <span class="keyword">new</span> <span class="title class_">Path</span>(args[<span class="number">1</span>]));</span><br><span class="line"><span class="comment">// 7 提交 job</span></span><br><span class="line"><span class="type">boolean</span> <span class="variable">result</span> <span class="operator">=</span> job.waitForCompletion(<span class="literal">true</span>);</span><br><span class="line">System.exit(result ? <span class="number">0</span> : <span class="number">1</span>);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="本地测试"><a href="#本地测试" class="headerlink" title="本地测试"></a>本地测试</h3><p>（1）需要首先配置好 HADOOP_HOME 变量以及 Windows 运行依赖<br>（2）在 Intellij上运行程序</p><h3 id="打包项目"><a href="#打包项目" class="headerlink" title="打包项目"></a>打包项目</h3><p>使用 Maven 打包该项目，生成一个可执行的 jar 文件。运行以下命令：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mvn clean package</span><br></pre></td></tr></table></figure><p>得到target目录下的jar包MapRedueceDemo-1.0-SNAPSHOT.jar</p></div><div class="story post-story"><h2 id="上传到虚拟机并运行"><a href="#上传到虚拟机并运行" class="headerlink" title="上传到虚拟机并运行"></a>上传到虚拟机并运行</h2><p>使用 scp 命令将 JAR 文件从本地机器上传到虚拟机</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">scp target\MapReduceDemo-1.0-SNAPSHOT.jar root@hadoop102:/home/hadoop/</span><br></pre></td></tr></table></figure><p>上传input.txt 到HDFS</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">scp D:\input.txt root@hadoop102:/home/hadoop/</span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//input.txt的内容</span></span><br><span class="line">hzx hzx</span><br><span class="line">ss ss</span><br><span class="line">cls cls</span><br><span class="line">jiao</span><br><span class="line">banzhang</span><br><span class="line">xue</span><br><span class="line">hadoop</span><br></pre></td></tr></table></figure><p>在虚拟机上，使用 Hadoop 提供的 hadoop jar 命令来运行 MapReduce 程序</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hadoop jar /home/hadoop/MapReduceDemo-1.0-SNAPSHOT.jar org.example.WordCountDriver /user/hadoop/input /user/hadoop/output</span><br></pre></td></tr></table></figure><p>查看输出</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">hdfs dfs -ls /user/hadoop/output</span><br><span class="line">hadoop fs -cat /user/hadoop/output/part-r-00000</span><br></pre></td></tr></table></figure><p>输出如下</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">banzhang        1</span><br><span class="line">cls     2</span><br><span class="line">hadoop  1</span><br><span class="line">hzx     2</span><br><span class="line">jiao    1</span><br><span class="line">ss      2</span><br><span class="line">xue     1</span><br></pre></td></tr></table></figure></div>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;实验3-mapreduce配置与操作&quot;&gt;&lt;a href=&quot;#实验3-mapreduce配置与操作&quot; class=&quot;headerlink&quot; title=&quot;实验3 mapreduce配置与操作&quot;&gt;&lt;/a&gt;实验3 mapreduce配置与操作&lt;/h1&gt;&lt;div clas</summary>
      
    
    
    
    <category term="学习笔记" scheme="http://example.com/categories/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/"/>
    
    
    <category term="mapreduce配置与操作" scheme="http://example.com/tags/mapreduce%E9%85%8D%E7%BD%AE%E4%B8%8E%E6%93%8D%E4%BD%9C/"/>
    
  </entry>
  
  <entry>
    <title>html&amp;css</title>
    <link href="http://example.com/2024/11/24/html-css/"/>
    <id>http://example.com/2024/11/24/html-css/</id>
    <published>2024-11-24T06:57:34.000Z</published>
    <updated>2024-12-09T15:36:49.994Z</updated>
    
    <content type="html"><![CDATA[<div class="story post-story"><h2 id="语义化标签"><a href="#语义化标签" class="headerlink" title="语义化标签"></a>语义化标签</h2><p>header nav main article section aside footer</p><p>语义化的优点:</p><ul><li>在没CSS样式的情况下，页面整体也会呈现很好的结构效果</li><li>代码结构清晰，易于阅读，</li><li>利于开发和维护方便其他设备解析（如屏幕阅读器）根据语义渲染网页。</li><li>有利于搜索引擎优化（SEO），搜索引擎爬虫会根据不同的标签来赋予不同的权重</li></ul></div><div class="story post-story"><h2 id="HTML5新特性"><a href="#HTML5新特性" class="headerlink" title="HTML5新特性"></a>HTML5新特性</h2><p>语义化标签<br>音视频处理API(audio,video)<br>canvas &#x2F; webGL<br>拖拽释放(Drag and drop) API<br>history API<br>requestAnimationFrame<br>地理位置(Geolocation)API<br>webSocket<br>web存储 localStorage、SessionStorage<br>表单控件，calendar、date、time、email、url、search</p></div><div class="story post-story"><h2 id="新的HTML5文档类型和字符集"><a href="#新的HTML5文档类型和字符集" class="headerlink" title="新的HTML5文档类型和字符集"></a>新的HTML5文档类型和字符集</h2><p>HTML5文档类型是&lt;！doctype html&gt;。</p><p>HTML5使用的字符集&lt; meta charset&#x3D;“UTF8”&gt;。</p></div><div class="story post-story"><h2 id="HTML5-Canvas元素"><a href="#HTML5-Canvas元素" class="headerlink" title="HTML5 Canvas元素"></a>HTML5 Canvas元素</h2><p>Canvas元素用于在网页上绘制图形，该元素标签的强大之处在于可以直接在HTML上进行图形操作。</p></div><div class="story post-story"><h2 id="HTML5新增了哪些功能"><a href="#HTML5新增了哪些功能" class="headerlink" title="HTML5新增了哪些功能"></a>HTML5新增了哪些功能</h2><p>新增的功能API包括 Media APl、 Text Track API、 Application Cache API、User Interaction、 Data Transfer API、 Command API、 Constraint Validation API、 History API</p></div><div class="story post-story"><h2 id="HTML5的离线存储"><a href="#HTML5的离线存储" class="headerlink" title="HTML5的离线存储"></a>HTML5的离线存储</h2><p>localStorage，可长期存储数据，即浏览器关闭后数据不丢失</p><p>session Storage，数据在浏览器关闭后自动删除</p></div><div class="story post-story"><h2 id="HTML5的form如何关闭自动补全功能"><a href="#HTML5的form如何关闭自动补全功能" class="headerlink" title="HTML5的form如何关闭自动补全功能"></a>HTML5的form如何关闭自动补全功能</h2><p>将不想要提示的form元素下的 Input元素的 autocomplete属性设置为off</p></div><div class="story post-story"><h2 id="HTML5引入了哪些新的表单属性？"><a href="#HTML5引入了哪些新的表单属性？" class="headerlink" title="HTML5引入了哪些新的表单属性？"></a>HTML5引入了哪些新的表单属性？</h2><p>新增表单属性包括 datalist、 datetime、 output、 keygen、date、 month、week、time、 number、 range、 emailurl</p></div><div class="story post-story"><h2 id="HTML5中的应用缓存是什么？"><a href="#HTML5中的应用缓存是什么？" class="headerlink" title="HTML5中的应用缓存是什么？"></a>HTML5中的应用缓存是什么？</h2><p>HTML5应用缓存的最终目的是帮助用户离线浏览页面。换句话说，如果网络连接不可用，打开的页面就来自浏览器缓存，离线应用缓存可以帮助用户达到这个目的。</p><p>应用缓存可以帮助用户指定哪些文件需要缓存，哪些不需要</p></div><div class="story post-story"><h2 id="HTML5应用程序缓存为应用带来什么优势？"><a href="#HTML5应用程序缓存为应用带来什么优势？" class="headerlink" title="HTML5应用程序缓存为应用带来什么优势？"></a>HTML5应用程序缓存为应用带来什么优势？</h2><p>应用程序缓存为应用带来3个优势。</p><p>（1）离线浏览，让用户可在应用离线时（网络不可用时）使用它们。</p><p>（2）速度，让已缓存资源加载得更快。</p><p>（3）减少服务器负载，让浏览器将只下载服务器更新过的资源。</p></div><div class="story post-story"><h2 id="CSS-选择器及优先级"><a href="#CSS-选择器及优先级" class="headerlink" title="CSS 选择器及优先级"></a>CSS 选择器及优先级</h2><p>选择器</p><p>id选择器(#myid)<br>类选择器(.myclass)<br>属性选择器(a[rel&#x3D;“external”])<br>伪类选择器(a:hover, li:nth-child)<br>标签选择器(div, h1,p)<br>相邻选择器（h1 + p）<br>子选择器(ul &gt; li)<br>后代选择器(li a)<br>通配符选择器(*)<br>优先级：</p><p>!important<br>内联样式（1000）<br>ID选择器（0100）<br>类选择器&#x2F;属性选择器&#x2F;伪类选择器（0010）<br>元素选择器&#x2F;伪元素选择器（0001）<br>关系选择器&#x2F;通配符选择器（0000）<br>带!important 标记的样式属性优先级最高； 样式表的来源相同时：</p><p>!important &gt; 行内样式&gt;ID选择器 &gt; 类选择器 &gt; 标签 &gt; 通配符 &gt; 继承 &gt; 浏览器默认属性</p><h3 id="CSS3新特性"><a href="#CSS3新特性" class="headerlink" title="CSS3新特性"></a>CSS3新特性</h3><p>圆角   阴影 变换</p><p>更多的CSS选择器</p><p>色彩模式，如rgba；</p><p>伪元素::selection;</p><p>媒体查询；</p><p>多栏布局；</p><p>图片边框（ border-image）。</p></div><div class="story post-story"><h2 id="CSS3新增伪类"><a href="#CSS3新增伪类" class="headerlink" title="CSS3新增伪类"></a>CSS3新增伪类</h2><p>新增伪类有以下几个：<br>p:first- of-type，选择属于其父元素的首个元素的每个元素。</p><p>p:last-of-type，选择属于其父元素的最后一个元素的每个元素。</p><p>p:only- of-type，选择属于其父元素的唯一元素的每个元素。</p><p>p:only- child，选择属于其父元素的唯一子元素的每个元素。</p><p>p:nth- child（2），选择属于其父元素的第二个子元素的每个元素。</p><p>:enabled:disabled，控制表单控件的禁用状态.</p><p>:checked，单选框或复选框被选中。</p></div><div class="story post-story"><h2 id="CSS3动画如何在动作结束时保持该状态不变"><a href="#CSS3动画如何在动作结束时保持该状态不变" class="headerlink" title="CSS3动画如何在动作结束时保持该状态不变"></a>CSS3动画如何在动作结束时保持该状态不变</h2><p>采用 animation- fill-mode。其可以设置为以下值。</p><p>none，不改变默认行为。</p><p>forwards，当动画完成后，保持最后一个属性值（在最后一个关键帧中定义）</p><p>backwards，在 animation-delay所指定的一段时间内，在动画显示之前，应用开始属性值（在第一个关键帧中定义）。</p><p>both，向前和向后填充模式都可以应用。</p></div><div class="story post-story"><h2 id="box-sizing"><a href="#box-sizing" class="headerlink" title="box- sizing"></a>box- sizing</h2><p>box-sizing属性主要用来控制元素盒模型的解析模式。默认值是 content-box。</p><p>content-box让元素维持W3C的标准盒模型。元素的宽度&#x2F;高度由 border+ padding+content的宽度&#x2F;高度决定，设置 width&#x2F;height属性指的是指定 content部分的宽度&#x2F;高度。</p><p>border-box让元素维持IE传统盒模型（IE6以下版本和IE6、IE7的怪异模式）。设置 width&#x2F;height属性指的是指定 border+ padding+ content的宽度&#x2F;高度。</p><p>标准浏览器下，按照W3C规范解析盒模型。一旦修改了元素的边框或内距，就会影响元素的盒子尺寸，就不得不重新计算元素的盒子尺寸，从而影响整个页面的布局。</p></div><div class="story post-story"><h2 id="CSS3动画的优缺点"><a href="#CSS3动画的优缺点" class="headerlink" title="CSS3动画的优缺点"></a>CSS3动画的优缺点</h2><p>优点如下:</p><p>在性能上会稍微好一些。代码相对简单。</p><p>缺点如下:</p><p>在动画控制上不够灵活，兼容性不好。</p></div><div class="story post-story"><h2 id="Animation与-Transition的异同"><a href="#Animation与-Transition的异同" class="headerlink" title="Animation与 Transition的异同"></a>Animation与 Transition的异同</h2><p>Animation与 Transition的功能相同，都是通过改变元素的属性值来实现动画效果的。</p><p>它们的区别在于，使用 Transition的功能时只能用指定属性的开始值和结束值，然后在这两个属性值之间使用平滑过渡的方式实现动画效果，因此不能实现比较复杂的动画效果。</p><p>Animation功能通过定义多个关键帧，以及定义每个关键帧中元素的属性值来实现更为复杂的动画效果。</p></div><div class="story post-story"><h2 id="Animation属性值"><a href="#Animation属性值" class="headerlink" title="Animation属性值"></a>Animation属性值</h2><p>两个必要属性如下。</p><p>animation-name，即动画名称。</p><p>animation- duration，即动画持续时间。</p><p>其他属性值如下。</p><p>animation- play-state，即播放状态（ running表示播放， paused表示暂停），可以用来控制动画暂停。</p><p>animation- timing- function，即动画运动形式。</p><p>animation- delay，即动画延迟时间。</p><p>mation-iteration- count，即重复次数。</p><p>animation-direction，即播放前重置（ alternate动画直接从上一次停止的位置开始执行）。</p></div><div class="story post-story"><h2 id="媒体查询-rem的使用方法"><a href="#媒体查询-rem的使用方法" class="headerlink" title="媒体查询+rem的使用方法"></a>媒体查询+rem的使用方法</h2><p>@media媒体类型and（媒体特性）{样式规则}<br>这通常在移动端使用。在做移动端开发的时候，为了适配多屏幕，使用rem单位，然后根据屏幕尺寸的改变动态地设置根节点HIML的font-size值。这样可以解决多屏幕适配的问题。</p><p>html{<br>font-size：20px;<br>}<br>@media （min-width：320px） {<br>html<br>{<br>font-size：12px；<br>}<br>}<br>@media （min-width：360px）{<br>html{<br>font-size：16px；<br>}<br>}<br>但是这种做法有两个缺点。</p><p>（1）适配屏幕的尺寸不是连续的。</p><p>（2）会在CSS文件中添加大段的查询代码，增加了CSS文件的大小，为改进上述缺点，可以使用 JavaScript获取移动设备屏幕的宽度，根据设计稿的原型尺寸，动态地计算font-size的值。</p></div><div class="story post-story"><h2 id="rem的原理"><a href="#rem的原理" class="headerlink" title="rem的原理"></a>rem的原理</h2><p>在做响应式布局的时候，通过调整HTML的字体大小，页面上所有使用rem单位的元素都会做相应的调整。</p></div><div class="story post-story"><h2 id="设置CSS3文本阴影"><a href="#设置CSS3文本阴影" class="headerlink" title="设置CSS3文本阴影"></a>设置CSS3文本阴影</h2><p>h1{text- shadow：水平阴影，垂直阴影，模糊距离，阴影颜色}</p></div><div class="story post-story"><h2 id="盒阴影"><a href="#盒阴影" class="headerlink" title="盒阴影"></a>盒阴影</h2><p>盒阴影的语法结构与文本阴影类似，如box- shadow：5px 5px 5px rgba（255，15，255，0.5）。</p><p>但是，盒阴影多了一个属性，即外延值 inset.，如box- -shadow：5px 5px 25px rgba（0,0,255，0.5）inset。</p><p>通过CSS3实现背景颜色线性渐变具体代码如下：</p><p>div{<br>background：-webkit-linear-gradient （left, red, green 50%， blue）；<br>}</p></div><div class="story post-story"><h2 id="CSS3中-transition属性值及含义"><a href="#CSS3中-transition属性值及含义" class="headerlink" title="CSS3中 transition属性值及含义"></a>CSS3中 transition属性值及含义</h2><p>transition属性是一个简写属性，用于设置以下4个过渡属性。</p><p>transition- property，哪个属性需要实现过渡</p><p>transition- duration，完成过渡效果需要多少秒&#x2F;毫秒</p><p>transition- timing- function，速度效果的运动曲线，如 linear、ease-in、ease、ease-out、 ease-in-out, cube-bezier。</p><p>transition- delay，规定过渡开始前的延迟时间。</p></div><div class="story post-story"><h2 id="用省略号显示超出文本的内容"><a href="#用省略号显示超出文本的内容" class="headerlink" title="用省略号显示超出文本的内容"></a>用省略号显示超出文本的内容</h2><p>使用text-overflow:ellopsis。</p><p>当文本溢出时，为了不显示省略标记（…），通过clip直接将溢出的部分裁剪掉。</p></div><div class="story post-story"><h2 id="实现文本换行"><a href="#实现文本换行" class="headerlink" title="实现文本换行"></a>实现文本换行</h2><p>使用word-wrap属性。</p><p>normal，只在允许的断字点换行（浏览器保持默认处理）。</p><p>break-word，在长单词或URL地址内部进行换行。</p></div><div class="story post-story"><h2 id="position-属性的值有哪些及其区别"><a href="#position-属性的值有哪些及其区别" class="headerlink" title="position 属性的值有哪些及其区别"></a>position 属性的值有哪些及其区别</h2><p>固定定位 fixed： 元素的位置相对于浏览器窗口是固定位置，即使窗口是滚动的它也不会移动。Fixed 定 位使元素的位置与文档流无关，因此不占据空间。 Fixed 定位的元素和其他元素重叠。</p><p>相对定位 relative： 如果对一个元素进行相对定位，它将出现在它所在的位置上。然后，可以通过设置垂直 或水平位置，让这个元素“相对于”它的起点进行移动。 在使用相对定位时，无论是 否进行移动，元素仍然占据原来的空间。因此，移动元素会导致它覆盖其它框。</p><p>绝对定位 absolute： 绝对定位的元素的位置相对于最近的已定位父元素，如果元素没有已定位的父元素，那 么它的位置相对于。absolute 定位使元素的位置与文档流无关，因此不占据空间。 absolute 定位的元素和其他元素重叠。</p><p>粘性定位 sticky： 元素先按照普通文档流定位，然后相对于该元素在流中的 flow root（BFC）和 containing block（最近的块级祖先元素）定位。而后，元素定位表现为在跨越特定阈值前为相对定 位，之后为固定定位。</p><p>默认定位 Static： 默认值。没有定位，元素出现在正常的流中（忽略 top, bottom, left, right 或者 z-index 声 明）。 inherit: 规定应该从父元素继承 position 属性的值。</p></div><div class="story post-story"><h2 id="让一个元素水平垂直居中"><a href="#让一个元素水平垂直居中" class="headerlink" title="让一个元素水平垂直居中"></a>让一个元素水平垂直居中</h2><h3 id="水平居中"><a href="#水平居中" class="headerlink" title="水平居中"></a>水平居中</h3><p>对于 行内元素 : text-align: center;<br>对于确定宽度的块级元素：<br>（1）width和margin实现。margin: 0 auto;<br>（2）绝对定位和margin-left: margin-left: (父width - 子width）&#x2F;2, 前提是父元素position: relative<br>对于宽度未知的块级元素<br>（1）table标签配合margin左右auto实现水平居中。使用table标签（或直接将块级元素设值为 display:table），再通过给该标签添加左右margin为auto。<br>（2）inline-block实现水平居中方法。display：inline-block和text-align:center实现水平居中。<br>（3）绝对定位+transform，translateX可以移动本身元素的50%。<br>（4）flex布局使用justify-content:center</p><h3 id="垂直居中"><a href="#垂直居中" class="headerlink" title="垂直居中"></a>垂直居中</h3><p>利用 line-height 实现居中，这种方法适合纯文字类<br>通过设置父容器 相对定位 ，子级设置 绝对定位，标签通过margin实现自适应居中<br>弹性布局 flex :父级设置display: flex; 子级设置margin为auto实现自适应居中<br>父级设置相对定位，子级设置绝对定位，并且通过位移 transform 实现<br>table 布局，父级通过转换成表格形式，然后子级设置 vertical-align 实现。（需要注意的是：vertical-align: middle使用的前提条件是内联元素以及display值为table-cell的元素）。<br>传送门 ☞ # 图解CSS水平垂直居中常见面试方法</p></div><div class="story post-story"><h2 id="隐藏页面中某个元素的方法"><a href="#隐藏页面中某个元素的方法" class="headerlink" title="隐藏页面中某个元素的方法"></a>隐藏页面中某个元素的方法</h2><p>opacity：0，该元素隐藏起来了，但不会改变页面布局，并且，如果该元素已经绑定 一些事件，如click 事件，那么点击该区域，也能触发点击事件的<br>visibility：hidden，该元素隐藏起来了，但不会改变页面布局，但是不会触发该元素已 经绑定的事件 ，隐藏对应元素，在文档布局中仍保留原来的空间（重绘）<br>display：none，把元素隐藏起来，并且会改变页面布局，可以理解成在页面中把该元素。 不显示对应的元素，在文档布局中不再分配空间43、用CSS实现三角符号</p></div><div class="story post-story"><h2 id="页面布局"><a href="#页面布局" class="headerlink" title="页面布局"></a>页面布局</h2><h3 id="Flex-布局"><a href="#Flex-布局" class="headerlink" title="Flex 布局"></a>Flex 布局</h3><p>布局的传统解决方案，基于盒状模型，依赖 display 属性 + position 属性 + float 属性。它对于那些特殊布局非常不方便，比如，垂直居中就不容易实现。</p><p>Flex 是 Flexible Box 的缩写，意为”弹性布局”,用来为盒状模型提供最大的灵活性。指定容器 display: flex 即可。 简单的分为容器属性和元素属性。</p><p>容器的属性：</p><p>flex-direction：决定主轴的方向（即子 item 的排列方法）flex-direction: row | row-reverse | column | column-reverse;<br>flex-wrap：决定换行规则 flex-wrap: nowrap | wrap | wrap-reverse;<br>flex-flow： .box { flex-flow: || ; }<br>justify-content：对其方式，水平主轴对齐方式<br>align-items：对齐方式，竖直轴线方向<br>align-content</p><p>项目的属性（元素的属性）：</p><p>order 属性：定义项目的排列顺序，顺序越小，排列越靠前，默认为 0<br>flex-grow 属性：定义项目的放大比例，即使存在空间，也不会放大<br>flex-shrink 属性：定义了项目的缩小比例，当空间不足的情况下会等比例的缩小，如果 定义个 item 的 flow-shrink 为 0，则为不缩小<br>flex-basis 属性：定义了在分配多余的空间，项目占据的空间。<br>flex：是 flex-grow 和 flex-shrink、flex-basis 的简写，默认值为 0 1 auto。<br>align-self：允许单个项目与其他项目不一样的对齐方式，可以覆盖<br>align-items，默认属 性为 auto，表示继承父元素的 align-items 比如说，用 flex 实现圣杯布局</p><h3 id="Rem-布局"><a href="#Rem-布局" class="headerlink" title="Rem 布局"></a>Rem 布局</h3><p>首先 Rem 相对于根(html)的 font-size 大小来计算。简单的说它就是一个相对单例 如:font-size:10px;,那么（1rem &#x3D; 10px）了解计算原理后首先解决怎么在不同设备上设置 html 的 font-size 大小。其实 rem 布局的本质是等比缩放，一般是基于宽度。</p><p>优点：可以快速适用移动端布局，字体，图片高度<br>缺点：<br>① 目前 ie 不支持，对 pc 页面来讲使用次数不多；<br>② 数据量大：所有的图片，盒子都需要我们去给一个准确的值；才能保证不同机型的适配；<br>③ 在响应式布局中，必须通过 js 来动态控制根元素 font-size 的大小。也就是说 css 样式和 js 代码有一定的耦合性。且必须将改变 font-size 的代码放在 css 样式之前。</p><h3 id="百分比布局"><a href="#百分比布局" class="headerlink" title="百分比布局"></a>百分比布局</h3><p>通过百分比单位 “ % “ 来实现响应式的效果。通过百分比单位可以使得浏览器中的组件的宽和高随着浏览器的变化而变化，从而实现响应式的效果。 直观的理解，我们可能会认为子元素的百分比完全相对于直接父元素，height 百分比相 对于 height，width 百分比相对于 width。 padding、border、margin 等等不论是垂直方向还是水平方向，都相对于直接父元素的 width。 除了 border-radius 外，还有比如 translate、background-size 等都是相对于自身的。<br>缺点：</p><p>（1）计算困难<br>（2）各个属性中如果使用百分比，相对父元素的属性并不是唯一的。造成我们使用百分比单位容易使布局问题变得复杂。</p><h3 id="浮动布局"><a href="#浮动布局" class="headerlink" title="浮动布局"></a>浮动布局</h3><p>浮动布局:当元素浮动以后可以向左或向右移动，直到它的外边缘碰到包含它的框或者另外一个浮动元素的边框为止。元素浮动以后会脱离正常的文档流，所以文档的普通流中的框就变的好像浮动元素不存在一样。</p><p>优点<br>这样做的优点就是在图文混排的时候可以很好的使文字环绕在图片周围。另外当元素浮动了起来之后，它有着块级元素的一些性质例如可以设置宽高等，但它与inline-block还是有一些区别的，第一个就是关于横向排序的时候，float可以设置方向而inline-block方向是固定的；还有一个就是inline-block在使用时有时会有空白间隙的问题<br>缺点<br>最明显的缺点就是浮动元素一旦脱离了文档流，就无法撑起父元素，会造成父级元素高度塌陷。</p><h3 id="自适应布局（bootstrap）"><a href="#自适应布局（bootstrap）" class="headerlink" title="自适应布局（bootstrap）"></a>自适应布局（bootstrap）</h3><p>自适应布局分别为不同屏幕不同分辨率定义布局，即是创建多个静态页面，每个静态页面对应一个屏幕分辨率的一个范围内。在改变不同的屏幕分辨率可以切换到不同的静态布局上，但是布局中的元素位置会发生改变，但是在每个静态布局中，页面中的元素不会随着窗口大小的调整发生变化。使用 @media 媒体查询给不同尺寸和介质的设备切换不同的样式。在优秀的响应范围设计下可以给适配范围内的设备最好的体验，在同一个设备下实际还是固定的布局。</p><p>优点：<br>1.对网站的复杂程度兼容性更大；<br>2.对开发工程师来说制作的成本代价更低；<br>3.代码执行效果更高效；<br>4.测试时更加容易，运营相对更加精准。</p><p>缺点： 在现如今的移动端设计百花齐放的时期之下，同一个网站往往需要为不同的设备制作不同的页面，不但会增加开发成本，还会因为客户的需求改变时，可能会改动多套代码、流程相比较来说较繁琐。</p><h3 id="流式布局（fluid）"><a href="#流式布局（fluid）" class="headerlink" title="流式布局（fluid）"></a>流式布局（fluid）</h3><p>流式布局的布局方式是页面的元素的宽度按照屏幕的分辨率进行适配的调整，但是整体布局不变，也称之为栅栏系统。使用%百分比定义宽度，高度大都是用px来固定住，可以根据可视区域 (viewport) 和父元素的实时尺寸进行调整，尽可能的适应各种分辨率。往往配合 max-width&#x2F;min-width 等属性控制尺寸流动范围以免过大或者过小影响阅读。<br>缺点： 屏幕大小变化时，页面元素也随之变化但是布局不变。这就会因为如果屏幕太大或太小都会布局时元素无法正常显示。</p><h3 id="响应式布局"><a href="#响应式布局" class="headerlink" title="响应式布局"></a>响应式布局</h3><p>响应式布局是css3增加的新布局方式，该布局方式2010年提出来的一个概念，说白了就是一个网站能够兼容多个终端——而不是为每个终端做一个特定的版本。这个概念是为解决移动互联网浏览而诞生的。响应式布局可以为不同终端的用户提供更加舒适的界面和更好的用户体验，而且随着目前大屏幕移动设备的普及，用“大势所趋”来形容也不为过。响应式几乎成为优秀页面布局的标准。<br>设计方法： 媒体查询+流式布局。通常使用@media媒体查询，和网格系统配合相对布局单位进行布局，实际上说白了就是综合响应式等技术通过css给单一网页不同设备分辨率返回不式时的技术。<br>优点： 适应pc端和移动端，如果有足够的耐心，页面效果会很完美。<br>缺点：<br>1.只能适应主流的宽高；<br>2.如果匹配足够多的设备屏幕的大小，对于工程师来说工作量不小，设计更需要多个版本，工作量增大。</p></div><div class="story post-story"><h2 id="前端优化的解决方案"><a href="#前端优化的解决方案" class="headerlink" title="前端优化的解决方案"></a>前端优化的解决方案</h2><p>我们的优化原则有以下几个：</p><p>能缓存的，尽量强缓存。</p><p>引入外部资源时不要出现超时、404的状况。</p><p>减少HTTP请求数。</p><p>合理设置cookie的大小以及过期时间。</p><p>合理利用懒加载</p></div><div class="story post-story"><h2 id="网页内容的优化"><a href="#网页内容的优化" class="headerlink" title="网页内容的优化"></a>网页内容的优化</h2><p>1、懒加载数据。<br>首先根据标签的left和top属性判断是否显示在了屏幕中（如果显示在屏幕中，其left和top属性值应该是在0到窗口长宽之间）。<br>如果显示在屏幕中，则将src标签的内容替换为图片的url。</p><p>2、不要在中缩放图片。<br>img计算缩放也需要时间</p><p>3、避免重定向。<br>重定向会重新渲染网页。</p><p>4、使用雪碧图（精灵图）：<br>通过使用background-position：-xpx -ypx;来调整图片的位置，不过HTTP2不适用，原因为HTTP2实际上是多路复用的，只用一个TCP连接，所以多个图片的请求也是在同一个TCP连接里，这样能省下非常多的请求时间，但坏处就是单连接开销很大，如果要传多个大文件，就很麻烦。</p><p>5、要有网站小图标favicon.ico。</p><p>如果没有小图标，会引起404，拖慢网页加载进度。<br>6、能使用jpeg就不要用png，能使用png8就不要用png24。<br>（1）色彩丰富的、大的图片切成jpg的；<br>（2）尺寸小的，色彩不丰富的和背景透明的切成gif或者png8的；<br>（3）半透明的切成png24。</p><p>7、使用canvas压缩图片。</p></div><div class="story post-story"><h2 id="css的优化"><a href="#css的优化" class="headerlink" title="css的优化"></a>css的优化</h2><p>1、避免使用@import。<br>使用@import相当于将引入的css放在了页面底部，因为使用@import引用的文件只有在引用它的那个css文件被下载、解析之后，浏览器才会知道还有另外一个css需要下载，这时才去下载，然后下载后开始解析、构建render tree等一系列操作。因此使用@import会拖慢渲染的过程。</p><p>2、将样式表放在head中。<br>如果放在body中，可能出现在浏览器下载好css样式表之前，组件就已经加载好了的情况，这可能会导致重新渲染。</p><p>3、避免使用css表达式。<br>如：expression((new Date()).getHours()%2 ? “#B8D4FF” : “#F08A00” );<br>解析表达式和计算都需要时间。</p></div><div class="story post-story"><h2 id="JavaScript的优化"><a href="#JavaScript的优化" class="headerlink" title="JavaScript的优化"></a>JavaScript的优化</h2><p>1、尽量减少DOM访问。</p><p>2、使用事件代理（减少DOM操作）。</p><p>3、把脚本放在底部（加载脚本时会阻塞页面渲染）。</p><p>4、合理使用节流函数和防抖函数。</p></div><div class="story post-story"><h2 id="CDN"><a href="#CDN" class="headerlink" title="CDN"></a>CDN</h2><p>CDN即内容分发网络。它依靠部署在各地的边缘服务器，通过中心平台的负载均衡、内容分发、调度等功能模块，使用户就近获取所需内容，降低网络拥塞，提高用户访问响应速度和命中率。优化加载速度。</p></div><div class="story post-story"><h2 id="水平垂直居中的几种方法"><a href="#水平垂直居中的几种方法" class="headerlink" title="水平垂直居中的几种方法"></a>水平垂直居中的几种方法</h2><p>使用flex布局<br>利用flex的alignItems:center垂直居中，justifycontent:center水平居中</p><p>利用相对定位和绝对定位的margin:auto<br>相对定位下，使用绝对定位将上下左右都设置为0，再设置margin:auto即可实现居中</p><p>利用相对定位和绝对定位，再加上外边距和平移的配合<br>相对定位下，使用绝对定位，利用margin偏移外容器的50%，再利用translate平移回补自身宽高的50%即可</p></div>]]></content>
    
    
      
      
    <summary type="html">&lt;div class=&quot;story post-story&quot;&gt;&lt;h2 id=&quot;语义化标签&quot;&gt;&lt;a href=&quot;#语义化标签&quot; class=&quot;headerlink&quot; title=&quot;语义化标签&quot;&gt;&lt;/a&gt;语义化标签&lt;/h2&gt;&lt;p&gt;header nav main article sect</summary>
      
    
    
    
    <category term="学习笔记" scheme="http://example.com/categories/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/"/>
    
    
    <category term="面试八股" scheme="http://example.com/tags/%E9%9D%A2%E8%AF%95%E5%85%AB%E8%82%A1/"/>
    
  </entry>
  
  <entry>
    <title>浏览器</title>
    <link href="http://example.com/2024/11/24/%E6%B5%8F%E8%A7%88%E5%99%A8/"/>
    <id>http://example.com/2024/11/24/%E6%B5%8F%E8%A7%88%E5%99%A8/</id>
    <published>2024-11-24T06:20:27.000Z</published>
    <updated>2024-12-18T02:48:53.573Z</updated>
    
    <content type="html"><![CDATA[<div class="story post-story"><h2 id="从输入URL到页面加载的全过程"><a href="#从输入URL到页面加载的全过程" class="headerlink" title="从输入URL到页面加载的全过程"></a>从输入URL到页面加载的全过程</h2><p>首先在浏览器中输入URL</p><p>查找缓存：浏览器先查看浏览器缓存-系统缓存-路由缓存中是否有该地址页面，如果有则显示页面内容。如果没有则进行下一步。</p><p>DNS域名解析：浏览器向DNS服务器发起请求，解析该URL中的域名对应的IP地址。DNS服务器是基于UDP的，因此会用到UDP协议。</p><p>建立TCP连接：解析出IP地址后，根据IP地址和默认80端口，和服务器建立TCP连接</p><p>发起HTTP请求：浏览器发起读取文件的HTTP请求，，该请求报文作为TCP三次握手的第三次数据发送给服务器</p><p>服务器响应请求并返回结果：服务器对浏览器请求做出响应，并把对应的html文件发送给浏览器</p><p>关闭TCP连接：通过四次挥手释放TCP连接</p><p>浏览器渲染：客户端（浏览器）解析HTML内容并渲染出来</p><p>JS引擎解析过程：调用JS引擎，执行JS代码（JS的解释阶段，预处理阶段，执行阶段生成执行上下文，VO，作用域链、回收机制等等）</p><p><strong>创建window对象</strong>：window对象也叫全局执行环境，当页面产生时就被创建，所有的全局变量和函数都属于window的属性和方法。当关闭网页或者关闭浏览器时，全局执行环境会被销毁。<br><strong>加载文件</strong>：完成js引擎分析它的语法与词法是否合法，如果合法进入预编译。<br><strong>预编译</strong>：在预编译的过程中，浏览器会寻找全局变量声明，把它作为window的属性加入到window对象中，并给变量赋值为’undefined’；寻找全局函数声明，把它作为window的方法加入到window对象中，并将函数体赋值给他（匿名函数是不参与预编译的，因为它是变量）。而变量提升作为不合理的地方在ES6中已经解决了，函数提升还存在。<br><strong>解释执行</strong>：执行到变量就赋值，如果变量没有被定义，也就没有被预编译直接赋值，在ES5非严格模式下这个变量会成为window的一个属性，也就是成为全局变量。string、int这样的值就是直接把值放在变量的存储空间里，object对象就是把指针指向变量的存储空间。函数执行，就将函数的环境推入一个环境的栈中，执行完成后再弹出，控制权交还给之前的环境。JS作用域其实就是这样的执行流机制实现的。</p></div><div class="story post-story"><h2 id="在浏览器中输入URL到显示页面经历哪些过程，涉及到哪些协议？"><a href="#在浏览器中输入URL到显示页面经历哪些过程，涉及到哪些协议？" class="headerlink" title="在浏览器中输入URL到显示页面经历哪些过程，涉及到哪些协议？"></a>在浏览器中输入URL到显示页面经历哪些过程，涉及到哪些协议？</h2><p>浏览器要将URL解析为IP地址，解析域名就要用到DNS协议，首先主机会查询DNS的缓存，如果没有就给本地DNS发送查询请求。DNS查询分为两种方式，一种是递归查询，一种是迭代查询。如果是迭代查询，本地的DNS服务器，向根域名服务器发送查询请求，根域名服务器告知该域名的一级域名服务器，然后本地服务器给该一级域名服务器发送查询请求，然后依次类推直到查询到该域名的IP地址。DNS服务器是基于UDP的，因此会用到UDP协议。</p><p>得到IP地址后，浏览器就要与服务器建立一个http连接。因此要用到http协议。http生成一个get请求报文，将该报文传给TCP层处理，所以还会用到TCP协议。如果采用https还会使用https协议先对http数据进行加密。TCP层如果有需要先将HTTP数据包分片，分片依据路径MTU和MSS。TCP的数据包然后会发送给IP层，用到IP协议。IP层通过路由选路，一跳一跳发送到目的地址。当然在一个网段内的寻址是通过以太网协议实现(也可以是其他物理层协议，比如PPP，SLIP)，以太网协议需要直到目的IP地址的物理地址，有需要ARP协议。</p><p>其中：</p><p>1、DNS协议，http协议，https协议属于应用层<br>应用层是体系结构中的最高层。应用层确定进程之间通信的性质以满足用户的需要。这里的进程就是指正在运行的程序。应用层直接为用户的应用进程提供服务。</p><p>2、TCP&#x2F;UDP属于传输层<br>传输层的任务就是负责主机中两个进程之间的通信。因特网的传输层可使用两种不同协议：即面向连接的传输控制协议TCP，和无连接的用户数据报协议UDP。面向连接的服务能够提供可靠的交付，但无连接服务则不保证提供可靠的交付，它只是“尽最大努力交付”。这两种服务方式都很有用，备有其优缺点。在分组交换网内的各个交换结点机都没有传输层。</p><p>3、IP协议，ARP协议属于网络层<br>网络层负责为分组交换网上的不同主机提供通信。在发送数据时，网络层将运输层产生的报文段或用户数据报封装成分组或包进行传送。在TCP&#x2F;IP体系中，分组也叫作IP数据报，或简称为数据报。网络层的另一个任务就是要选择合适的路由，使源主机运输层所传下来的分组能够交付到目的主机。</p><p>4、数据链路层<br>当发送数据时，数据链路层的任务是将在网络层交下来的IP数据报组装成帧，在两个相邻结点间的链路上传送以帧为单位的数据。每一帧包括数据和必要的控制信息（如同步信息、地址信息、差错控制、以及流量控制信息等）。控制信息使接收端能够知道—个帧从哪个比特开始和到哪个比特结束。控制信息还使接收端能够检测到所收到的帧中有无差错。</p><p>5、物理层<br>物理层的任务就是透明地传送比特流。在物理层上所传数据的单位是比特。传递信息所利用的一些物理媒体，如双绞线、同轴电缆、光缆等，并不在物理层之内而是在物理层的下面。因此也有人把物理媒体当做第0层。</p></div><div class="story post-story"><h2 id="进程、线程和协程"><a href="#进程、线程和协程" class="headerlink" title="进程、线程和协程"></a>进程、线程和协程</h2><p>进程是一个具有一定独立功能的程序在一个数据集上的一次动态执行的过程，是操作系统进行资源分配和调度的一个独立单位。<br>线程是程序执行流的最小单元，是处理器调度和分派的基本单位。一个进程可以有一个或多个线程，各个线程之间共享程序的内存空间(也就是所在进程的内存空间)。</p><p>协程，英文Coroutines，是一种基于线程之上，但又比线程更加轻量级的存在，这种由程序员自己写程序来管理的轻量级线程叫做『用户空间线程』，具有对内核来说不可见的特性。</p><p>进程和线程的区别与联系<br>【区别】：<br>调度：线程作为调度和分配的基本单位，进程作为拥有资源的基本单位；</p><p>并发性：不仅进程之间可以并发执行，同一个进程的多个线程之间也可并发执行；</p><p>拥有资源：进程是拥有资源的一个独立单位，线程不拥有系统资源，但可以访问隶属于进程的资源。</p><p>系统开销：在创建或撤消进程时，由于系统都要为之分配和回收资源，导致系统的开销明显大于创建或撤消线程时的开销。但是进程有独立的地址空间，一个进程崩溃后，在保护模式下不会对其它进程产生影响，而线程只是一个进程中的不同执行路径。线程有自己的堆栈和局部变量，但线程之间没有单独的地址空间，一个进程死掉就等于所有的线程死掉，所以多进程的程序要比多线程的程序健壮，但在进程切换时，耗费资源较大，效率要差一些。</p><p>【联系】：<br>一个线程只能属于一个进程，而一个进程可以有多个线程，但至少有一个线程；</p><p>资源分配给进程，同一进程的所有线程共享该进程的所有资源；</p><p>处理机分给线程，即真正在处理机上运行的是线程；</p><p>进程间的通信方式<br>进程通信：每个进程各自有不同的用户地址空间,任何一个进程的全局变量在另一个进程中都看不到，所以进程之间要交换数据必须通过内核,在内核中开辟一块缓冲区,进程A把数据从用户空间拷到内核缓冲区,进程B再从内核缓冲区把数据读走,内核提供的这种机制称为进程间通信。</p><p>进程间的通信方式：管道、有名管道、信号、消息队列、共享内存、信号量、socket</p></div><div class="story post-story"><h2 id="JS垃圾回收机制"><a href="#JS垃圾回收机制" class="headerlink" title="JS垃圾回收机制"></a>JS垃圾回收机制</h2><p>浏览器的Javascript具有自动垃圾回收机制(GC:Garbage Collecation)，垃圾收集器会定期（周期性）找出那些不在继续使用的变量，然后释放其内存。</p><p>标记清除:在js中，最常用的垃圾回收机制是标记清除：当变量进入执行环境时，被标记为“进入环境”，当变量离开执行环境时，会被标记为“离开环境”。垃圾回收器会销毁那些带标记的值并回收它们所占用的内存空间。</p><p>优化手段：内存优化 ; 手动释放：取消内存的占用即可。</p><p>内存泄漏：在 JS 中，常见的内存泄露主要有 4 种,全局变量、闭包、DOM 元素的引用、定时器</p></div>]]></content>
    
    
      
      
    <summary type="html">&lt;div class=&quot;story post-story&quot;&gt;&lt;h2 id=&quot;从输入URL到页面加载的全过程&quot;&gt;&lt;a href=&quot;#从输入URL到页面加载的全过程&quot; class=&quot;headerlink&quot; title=&quot;从输入URL到页面加载的全过程&quot;&gt;&lt;/a&gt;从输入URL到页面加载</summary>
      
    
    
    
    <category term="学习笔记" scheme="http://example.com/categories/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/"/>
    
    
    <category term="面试八股" scheme="http://example.com/tags/%E9%9D%A2%E8%AF%95%E5%85%AB%E8%82%A1/"/>
    
  </entry>
  
  <entry>
    <title>http</title>
    <link href="http://example.com/2024/11/23/http/"/>
    <id>http://example.com/2024/11/23/http/</id>
    <published>2024-11-23T14:35:15.000Z</published>
    <updated>2024-12-15T15:07:26.265Z</updated>
    
    <content type="html"><![CDATA[<div class="story post-story"><h2 id="HTTP-的基本概念"><a href="#HTTP-的基本概念" class="headerlink" title="HTTP 的基本概念"></a>HTTP 的基本概念</h2><p>互联网上应用最为广泛的一种网络协议，是一个客户端和服务器端请求和应答的标准，用于从 WWW 服务器传输超文本到本地浏览器的超文本传输协议。</p></div><div class="story post-story"><h2 id="HTTP工作原理"><a href="#HTTP工作原理" class="headerlink" title="HTTP工作原理"></a>HTTP工作原理</h2><p>HTTP协议定义Web客户端如何从Web服务器请求Web页面，以及服务器如何把Web页面传送给客户端。客户端向服务器发送一个请求报文，服务器以一个状态行作为响应。</p></div><div class="story post-story"><h2 id="HTTP请求-响应的步骤"><a href="#HTTP请求-响应的步骤" class="headerlink" title="HTTP请求&#x2F;响应的步骤"></a>HTTP请求&#x2F;响应的步骤</h2><ol><li>客户端输入网址，浏览器解析出协议、域名、端口号、资源路径</li><li>DNS域名解析得到ip地址</li><li>三次握手建立TCP链接</li><li>客户端发送http请求，服务器接收请求并相应数据</li><li>四次挥手释放TCP链接</li><li>浏览器解析HTML内容</li></ol></div><div class="story post-story"><h2 id="HTTP-的-5-种方法"><a href="#HTTP-的-5-种方法" class="headerlink" title="HTTP 的 5 种方法"></a>HTTP 的 5 种方法</h2><p>GET—获取资源<br>POST—传输资源<br>PUT—更新资源<br>DELETE—删除资源<br>HEAD—获取报文首部</p></div><div class="story post-story"><h2 id="GET与POST的区别"><a href="#GET与POST的区别" class="headerlink" title="GET与POST的区别"></a>GET与POST的区别</h2><p>GET对数据进行查询，POST主要对数据进行增删改！</p><p>GET在浏览器回退时是无害的，而POST会再次提交请求</p><p>GET请求地址和参数会被浏览器主动缓存，而POST不会，除非手动设置</p><p>GET请求在URL中传送的参数是有长度的限制，而POST没有限制</p><p>GET参数通过URL传递，会暴露，不安全；POST放在Request Body中，相对更安全</p></div><div class="story post-story"><h2 id="HTTP报文的组成成分"><a href="#HTTP报文的组成成分" class="headerlink" title="HTTP报文的组成成分"></a>HTTP报文的组成成分</h2><p>请求报文{ 请求行、请求头、空行、请求体 } </p><p>响应报文{ 状态行、响应头、空行、响应体 }</p><p>Request Header:<br>GET &#x2F;sample.Jsp HTTP&#x2F;1.1 &#x2F;&#x2F;请求行：{http方法、页面地址、http协议、http版本}<br>Host: <a href="http://www.uuid.online/">www.uuid.online/</a> &#x2F;&#x2F;请求的目标域名和端口号<br>Origin: <a href="http://localhost:8081/">http://localhost:8081/</a> &#x2F;&#x2F;请求的来源域名和端口号 （跨域请求时，浏览器会自动带上这个头信息）<br>Referer: <a href="https://localhost:8081/link?query=xxxxx">https://localhost:8081/link?query=xxxxx</a> &#x2F;&#x2F;请求资源的完整URI<br>User-Agent: Mozilla&#x2F;5.0 (Windows NT 10.0; Win64; x64) AppleWebKit&#x2F;537.36 (KHTML, like Gecko) Chrome&#x2F;67.0.3396.99 Safari&#x2F;537.36 &#x2F;&#x2F;浏览器信息<br>Cookie: BAIDUID&#x3D;FA89F036:FG&#x3D;1; BD_HOME&#x3D;1; sugstore&#x3D;0 &#x2F;&#x2F;当前域名下的Cookie<br>Accept: text&#x2F;html,image&#x2F;apng &#x2F;&#x2F;代表客户端希望接受的数据类型是html或者是png图片类型<br>Accept-Encoding: gzip, deflate &#x2F;&#x2F;代表客户端能支持gzip和deflate格式的压缩<br>Accept-Language: zh-CN,zh;q&#x3D;0.9 &#x2F;&#x2F;代表客户端可以支持语言zh-CN或者zh(值得一提的是q(0~1)是优先级权重的意思，不写默认为1，这里zh-CN是1，zh是0.9)<br>Connection: keep-alive &#x2F;&#x2F;告诉服务器，客户端需要的tcp连接是一个长连接</p><p>Response Header:<br>HTTP&#x2F;1.1 200 OK &#x2F;&#x2F; 响应状态行：{http协议、http版本 响应码 状态}<br>Date: Mon, 30 Jul 2018 02:50:55 GMT &#x2F;&#x2F;服务端发送资源时的服务器时间<br>Expires: Wed, 31 Dec 1969 23:59:59 GMT &#x2F;&#x2F;比较过时的一种验证缓存的方式，与浏览器（客户端）的时间比较，超过这个时间就不用缓存（不和服务器进行验证），适合版本比较稳定的网页<br>Cache-Control: no-cache &#x2F;&#x2F; 现在最多使用的控制缓存的方式，会和服务器进行缓存验证<br>etag: “fb8ba2f80b1d324bb997cbe188f28187-ssl-df” &#x2F;&#x2F; 一般是Nginx静态服务器发来的静态文件签名，浏览在没有“Disabled cache”情况下，接收到etag后，同一个url第二次请求就会自动带上“If-None-Match”<br>Last-Modified: Fri, 27 Jul 2018 11:04:55 GMT &#x2F;&#x2F;是服务器发来的当前资源最后一次修改的时间，下次请求时，如果服务器上当前资源的修改时间大于这个时间，就返回新的资源内容<br>Content-Type: text&#x2F;html; charset&#x3D;utf-8 &#x2F;&#x2F;如果返回是流式的数据，我们就必须告诉浏览器这个头，不然浏览器会下载这个页面，同时告诉浏览器是utf8编码，否则可能出现乱码<br>Content-Encoding: gzip &#x2F;&#x2F;告诉客户端，应该采用gzip对资源进行解码<br>Connection: keep-alive &#x2F;&#x2F;告诉客户端服务器的tcp连接也是一个长连接</p></div><div class="story post-story"><h2 id="https-的基本概念"><a href="#https-的基本概念" class="headerlink" title="https 的基本概念"></a>https 的基本概念</h2><p>https:是以安全为目标的 HTTP 通道，即 HTTP 下 加入 SSL 层进行加密。</p></div><div class="story post-story"><h2 id="http-和-https-的区别？"><a href="#http-和-https-的区别？" class="headerlink" title="http 和 https 的区别？"></a>http 和 https 的区别？</h2><p>• http 是超文本传输协议，信息是明文传输，https 则是具有安全性的 ssl 加密传输协议。<br>• https 协议需要 ca 证书，费用较高。<br>• 使用不同的链接方式，端口也不同，一般，http 协议的端口为 80，https 的端口为 443。<br>• http 的连接很简单，是无状态的。</p></div><div class="story post-story"><h2 id="https-协议的工作原理"><a href="#https-协议的工作原理" class="headerlink" title="https 协议的工作原理"></a>https 协议的工作原理</h2><ul><li>客户端使用 https url 访问服务器，则要求 web 服务器建立 ssl 链接。</li><li>web 服务器接收到客户端的请求之后，会将网站的证书（证书中包含了公钥），传输给客户端。</li><li>客户端和 web 服务器端开始协商 SSL 链接的安全等级，也就是加密等级。</li><li>客户端浏览器通过双方协商一致的安全等级，建立会话密钥，然后通过网站的公钥来加密会话密钥，并传送给网站。</li><li>web 服务器通过自己的私钥解密出会话密钥。</li><li>web 服务器通过会话密钥加密与客户端之间的通信。</li></ul></div><div class="story post-story"><h2 id="https-协议的优缺点"><a href="#https-协议的优缺点" class="headerlink" title="https 协议的优缺点"></a>https 协议的优缺点</h2><p>• HTTPS 协议要比 http 协议安全，可防止数据在传输过程中被窃取、改变，确保数据的完整性。<br>• https 握手阶段比较费时，会使页面加载时间延长 50%，增加 10%~20%的耗电。<br>• https 缓存不如 http 高效，会增加数据开销。<br>• SSL 证书也需要钱，功能越强大的证书费用越高。<br>• SSL 证书需要绑定 IP，不能再同一个 ip 上绑定多个域名，ipv4 资源支持不了这种消耗。</p></div><div class="story post-story"><h2 id="TCP-IP网络模型"><a href="#TCP-IP网络模型" class="headerlink" title="TCP&#x2F;IP网络模型"></a>TCP&#x2F;IP网络模型</h2><p>链路层：负责封装和解封装IP报文，发送和接受ARP&#x2F;RARP报文等。<br>网络层：负责路由以及把分组报文发送给目标网络或主机。<br>传输层：负责对报文进行分组和重组，并以TCP或UDP协议格式封装报文。<br>应用层：负责向用户提供应用程序，比如HTTP、FTP、Telnet、DNS、SMTP等。</p></div><div class="story post-story"><h2 id="TCP三次握手"><a href="#TCP三次握手" class="headerlink" title="TCP三次握手"></a>TCP三次握手</h2><p>第一次握手：客户端发送syn包到服务器，并进入SYN_SENT状态，等待服务器确认<br>第二次握手：服务器收到syn包，发送SYN+ACK包，此时服务器进入SYN_RECV状态；<br>第三次握手：客户端收到服务器的SYN+ACK包，向服务器发送ACK包，此包发送完毕，客户端和服务器进入ESTABLISHED状态，完成三次握手。<br>握手过程中传送的包里不包含数据，三次握手完毕后，客户端与服务器才正式开始传送数据。</p></div><div class="story post-story"><h2 id="TCP-四次挥手"><a href="#TCP-四次挥手" class="headerlink" title="TCP 四次挥手"></a>TCP 四次挥手</h2><p>客户端进程发出连接释放报文，并且停止发送数据。释放数据报文首部，FIN&#x3D;1，其序列号为seq&#x3D;u（等于前面已经传送过来的数据的最后一个字节的序号加1），此时，客户端进入FIN-WAIT-1（终止等待1）状态。 TCP规定，FIN报文段即使不携带数据，也要消耗一个序号。<br>服务器收到连接释放报文，发出确认报文，ACK&#x3D;1，ack&#x3D;u+1，并且带上自己的序列号seq&#x3D;v，此时，服务端就进入了CLOSE-WAIT（关闭等待）状态。TCP服务器通知高层的应用进程，客户端向服务器的方向就释放了，这时候处于半关闭状态，即客户端已经没有数据要发送了，但是服务器若发送数据，客户端依然要接受。这个状态还要持续一段时间，也就是整个CLOSE-WAIT状态持续的时间。<br>客户端收到服务器的确认请求后，此时，客户端就进入FIN-WAIT-2（终止等待2）状态，等待服务器发送连接释放报文（在这之前还需要接受服务器发送的最 后的数据）。<br>服务器将最后的数据发送完毕后，就向客户端发送连接释放报文，FIN&#x3D;1，ack&#x3D;u+1，由于在半关闭状态，服务器很可能又发送了一些数据，假定此时的序列号为seq&#x3D;w，此时，服务器就进入了LAST-ACK（最后确认）状态，等待客户端的确认。<br>客户端收到服务器的连接释放报文后，必须发出确认，ACK&#x3D;1，ack&#x3D;w+1，而自己的序列号是seq&#x3D;u+1，此时，客户端就进入了TIME-WAIT（时间等待）状态。注意此时TCP连接还没有释放，必须经过2∗∗MSL（最长报文段寿命）的时间后，当客户端撤销相应的TCB后，才进入CLOSED状态。<br>服务器只要收到了客户端发出的确认，立即进入CLOSED状态。同样，撤销TCB后，就结束了这次的TCP连接。可以看到，服务器结束TCP连接的时间要比客户端早一些。</p></div><div class="story post-story"><h2 id="TCP和UDP的区别"><a href="#TCP和UDP的区别" class="headerlink" title="TCP和UDP的区别"></a>TCP和UDP的区别</h2><p>TCP的三次握手保证了连接的可靠性; UDP是无连接的、不可靠的一种数据传输协议。</p><p>TCP仅支持单播传输，UDP 提供了单播，多播，广播的功能。</p><p>UDP的头部开销比TCP的更小，数据传输速率更高，实时性更好。</p></div><div class="story post-story"><h2 id="Cookie、sessionStorage、localStorage-的区别"><a href="#Cookie、sessionStorage、localStorage-的区别" class="headerlink" title="Cookie、sessionStorage、localStorage 的区别"></a>Cookie、sessionStorage、localStorage 的区别</h2><p>相同点：存储在客户端<br>不同点：</p><p>cookie数据大小不能超过4k；sessionStorage和localStorage的存储比cookie大得多，可以达到5M+<br>cookie设置的过期时间之前一直有效；localStorage永久存储，浏览器关闭后数据不丢失除非主动删除数据；sessionStorage数据在当前浏览器窗口关闭后自动删除<br>cookie的数据会自动的传递到服务器；sessionStorage和localStorage数据保存在本地</p></div><div class="story post-story"><h2 id="HTTP状态码及常见状态码"><a href="#HTTP状态码及常见状态码" class="headerlink" title="HTTP状态码及常见状态码"></a>HTTP状态码及常见状态码</h2><h3 id="HTTP状态码"><a href="#HTTP状态码" class="headerlink" title="HTTP状态码"></a>HTTP状态码</h3><p>• 1xx：指示信息类，表示请求已接受，继续处理<br>• 2xx：指示成功类，表示请求已成功接受<br>• 3xx：指示重定向，表示要完成请求必须进行更近一步的操作<br>• 4xx：指示客户端错误，请求有语法错误或请求无法实现<br>• 5xx：指示服务器错误，服务器未能实现合法的请求</p><h3 id="常见状态码"><a href="#常见状态码" class="headerlink" title="常见状态码"></a>常见状态码</h3><p>• 200 OK：客户端请求成功<br>• 301 Moved Permanently：所请求的页面已经永久重定向至新的URL<br>• 302 Found：所请求的页面已经临时重定向至新的URL<br>• 304 Not Modified 未修改<br>• 403 Forbidden：对请求页面的访问被禁止<br>• 404 Not Found：请求资源不存在<br>• 500 Internal Server Error：服务器发生不可预期的错误原来缓冲的文档还可以继续使用<br>• 503 Server Unavailable：请求未完成，服务器临时过载或宕机，一段时间后可恢复正常</p><p>• 1xx（临时响应）表示临时响应并需要请求者继续执行操作的状态码<br>  o 100 - 继续 请求者应当继续提出请求。服务器返回此代码表示已收到请求的第一部分，正在等待其余部分<br>  o 101 - 切换协议 请求者已要求服务器切换协议，服务器已确认并准备切换<br>• 2xx（成功）表示成功处理了请求的状态码<br> o 200 - 成功 服务器已经成功处理了请求。通常，这表示服务器提供了请求的网页<br> o 201 - 已创建 请求成功并且服务器创建了新的资源<br> o 202 - 已接受 服务器已接受请求，但尚未处理<br> o 203 - 非授权信息 服务器已经成功处理了请求，但返回的信息可能来自另一来源<br> o 204 - 无内容 服务器成功处理了请求，但没有返回任何内容<br> o 205 - 重置内容 服务器成功处理了请求，但没有返回任何内容<br>• 3xx（重定向）表示要完成请求，需要进一步操作；通常，这些状态代码用来重定向<br> o 300 - 多种选择 针对请求，服务器可执行多种操作。服务器可根据请求者（user agent）选择一项操作，或提供操作列表供请求者选择<br> o 301 - 永久移动 请求的网页已永久移动到新位置。服务器返回此响应（对GET或HEAD请求的响应）时，会自动将请求者转到新位置<br> o 302 - 临时移动 服务器目前从不同位置的网页响应请求，但请求者应继续使用原有位置来进行以后的请求<br> o 303 - 查看其它位置 请求者应当对不同的位置使用单独的GET请求来检索响应时，服务器返回此代码<br> o 304 - 未修改 自上次请求后，请求的网页未修改过。服务器返回此响应，不会返回网页的内容<br> o 305 - 使用代理 请求者只能使用代理访问请求的网页。如果服务器返回此响应，还表示请求者应使用代理<br> o 307 - 临时性重定向 服务器目前从不同位置的网页响应请求，但请求者应继续使用原有的位置来进行以后的请求<br>• 4xx（请求错误）这些状态码表示请求可能出错，妨碍了服务器的处理<br> o 400 - 错误请求 服务器不理解请求的语法<br> o 401 - 未授权 请求要求身份验证。对于需要登录的网页，服务器可能返回此响应<br> o 403 - 禁止 服务器拒绝请求<br> o 404 - 未找到 服务器找不到请求的网页<br> o 405 - 方法禁用 禁用请求中指定的方法<br> o 406 - 不接受 无法使用请求的内容特性响应请求的网页<br> o 407 - 需要代理授权 此状态码与401（未授权）类似，但指定请求者应当授权使用代理<br> o 408 - 请求超时 服务器等候请求时发生超时<br> o 410 - 已删除 如果请求的资源已永久删除，服务器就会返回此响应<br> o 413 - 请求实体过大 服务器无法处理请求，因为请求实体过大，超出了服务器的处理能力<br> o 414 - 请求的URI过长 请求的URI（通常为网址）过长，服务器无法处理<br>• 5xx（服务器错误）这些状态码表示服务器在尝试处理请求时发生内部错误。这些错误可能是服务器本身的错误，而不是请求出错<br> o 500 - 服务器内部错误 服务器遇到错误，无法完成请求<br> o 501 - 尚未实施 服务器不具备完成请求的功能。例如，服务器无法识别请求方法时可能会返回此代码<br> o 502 - 错误网关 服务器作为网关或代理，从上游服务器无法收到无效响应<br> o 503 - 服务器不可用 服务器目前无法使用（由于超载或者停机维护）。通常，这只是暂时状态<br> o 504 - 网关超时 服务器作为网关代理，但是没有及时从上游服务器收到请求<br> o 505 - HTTP版本不受支持 服务器不支持请求中所用的HTTP协议版本</p></div><div class="story post-story"><h2 id="HTTP-请求跨域问题"><a href="#HTTP-请求跨域问题" class="headerlink" title="HTTP 请求跨域问题"></a>HTTP 请求跨域问题</h2><h3 id="跨域的原理"><a href="#跨域的原理" class="headerlink" title="跨域的原理"></a>跨域的原理</h3><p>跨域，是指浏览器不能执行其他网站的脚本。它是由浏览器的同源策略造成的。跨域访问是被各大浏览器所默认禁止的。<br>同源策略,是浏览器对 JavaScript 实施的安全限制，只要协议、域名、端口有任何一个不同，都被当作是不同的域。<br>跨域原理，即是通过各种方式，避开浏览器的安全限制。</p><h3 id="同源策略的作用"><a href="#同源策略的作用" class="headerlink" title="同源策略的作用"></a>同源策略的作用</h3><p>①无法用js读取非同源的Cookie、LocalStorage 和 IndexDB<br>这个主要是为了防止恶意网站通过js获取用户其他网站的cookie等用户信息。</p><p>②无法用js获取非同源的DOM<br>防止恶意网站通过iframe获取页面dom，从而窃取页面的信息。</p><p>③无法用js发送非同源的AJAX请求<br>防止恶意的请求攻击服务器窃取数据信息。</p><h3 id="跨域资源共享"><a href="#跨域资源共享" class="headerlink" title="跨域资源共享"></a>跨域资源共享</h3><p><strong>原理：</strong>CORS由一系列HTTP响应头组成，这些响应头决定浏览器是否阻止前端JS代码跨域获取资源。浏览器的同源安全策略（协议、ip地址、端口号必须相同）默认会阻止网页”跨域“获取资源。但是如果接口服务器配置了CORS相关的HTTP响应头，就可以解除浏览器端的跨域访问限制。</p><table><thead><tr><th>CORS响应头部</th><th>描述</th></tr></thead><tbody><tr><td>res.setHeader(‘Access-Control-Allow-Origin’,’*’)</td><td>设置允许访问该资源的外域URL</td></tr><tr><td>res.setHeader(‘Access-Control-Allow-Headers’,’X-Custom-Header’)</td><td>对额外的请求头进行声明</td></tr><tr><td>res.setHeader(‘Access-Control-Allow-Methods’,’*’)</td><td>设置实际请求所允许使用的HTTP方法</td></tr></tbody></table><h3 id="预检请求"><a href="#预检请求" class="headerlink" title="预检请求"></a>预检请求</h3><p>只要符合以下任何条件之一，都需要进行预检请求：</p><ol><li>请求方式为GET、POST、HEAD之外的请求Method类型</li><li>请求头中包含自定义头部字段</li><li>向服务器发送了application&#x2F;json格式的数据</li></ol><p>在浏览器与服务器正式通信之前，浏览器会先发送OPTION请求进行预检，以获知服务器是否允许该实际请求，所以这一次的OPTION请求称为“预检请求”。服务器成功响应预检请求后，才会发送真正的请求，并携带真实数据。</p><h3 id="JSONP接口"><a href="#JSONP接口" class="headerlink" title="JSONP接口"></a>JSONP接口</h3><p>浏览器通过<code>&lt;script&gt;</code>标签的src属性，请求服务器上的数据，同时，服务器返回一个函数的调用。这种请求数据的方式叫做JSONP</p><p>JSONP不属于真正的Ajax请求，没有使用XMLHttpRequest这个对象。JSONP仅支持GET请求，不支持POST、PUT、DELETE请求。需要后台配合，将返回结果包装成callback(res)的形式。</p><p>JSONP接口要声明在CORS接口之前</p><p>防范<br>那如果黑客植入script脚本通过jsonp的方式对服务器进行攻击，怎么办？<br>可以通过页面设置的<strong>内容安全协议csp</strong>进行防范。</p></div>]]></content>
    
    
      
      
    <summary type="html">&lt;div class=&quot;story post-story&quot;&gt;&lt;h2 id=&quot;HTTP-的基本概念&quot;&gt;&lt;a href=&quot;#HTTP-的基本概念&quot; class=&quot;headerlink&quot; title=&quot;HTTP 的基本概念&quot;&gt;&lt;/a&gt;HTTP 的基本概念&lt;/h2&gt;&lt;p&gt;互联网上应用最为</summary>
      
    
    
    
    <category term="学习笔记" scheme="http://example.com/categories/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/"/>
    
    
    <category term="面试八股" scheme="http://example.com/tags/%E9%9D%A2%E8%AF%95%E5%85%AB%E8%82%A1/"/>
    
  </entry>
  
  <entry>
    <title>分布式实验2_Hadoop(HDFS)分布式文件系统基本操作</title>
    <link href="http://example.com/2024/11/03/%E5%88%86%E5%B8%83%E5%BC%8F%E5%AE%9E%E9%AA%8C2-Hadoop-HDFS-%E5%88%86%E5%B8%83%E5%BC%8F%E6%96%87%E4%BB%B6%E7%B3%BB%E7%BB%9F%E5%9F%BA%E6%9C%AC%E6%93%8D%E4%BD%9C/"/>
    <id>http://example.com/2024/11/03/%E5%88%86%E5%B8%83%E5%BC%8F%E5%AE%9E%E9%AA%8C2-Hadoop-HDFS-%E5%88%86%E5%B8%83%E5%BC%8F%E6%96%87%E4%BB%B6%E7%B3%BB%E7%BB%9F%E5%9F%BA%E6%9C%AC%E6%93%8D%E4%BD%9C/</id>
    <published>2024-11-03T10:46:33.000Z</published>
    <updated>2024-11-03T13:44:03.171Z</updated>
    
    <content type="html"><![CDATA[<h1 id="实验2-Hadoop-HDFS-分布式文件系统基本操作"><a href="#实验2-Hadoop-HDFS-分布式文件系统基本操作" class="headerlink" title="实验2 Hadoop(HDFS)分布式文件系统基本操作"></a>实验2 Hadoop(HDFS)分布式文件系统基本操作</h1><div class="story post-story"><h2 id="基本语法"><a href="#基本语法" class="headerlink" title="基本语法"></a>基本语法</h2><p>hadoop fs 具体命令 OR hdfs dfs 具体命令</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><span class="line">Usage: hadoop fs [generic options]</span><br><span class="line">        [-appendToFile &lt;localsrc&gt; ... &lt;dst&gt;]</span><br><span class="line">        [-cat [-ignoreCrc] &lt;src&gt; ...]</span><br><span class="line">        [-checksum &lt;src&gt; ...]</span><br><span class="line">        [-chgrp [-R] GROUP PATH...]</span><br><span class="line">        [-chmod [-R] &lt;MODE[,MODE]... | OCTALMODE&gt; PATH...]</span><br><span class="line">        [-chown [-R] [OWNER][:[GROUP]] PATH...]</span><br><span class="line">        [-copyFromLocal [-f] [-p] [-l] [-d] [-t &lt;thread count&gt;] &lt;localsrc&gt; ... &lt;dst&gt;]</span><br><span class="line">        [-copyToLocal [-f] [-p] [-ignoreCrc] [-crc] &lt;src&gt; ... &lt;localdst&gt;]</span><br><span class="line">        [-count [-q] [-h] [-v] [-t [&lt;storage type&gt;]] [-u] [-x] [-e] &lt;path&gt; ...]</span><br><span class="line">        [-cp [-f] [-p | -p[topax]] [-d] &lt;src&gt; ... &lt;dst&gt;]</span><br><span class="line">        [-createSnapshot &lt;snapshotDir&gt; [&lt;snapshotName&gt;]]</span><br><span class="line">        [-deleteSnapshot &lt;snapshotDir&gt; &lt;snapshotName&gt;]</span><br><span class="line">        [-df [-h] [&lt;path&gt; ...]]</span><br><span class="line">        [-du [-s] [-h] [-v] [-x] &lt;path&gt; ...]</span><br><span class="line">        [-expunge]</span><br><span class="line">        [-find &lt;path&gt; ... &lt;expression&gt; ...]</span><br><span class="line">        [-get [-f] [-p] [-ignoreCrc] [-crc] &lt;src&gt; ... &lt;localdst&gt;]</span><br><span class="line">        [-getfacl [-R] &lt;path&gt;]</span><br><span class="line">        [-getfattr [-R] &#123;-n name | -d&#125; [-e en] &lt;path&gt;]</span><br><span class="line">        [-getmerge [-nl] [-skip-empty-file] &lt;src&gt; &lt;localdst&gt;]</span><br><span class="line">        [-head &lt;file&gt;]</span><br><span class="line">        [-help [cmd ...]]</span><br><span class="line">        [-ls [-C] [-d] [-h] [-q] [-R] [-t] [-S] [-r] [-u] [-e] [&lt;path&gt; ...]]</span><br><span class="line">        [-mkdir [-p] &lt;path&gt; ...]</span><br><span class="line">        [-moveFromLocal &lt;localsrc&gt; ... &lt;dst&gt;]</span><br><span class="line">        [-moveToLocal &lt;src&gt; &lt;localdst&gt;]</span><br><span class="line">        [-mv &lt;src&gt; ... &lt;dst&gt;]</span><br><span class="line">        [-put [-f] [-p] [-l] [-d] &lt;localsrc&gt; ... &lt;dst&gt;]</span><br><span class="line">        [-renameSnapshot &lt;snapshotDir&gt; &lt;oldName&gt; &lt;newName&gt;]</span><br><span class="line">        [-rm [-f] [-r|-R] [-skipTrash] [-safely] &lt;src&gt; ...]</span><br><span class="line">        [-rmdir [--ignore-fail-on-non-empty] &lt;dir&gt; ...]</span><br><span class="line">        [-setfacl [-R] [&#123;-b|-k&#125; &#123;-m|-x &lt;acl_spec&gt;&#125; &lt;path&gt;]|[--set &lt;acl_spec&gt; &lt;path&gt;]]</span><br><span class="line">        [-setfattr &#123;-n name [-v value] | -x name&#125; &lt;path&gt;]</span><br><span class="line">        [-setrep [-R] [-w] &lt;rep&gt; &lt;path&gt; ...]</span><br><span class="line">        [-stat [format] &lt;path&gt; ...]</span><br><span class="line">        [-tail [-f] [-s &lt;sleep interval&gt;] &lt;file&gt;]</span><br><span class="line">        [-test -[defsz] &lt;path&gt;]</span><br><span class="line">        [-text [-ignoreCrc] &lt;src&gt; ...]</span><br><span class="line">        [-touch [-a] [-m] [-t TIMESTAMP ] [-c] &lt;path&gt; ...]</span><br><span class="line">        [-touchz &lt;path&gt; ...]</span><br><span class="line">        [-truncate [-w] &lt;length&gt; &lt;path&gt; ...]</span><br><span class="line">        [-usage [cmd ...]]</span><br><span class="line"></span><br><span class="line">Generic options supported are:</span><br><span class="line">-conf &lt;configuration file&gt;        specify an application configuration file</span><br><span class="line">-D &lt;property=value&gt;               define a value for a given property</span><br><span class="line">-fs &lt;file:///|hdfs://namenode:port&gt; specify default filesystem URL to use, overrides &#x27;fs.defaultFS&#x27; property from configurations.</span><br><span class="line">-jt &lt;local|resourcemanager:port&gt;  specify a ResourceManager</span><br><span class="line">-files &lt;file1,...&gt;                specify a comma-separated list of files to be copied to the map reduce cluster</span><br><span class="line">-libjars &lt;jar1,...&gt;               specify a comma-separated list of jar files to be included in the classpath</span><br><span class="line">-archives &lt;archive1,...&gt;          specify a comma-separated list of archives to be unarchived on the compute machines</span><br><span class="line"></span><br><span class="line">The general command line syntax is:</span><br><span class="line">command [genericOptions] [commandOptions]</span><br></pre></td></tr></table></figure><p>-help：输出这个命令参数</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hadoop fs -help rm</span><br></pre></td></tr></table></figure></div><div class="story post-story"><h2 id="准备工作"><a href="#准备工作" class="headerlink" title="准备工作"></a>准备工作</h2><p>创建&#x2F;sanguo文件夹</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hadoop fs -<span class="built_in">mkdir</span> /sanguo</span><br></pre></td></tr></table></figure></div><div class="story post-story"><h2 id="上传"><a href="#上传" class="headerlink" title="上传"></a>上传</h2><ol><li><p>-moveFromLocal: 从本地剪切粘贴到HDFS</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vim shuguo.txt</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">shuguo</span><br></pre></td></tr></table></figure></li><li><p>-copyFromLocal：从本地文件系统中拷贝文件到 HDFS 路径去</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vim weiguo.txt</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">weiguo</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hadoop fs -copyFromLocal weiguo.txt /sanguo</span><br></pre></td></tr></table></figure></li><li><p>-put：等同于 copyFromLocal，生产环境更习惯用 put</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vim wuguo.txt</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">wuguo</span><br></pre></td></tr></table></figure></li><li><p>-appendToFile：追加一个文件到已经存在的文件末尾</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vim liubei.txt</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">liubei</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hadoop fs -appendToFile liubei.txt /sanguo/shuguo.txt</span><br></pre></td></tr></table></figure></li></ol></div><div class="story post-story"><h2 id="下载"><a href="#下载" class="headerlink" title="下载"></a>下载</h2><ol><li><p>-copyToLocal：从 HDFS 拷贝到本地</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hadoop fs -copyToLocal /sanguo/shuguo.txt ./</span><br></pre></td></tr></table></figure></li><li><p>-get：等同于 copyToLocal，生产环境更习惯用 get</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hadoop fs -get /sanguo/shuguo.txt ./shuguo2.txt</span><br></pre></td></tr></table></figure></li></ol></div><div class="story post-story"><h2 id="HDFS-直接操作"><a href="#HDFS-直接操作" class="headerlink" title="HDFS 直接操作"></a>HDFS 直接操作</h2><ol><li><p>-ls: 显示目录信息</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hadoop fs -ls /sanguo</span><br></pre></td></tr></table></figure></li><li><p>-cat：显示文件内容</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hadoop fs -cat /sanguo/shuguo.txt</span><br></pre></td></tr></table></figure></li><li><p>-chgrp、-chmod、-chown：Linux文件系统中的用法一样，修改文件所属权限</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hadoop fs -chmod 666 /sanguo/shuguo.txt</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hadoop fs -chown atguigu:atguigu /sanguo/shuguo.txt</span><br></pre></td></tr></table></figure></li><li><p>-mkdir：创建路径</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hadoop fs -mkdir /jinguo</span><br></pre></td></tr></table></figure></li><li><p>-cp：从HDFS的一个路径拷贝到 HDFS 的另一个路径</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hadoop fs -cp /sanguo/shuguo.txt /jinguo</span><br></pre></td></tr></table></figure></li><li><p>-mv：在 HDFS 目录中移动文件</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hadoop fs -mv /sanguo/wuguo.txt /jinguo</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hadoop fs -mv /sanguo/weiguo.txt /jinguo</span><br></pre></td></tr></table></figure></li><li><p>-tail：显示一个文件的末尾 1kb 的数据</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hadoop fs -tail /jinguo/shuguo.txt</span><br></pre></td></tr></table></figure></li><li><p>-rm：删除文件或文件夹</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hadoop fs -rm /sanguo/shuguo.txt</span><br></pre></td></tr></table></figure></li><li><p>-rm -r：递归删除目录及目录里面内容</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hadoop fs -rm -r /sanguo</span><br></pre></td></tr></table></figure></li><li><p>-du 统计文件夹的大小信息</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">hadoop fs -du -s -h /jinguo</span><br><span class="line">//输出</span><br><span class="line">27 81 /jinguo</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">hadoop fs -du -h /jinguo</span><br><span class="line">//输出</span><br><span class="line">14 42 /jinguo/shuguo.txt</span><br><span class="line">7 21 /jinguo/weiguo.txt</span><br><span class="line">6 18 /jinguo/wuguo.tx</span><br></pre></td></tr></table></figure></li><li><p>-setrep：设置 HDFS 中文件的副本数量</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hadoop fs -setrep 10 /jinguo/shuguo.txt</span><br></pre></td></tr></table></figure></li></ol></div>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;实验2-Hadoop-HDFS-分布式文件系统基本操作&quot;&gt;&lt;a href=&quot;#实验2-Hadoop-HDFS-分布式文件系统基本操作&quot; class=&quot;headerlink&quot; title=&quot;实验2 Hadoop(HDFS)分布式文件系统基本操作&quot;&gt;&lt;/a&gt;实验2 H</summary>
      
    
    
    
    <category term="学习笔记" scheme="http://example.com/categories/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/"/>
    
    
    <category term="HDFS基本操作" scheme="http://example.com/tags/HDFS%E5%9F%BA%E6%9C%AC%E6%93%8D%E4%BD%9C/"/>
    
  </entry>
  
  <entry>
    <title>cpp课程笔记</title>
    <link href="http://example.com/2024/10/27/cpp%E8%AF%BE%E7%A8%8B%E7%AC%94%E8%AE%B0/"/>
    <id>http://example.com/2024/10/27/cpp%E8%AF%BE%E7%A8%8B%E7%AC%94%E8%AE%B0/</id>
    <published>2024-10-27T11:45:52.000Z</published>
    <updated>2024-10-30T03:22:16.227Z</updated>
    
    <content type="html"><![CDATA[<h1 id="面向对象编程"><a href="#面向对象编程" class="headerlink" title="面向对象编程"></a>面向对象编程</h1><div class="story post-story"><h2 id="封装"><a href="#封装" class="headerlink" title="封装"></a>封装</h2><p>将抽象出来的对象的属性和行为结合成一个独立的单位，并尽可能隐蔽对象的内部细节</p></div><div class="story post-story"><h2 id="继承"><a href="#继承" class="headerlink" title="继承"></a>继承</h2><p>一个类除具有另一个类的全部特征外，又有自己的新特征，则形成一种层次结构，即继承结构</p><h3 id="命名冲突的表现形式"><a href="#命名冲突的表现形式" class="headerlink" title="命名冲突的表现形式"></a>命名冲突的表现形式</h3><ul><li>派生类和某个基类之间发生命名冲突</li><li>基类与基类之间发生命名冲突</li></ul><h3 id="解决命名冲突问题的方法"><a href="#解决命名冲突问题的方法" class="headerlink" title="解决命名冲突问题的方法"></a>解决命名冲突问题的方法</h3><p>使用域解析符</p></div><div class="story post-story"><h2 id="多态"><a href="#多态" class="headerlink" title="多态"></a>多态</h2><p>不同类对象收到同一个消息可以产生完全不同的响应效果，这种现象叫多态</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">B</span> &#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line"><span class="function"><span class="keyword">virtual</span> <span class="type">void</span> <span class="title">f</span><span class="params">()</span> </span>&#123; cout &lt;&lt; <span class="string">&quot;B\n&quot;</span>; &#125;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">class</span> <span class="title class_">D1</span>:<span class="keyword">public</span> B &#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line"><span class="function"><span class="keyword">virtual</span> <span class="type">void</span> <span class="title">f</span><span class="params">()</span> </span>&#123; cout &lt;&lt; <span class="string">&quot;D1\n&quot;</span>; &#125;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">class</span> <span class="title class_">D2</span>:<span class="keyword">public</span> B &#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line"><span class="function"><span class="keyword">virtual</span> <span class="type">void</span> <span class="title">f</span><span class="params">()</span> </span>&#123; cout &lt;&lt; <span class="string">&quot;D2\n&quot;</span>; &#125;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">D1 d1;</span><br><span class="line">D2 d2;</span><br><span class="line">d<span class="number">1.f</span>();</span><br><span class="line">d<span class="number">2.f</span>();</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//输出</span></span><br><span class="line">D1</span><br><span class="line">D2</span><br></pre></td></tr></table></figure></div><div class="story post-story"><h2 id="接口"><a href="#接口" class="headerlink" title="接口"></a>接口</h2><p>接口是类的一种约束形式。对象的接口以一组方法的形式出现，为不相关的类提供通用的处理服务</p></div><div class="story post-story"><h2 id="组件"><a href="#组件" class="headerlink" title="组件"></a>组件</h2><p>组件是可以在不同的应用程序中使用的对象集合</p><p>COM(Component Object Model):一种不依赖于任何语言的组件对象模型</p><p>DCOM：COM组件的扩展，处理网络协议的低层次的细节问题</p></div><div class="story post-story"><h2 id="面向对象开发"><a href="#面向对象开发" class="headerlink" title="面向对象开发"></a>面向对象开发</h2><ul><li>面向对象分析OOA</li><li>面向对象设计OOD</li><li>面向对象实现OOP</li></ul><h1 id="C"><a href="#C" class="headerlink" title="C++"></a>C++</h1><p>C++与C的差别</p><ul><li>C++是面向对象的程序设计语言，程序的结构采用“对象+消息”模式</li><li>C是面向过程的程序设计语言，程序的结构采用“数据+算法”模式</li></ul><p>C++对C的改进</p><ul><li><p>类型更加严格</p></li><li><p>输入输出更加方便</p></li><li><p>常量定义时指出类型</p></li><li><p>允许函数重载和运算符重载函数</p></li><li><p>增加了一些运算符</p></li><li><p>引进了引用的概念，减少了指针的使用</p></li><li><p>引进了内联函数的概念，减少了宏定义的使用</p></li></ul></div><div class="story post-story"><h2 id="名字空间"><a href="#名字空间" class="headerlink" title="名字空间"></a>名字空间</h2><ul><li>std::out直接使用</li><li>using std::cout声明后可使用</li><li>using namespace std 以后使用时可以省略std::</li></ul><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="keyword">namespace</span> first &#123;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">f</span><span class="params">()</span> </span>&#123;</span><br><span class="line">cout &lt;&lt; <span class="string">&quot;first&quot;</span> &lt;&lt; endl;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">namespace</span> second &#123;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">f</span><span class="params">()</span> </span>&#123;</span><br><span class="line">cout &lt;&lt; <span class="string">&quot;second&quot;</span> &lt;&lt; endl;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> first::second;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line"><span class="built_in">f</span>();</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//输出</span></span><br><span class="line">second</span><br></pre></td></tr></table></figure><p>::加在变量前可以访问同名的全局变量</p></div><div class="story post-story"><h2 id="输入输出"><a href="#输入输出" class="headerlink" title="输入输出"></a>输入输出</h2><h3 id="操纵符"><a href="#操纵符" class="headerlink" title="操纵符"></a>操纵符</h3><ul><li><p>使用不带参数的操纵符必须包含iostream，使用带参数的操纵符需包含头文件iomanip</p></li><li><p>除了setw，其他操纵符将永久改变它所应用到的输入或输出流的状态</p></li><li><table><thead><tr><th>控制符</th><th>描述</th></tr></thead><tbody><tr><td>dec</td><td>十进制</td></tr><tr><td>hex</td><td>十六进制</td></tr><tr><td>oct</td><td>八进制</td></tr><tr><td>setfill(c)</td><td>设置填充字符为c</td></tr><tr><td>setprecision(n)</td><td>小数精度为n位</td></tr><tr><td>setw(n)</td><td>设置域宽为n</td></tr><tr><td>fixed&lt;&lt;setprecision(n)</td><td>设置小数点后位数为n</td></tr><tr><td>left|right</td><td>设置左&#x2F;右对齐</td></tr><tr><td>showpoint</td><td>强制显示小数点和全部尾部0</td></tr><tr><td>scientific</td><td>强制科学计数法输出</td></tr><tr><td>fixed</td><td>强制定点数输出</td></tr><tr><td>skipws</td><td>输入前跳过空格</td></tr><tr><td>boolalpha</td><td>bool表达式改为输出true|false</td></tr></tbody></table><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;iomanip&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line"><span class="type">double</span> amount = <span class="number">22.0</span> / <span class="number">7</span>;</span><br><span class="line">cout &lt;&lt; amount &lt;&lt; endl;</span><br><span class="line">cout &lt;&lt; <span class="built_in">setprecision</span>(<span class="number">0</span>) &lt;&lt; amount &lt;&lt; endl &lt;&lt; <span class="built_in">setprecision</span>(<span class="number">1</span>) &lt;&lt; amount &lt;&lt; endl</span><br><span class="line">&lt;&lt; <span class="built_in">setprecision</span>(<span class="number">2</span>) &lt;&lt; amount &lt;&lt; endl &lt;&lt; <span class="built_in">setprecision</span>(<span class="number">3</span>) &lt;&lt; amount &lt;&lt; endl</span><br><span class="line">&lt;&lt; <span class="built_in">setprecision</span>(<span class="number">4</span>) &lt;&lt; amount &lt;&lt; endl;</span><br><span class="line">cout &lt;&lt; <span class="string">&quot;fixed:&quot;</span> &lt;&lt; fixed;</span><br><span class="line">cout &lt;&lt; <span class="built_in">setprecision</span>(<span class="number">8</span>) &lt;&lt; amount &lt;&lt; endl;</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//输出</span></span><br><span class="line"><span class="number">3.14286</span></span><br><span class="line"><span class="number">3</span><span class="comment">//四舍五入到最近的整数</span></span><br><span class="line"><span class="number">3</span></span><br><span class="line"><span class="number">3.1</span></span><br><span class="line"><span class="number">3.14</span></span><br><span class="line"><span class="number">3.143</span></span><br><span class="line">fixed:<span class="number">3.14285714</span></span><br></pre></td></tr></table></figure><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;iomanip&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line"><span class="type">int</span> a = <span class="number">5</span>;</span><br><span class="line"><span class="type">float</span> b = <span class="number">1.05</span>;</span><br><span class="line">cout &lt;&lt; <span class="built_in">setfill</span>(<span class="string">&#x27;*&#x27;</span>) &lt;&lt; <span class="built_in">setprecision</span>(<span class="number">3</span>);</span><br><span class="line">cout &lt;&lt; left &lt;&lt; <span class="built_in">setw</span>(<span class="number">4</span>) &lt;&lt; a &lt;&lt; <span class="string">&quot; &quot;</span> &lt;&lt; right &lt;&lt; <span class="built_in">setw</span>(<span class="number">6</span>) &lt;&lt; b;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//输出</span></span><br><span class="line"><span class="number">5</span>*** **<span class="number">1.05</span></span><br></pre></td></tr></table></figure></li></ul></div><div class="story post-story"><h2 id="文件"><a href="#文件" class="headerlink" title="文件"></a>文件</h2><p>头文件fstream</p><ul><li>include <code>&lt;fstream&gt;</code></li><li>ifstream infile;</li><li>ofstream outfile;</li><li>infile.open(“income.in”);</li><li>outfile.open(“tax.out”);</li><li>infile.close();</li><li>outfile.close();</li></ul><h3 id="重定向IO"><a href="#重定向IO" class="headerlink" title="重定向IO"></a>重定向IO</h3><p>头文件cstdio</p><ul><li>include <code>&lt;cstdio&gt;</code></li><li>freopen(“CON”,”r”,stdin);|freopen(“CON”,”w”,stdout);|freopen(“CON”,”a”,stdout);</li><li>fclose(stdin)|fclose(stdout);</li></ul></div><div class="story post-story"><h2 id="const"><a href="#const" class="headerlink" title="const"></a>const</h2><p>const是一个左结合的类型操作符</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> x = <span class="number">5</span>;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span>* a=&amp;x;<span class="comment">// *a为常量（不能通过*a修改x），但a可变</span></span><br><span class="line"><span class="type">int</span> <span class="type">const</span> *a=&amp;x;<span class="comment">// *a为常量（不能通过*a修改x），但a可变</span></span><br><span class="line">x = <span class="number">10</span>;</span><br></pre></td></tr></table></figure><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> x=<span class="number">5</span>,y=<span class="number">10</span>;</span><br><span class="line"><span class="type">int</span>* <span class="type">const</span> p = &amp;x;<span class="comment">// p为常量（不能修改指向），但*p可变</span></span><br><span class="line">*p = <span class="number">4</span>;</span><br></pre></td></tr></table></figure><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> x=<span class="number">5</span>;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span>* <span class="type">const</span> a = &amp;b;<span class="comment">//指针本身和指向的内容均为常量</span></span><br></pre></td></tr></table></figure><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">sz</span>&#123;</span><br><span class="line">    <span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="type">int</span> &amp;<span class="title">f1</span><span class="params">()</span><span class="comment">//可修改mszT，可修改返回值</span></span></span><br><span class="line"><span class="function">        </span>&#123;mszT=<span class="number">5</span>; <span class="keyword">return</span> mszT;&#125;</span><br><span class="line">    <span class="function"><span class="type">const</span> <span class="type">int</span> &amp;<span class="title">f3</span><span class="params">()</span><span class="comment">//可修改mszT，不可修改返回值</span></span></span><br><span class="line"><span class="function">        </span>&#123;mszT=<span class="number">5</span>; <span class="keyword">return</span> mszT;&#125;</span><br><span class="line">    <span class="function"><span class="type">const</span> <span class="type">int</span> &amp;<span class="title">f4</span><span class="params">()</span> <span class="type">const</span><span class="comment">//不可修改mszT，不可修改返回值</span></span></span><br><span class="line"><span class="function">        </span>&#123;<span class="keyword">return</span> mszT;&#125;</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">print</span><span class="params">()</span></span>&#123;cout&lt;&lt;mszT&lt;&lt;endl;&#125;</span><br><span class="line">    <span class="keyword">private</span>:</span><br><span class="line">    <span class="type">int</span> mszT=<span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div><div class="story post-story"><h2 id="强制类型转换"><a href="#强制类型转换" class="headerlink" title="强制类型转换"></a>强制类型转换</h2><ul><li><p>static_cast&lt;要转换的数据类型&gt;(表达式)</p></li><li><p>const_cast 去掉常数性</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">const</span> <span class="type">int</span> x=<span class="number">5</span>,y=<span class="number">10</span>;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> *ptr=&amp;x;</span><br><span class="line"><span class="type">int</span>* ptr2 = <span class="built_in">const_cast</span>&lt;<span class="type">int</span>*&gt;(ptr)</span><br><span class="line">*ptr2 = <span class="number">4</span>;</span><br><span class="line">cout&lt;&lt;*ptr&lt;&lt;<span class="string">&#x27;\t&#x27;</span>&lt;&lt;x&lt;&lt;end;</span><br><span class="line"><span class="comment">//输出</span></span><br><span class="line"><span class="number">4</span>   <span class="number">5</span></span><br></pre></td></tr></table></figure></li></ul></div><div class="story post-story"><h2 id="枚举数据类型"><a href="#枚举数据类型" class="headerlink" title="枚举数据类型"></a>枚举数据类型</h2><ul><li>marital-status可以不用关键字enum</li><li>使用匿名枚举定义常量 enum{MinSize&#x3D;0,MaxSize&#x3D;1000}</li></ul></div><div class="story post-story"><h2 id="类与结构"><a href="#类与结构" class="headerlink" title="类与结构"></a>类与结构</h2><p>类：class</p><p>结构：struct</p><p>在缺省情况下，结构中所有东西都是Public而类中都是Private</p></div><div class="story post-story"><h2 id="string"><a href="#string" class="headerlink" title="string"></a>string</h2><p>头文件string</p><ul><li><p>函数c_str返回c风格字符串</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">string filename = <span class="string">&quot;1.txt&quot;</span>;</span><br><span class="line">ifstream infile;</span><br><span class="line">infile.<span class="built_in">open</span>(filename.<span class="built_in">c_str</span>())</span><br></pre></td></tr></table></figure></li><li><p>length()返回字符串长度</p></li><li><p>函数getline(输入流，字符串变量)，返回值用来判断文件是否结束   </p></li><li><p>erase(开始位置，长度)删除一个子串</p></li><li><p>insert(插入位置，插入的字符串)</p></li><li><p>replace(替代位置，子串大小，子串)</p></li><li><p>swap(字串)调换两个字符串</p></li><li><p>substr(子串索引，字串长度)</p></li><li><p>find(子串，初始查找位置)</p></li><li><p>find_first_of(s2) 查找字符的索引</p></li></ul></div><div class="story post-story"><h2 id="引用"><a href="#引用" class="headerlink" title="引用"></a>引用</h2><p>输入输出流作为参数传递时，必须用引用调用</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">void</span> <span class="title">print_row</span><span class="params">(ofstream&amp; out,<span class="type">char</span> c,<span class="type">int</span> n)</span></span>&#123;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;n;i++)&#123;</span><br><span class="line">        out&lt;&lt;c;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>使用引用返回时要保证函数返回时该单元仍然有效</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">int</span>&amp; <span class="title">f</span><span class="params">()</span> </span>&#123;</span><br><span class="line"><span class="type">static</span> <span class="type">int</span> i = <span class="number">5</span>;</span><br><span class="line"><span class="keyword">return</span> i;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">cout &lt;&lt; <span class="built_in">f</span>() &lt;&lt; endl;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div><div class="story post-story"><h2 id="内联函数"><a href="#内联函数" class="headerlink" title="内联函数"></a>内联函数</h2><ul><li>有函数结构，不具备函数性质</li><li>编译时，类似宏替换，用函数体替换函数名</li><li>避免了函数调用的开销，程序可以有效执行</li><li>解决频繁调用的小函数大量消耗栈空间</li><li>不能包含复杂的结构控制语句，不能递归</li></ul><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">const</span> <span class="type">char</span>* <span class="title">dbtest</span><span class="params">(<span class="type">int</span> a)</span> </span>&#123;</span><br><span class="line"><span class="keyword">return</span>  (a % <span class="number">2</span> &gt; <span class="number">0</span>)?   <span class="string">&quot;奇&quot;</span> : <span class="string">&quot;偶&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">10</span>; i++) &#123;</span><br><span class="line">cout &lt;&lt; i &lt;&lt; <span class="string">&quot;:&quot;</span> &lt;&lt; <span class="built_in">dbtest</span>(i) &lt;&lt; endl;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div><div class="story post-story"><h2 id="常见编程错误"><a href="#常见编程错误" class="headerlink" title="常见编程错误"></a>常见编程错误</h2><ul><li>using namespace gar::f();</li><li>using std;</li><li>不使用using又不指明名字空间使用std</li><li>输入输出不包含头文件<code>&lt;iostream&gt;</code></li><li>using namespace std不能包含<code>&lt;iostream.h&gt;</code></li><li>&lt;&lt;的优先级比关系、比较、逻辑和赋值运算符高</li><li>要使用带参数的操纵符，必须包含头文件iomanip</li><li>除了setw，其他操纵符都具有持久性</li><li>要进行文件操作，必须包含fstream</li><li>强制转换时格式为static_cast&lt;类型&gt;(表达式)</li><li>使用string类型必须包含头文件string</li><li>与文件相关的open函数接受C风格的字符串</li><li>关键词inline用于函数声明而不是函数定义</li><li>默认参数应该在函数声明而非函数定义中给出</li><li>没有默认值的参数必须出现在参数列表的前面</li><li>函数的返回类型不是函数签名的一部分</li></ul><h1 id="Python"><a href="#Python" class="headerlink" title="Python"></a>Python</h1><h3 id="深浅拷贝"><a href="#深浅拷贝" class="headerlink" title="深浅拷贝"></a>深浅拷贝</h3><p>python中的对象之间赋值时是按引用传送的，如果需要拷贝对象，需要使用标准库中的copy模块</p><ol><li>copy.copy浅拷贝</li><li>copy.deepcopy深拷贝</li></ol><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> copy</span><br><span class="line"><span class="keyword">class</span> <span class="title class_">c</span>():</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self,obj = <span class="literal">None</span></span>):</span><br><span class="line">        <span class="variable language_">self</span>.I = []</span><br><span class="line">        <span class="keyword">if</span> obj <span class="keyword">is</span> <span class="keyword">not</span> <span class="literal">None</span> <span class="keyword">and</span> <span class="built_in">isinstance</span>(obj,c):</span><br><span class="line">            <span class="variable language_">self</span>.I = copy.copy(obj.I)</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">pr</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="built_in">print</span>(<span class="variable language_">self</span>.I)</span><br><span class="line"></span><br><span class="line">t1 = c()</span><br><span class="line">t1.I = [<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,[<span class="string">&#x27;a&#x27;</span>,<span class="string">&#x27;b&#x27;</span>],<span class="number">4</span>]</span><br><span class="line">t2 = copy.copy(t1)</span><br><span class="line">t3 = copy.deepcopy(t1)</span><br><span class="line">t1.I.append(<span class="number">5</span>)</span><br><span class="line">t1.I[<span class="number">3</span>].append(<span class="number">4</span>)</span><br><span class="line">t1.I[<span class="number">0</span>] = <span class="string">&#x27;x&#x27;</span></span><br><span class="line">t1.pr()</span><br><span class="line">t2.pr()</span><br><span class="line">t3.pr()</span><br><span class="line"><span class="comment">## 结果</span></span><br><span class="line">[<span class="string">&#x27;x&#x27;</span>, <span class="number">2</span>, <span class="number">3</span>, [<span class="string">&#x27;a&#x27;</span>, <span class="string">&#x27;b&#x27;</span>, <span class="number">4</span>], <span class="number">4</span>, <span class="number">5</span>]</span><br><span class="line">[<span class="string">&#x27;x&#x27;</span>, <span class="number">2</span>, <span class="number">3</span>, [<span class="string">&#x27;a&#x27;</span>, <span class="string">&#x27;b&#x27;</span>, <span class="number">4</span>], <span class="number">4</span>, <span class="number">5</span>]</span><br><span class="line">[<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, [<span class="string">&#x27;a&#x27;</span>, <span class="string">&#x27;b&#x27;</span>], <span class="number">4</span>]</span><br></pre></td></tr></table></figure></div><div class="story post-story"><h2 id="构造函数与析构函数"><a href="#构造函数与析构函数" class="headerlink" title="构造函数与析构函数"></a>构造函数与析构函数</h2><ul><li>编译器在类声明中找不到任何构造函数时，会生成一个公有的默认构造函数</li><li>如果一个类已经显式地声明了任何构造函数，编译器不生成公有的默认构造函数</li></ul></div><div class="story post-story"><h2 id="拷贝构造函数"><a href="#拷贝构造函数" class="headerlink" title="拷贝构造函数"></a>拷贝构造函数</h2><h3 id="拷贝构造函数的原型"><a href="#拷贝构造函数的原型" class="headerlink" title="拷贝构造函数的原型"></a>拷贝构造函数的原型</h3><ul><li>必须是引用 Person(Person&amp;)或Person(const Person&amp;)</li><li>可以有多于一个的参数，但是第一个以后的参数必须都有默认值，例如Person(const Person&amp; p,bool married&#x3D;false);</li><li>若类的设计者不提供拷贝构造函数，编译器会自动生成一个。它将源对象所有数据成员的值逐一赋值给目标对象相应的数据成员。</li><li>如果一个类包含数组，就应该为这个类设计拷贝构造函数</li><li>通过将拷贝构造函数设计成私有成员的方式，来禁止对象间的拷贝操作。此时函数的按值传参和按值返回会发生错误</li></ul><h3 id="转型构造函数"><a href="#转型构造函数" class="headerlink" title="转型构造函数"></a>转型构造函数</h3><p>转型构造函数支持隐式类型转换，用关键字explicit可以关闭系统的隐式类型转换功能</p><h3 id="构造函数初始化程序"><a href="#构造函数初始化程序" class="headerlink" title="构造函数初始化程序"></a>构造函数初始化程序</h3><p>对const类型的数据成员进行初始化时必须为构造函数添加一个初始化列表</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">C</span>&#123;</span><br><span class="line">    <span class="keyword">public</span>:</span><br><span class="line">    <span class="built_in">C</span>():<span class="built_in">c</span>(<span class="number">0</span>)&#123;x=<span class="number">-1</span>;&#125;</span><br><span class="line">    <span class="keyword">private</span>:</span><br><span class="line">    <span class="type">int</span> x;</span><br><span class="line">    <span class="type">const</span> <span class="type">int</span> c;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div><div class="story post-story"><h2 id="析构函数"><a href="#析构函数" class="headerlink" title="析构函数"></a>析构函数</h2><p>析构函数也是成员函数，不带参数，不能被重载，每个类只有一个析构函数</p></div><div class="story post-story"><h2 id="类数据成员和类成员函数"><a href="#类数据成员和类成员函数" class="headerlink" title="类数据成员和类成员函数"></a>类数据成员和类成员函数</h2><h3 id="类数据成员"><a href="#类数据成员" class="headerlink" title="类数据成员"></a>类数据成员</h3><ol><li>为同一个类的私有对象共享</li><li>类内声明，类外定义</li></ol><h3 id="类成员函数"><a href="#类成员函数" class="headerlink" title="类成员函数"></a>类成员函数</h3><ol><li>不能访问非静态成员，只能访问static成员</li><li>在成员函数内定义静态变量，则所有对象在调用这个成员函数时将共享这个变量</li></ol><h1 id="继承-1"><a href="#继承-1" class="headerlink" title="继承"></a>继承</h1><p>语法：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">class 派生类名: [继承方式] 基类名</span><br><span class="line">&#123;</span><br><span class="line">派生类新增加的成员</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><p>继承方式可以是public,private,protected,默认为private</p><ul><li>基类的所有私有成员仅在基类中可见，而在派生类中不可见</li><li>using声明可以改变成员在派生类中的访问限制</li><li>派生类添加了一个数据成员或函数与基类中的数据成员或函数同名，则原来的数据成员或者函数被隐藏</li></ul><h3 id="python中的继承"><a href="#python中的继承" class="headerlink" title="python中的继承"></a>python中的继承</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">USTCFilter</span>(<span class="title class_ inherited__">Filter</span>):</span><br></pre></td></tr></table></figure><ul><li>issubclass 判断是否是子类</li><li>属性<code>__bases__</code>获取基类</li><li>isinstance 确定是否是实例</li></ul><p>初始化顺序：基类的构造函数，数据成员是类对象的构造函数，派生类的构造函数</p><ul><li>如果基类拥有构造函数但没有默认构造函数，那么派生类的构造函数必须显示调用基类的某个构造函数</li><li>若基类没有构造函数，则自动执行基类的默认构造函数</li><li>若基类拥有构造函数，当派生类任何构造函数都没有显示调用基类的某个构造函数时，基类的默认构造函数被调用</li></ul><h3 id="python中的构造函数和析构函数"><a href="#python中的构造函数和析构函数" class="headerlink" title="python中的构造函数和析构函数"></a>python中的构造函数和析构函数</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">父类名称.__init__(self,参数)或super(子类,self).__init__(参数)</span><br><span class="line">父类名称.__del__(self)或super(子类,self).__del__()</span><br></pre></td></tr></table></figure><h3 id="多继承"><a href="#多继承" class="headerlink" title="多继承"></a>多继承</h3><p>基类构造函数的执行顺序按它们在被继承时所声明的顺序依次调用，与它们在初始化列表中的顺序无关</p><p>避免二义性：对象.基类名::成员    派生类中定义的成员名对基类同名成员具有支配地位</p><p>在python中，若同名，按类定义时父类次序起作用</p><h3 id="虚基类"><a href="#虚基类" class="headerlink" title="虚基类"></a>虚基类</h3><p>虚基类构造函数的执行先于非虚基类构造函数</p><p>创建对象时，只有最派生类对虚基类构造函数的调用执行，其他基类的虚基类构造函数调用被忽略</p><p>带有虚基类的多层派生类构造函数的成员初始化列表中都要列出对虚基类构造函数的调用</p><h1 id="多态-1"><a href="#多态-1" class="headerlink" title="多态"></a>多态</h1><ul><li>如果基类有一个指向动态分配内存的数据成员，并定义了负责释放这块内存的析构函数，就应该将这个析构函数声明为虚成员函数</li><li>只有非静态成员函数，才能是虚成员函数</li><li>基类和派生类基虚函数同名会产生遮蔽，若同名虚函数的函数签名不同，可能报错</li><li>重载（静态多态）：同一命名空间中，函数名相同，但是参数个数或者类型不同</li><li>虚函数的覆盖（动态多态）：函数名相同，函数签名相同，运行时绑定</li></ul></div>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;面向对象编程&quot;&gt;&lt;a href=&quot;#面向对象编程&quot; class=&quot;headerlink&quot; title=&quot;面向对象编程&quot;&gt;&lt;/a&gt;面向对象编程&lt;/h1&gt;&lt;div class=&quot;story post-story&quot;&gt;&lt;h2 id=&quot;封装&quot;&gt;&lt;a href=&quot;#封装&quot; c</summary>
      
    
    
    
    
    <category term="cpp" scheme="http://example.com/tags/cpp/"/>
    
  </entry>
  
  <entry>
    <title>uni-app</title>
    <link href="http://example.com/2024/10/24/uni-app/"/>
    <id>http://example.com/2024/10/24/uni-app/</id>
    <published>2024-10-24T03:02:00.000Z</published>
    <updated>2024-12-07T13:29:52.495Z</updated>
    
    <content type="html"><![CDATA[<h1 id="uniapp小兔鲜项目"><a href="#uniapp小兔鲜项目" class="headerlink" title="uniapp小兔鲜项目"></a>uniapp小兔鲜项目</h1><div class="story post-story"><h2 id="技术栈"><a href="#技术栈" class="headerlink" title="技术栈"></a>技术栈</h2><p>vue+pinia+TypeScript+ESLint+Prettier+git</p></div><div class="story post-story"><h2 id="配置"><a href="#配置" class="headerlink" title="配置"></a>配置</h2><ul><li><p>pages：业务页面存放的目录</p><ul><li>index<ul><li>index.vue：index页面</li></ul></li></ul></li><li><p>static：存放应用引用的本地静态资源的目录</p></li><li><p>unpackage：非工程代码，一般存放运行或发行的编译结果</p></li><li><p>index.html：H5端页面</p></li><li><p>main.js：Vue初始化入口文件</p></li><li><p>App.vue：配置App全局样式、监听应用生命周期</p></li><li><p>pages.json：配置页面路由、导航栏、tabBar等页面类信息</p></li><li><p>manifest.json：配置appid、应用名称、logo、版本等打包信息</p></li><li><p>uni.scss：uni-app内置的常用样式变量</p></li></ul></div><div class="story post-story"><h2 id="pages-json"><a href="#pages-json" class="headerlink" title="pages.json"></a>pages.json</h2><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line"><span class="attr">&quot;pages&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span> <span class="comment">//页面路由及窗口表现</span></span><br><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line"><span class="attr">&quot;path&quot;</span><span class="punctuation">:</span> <span class="string">&quot;pages/index/index&quot;</span><span class="punctuation">,</span></span><br><span class="line"><span class="attr">&quot;style&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line"><span class="attr">&quot;navigationBarTitleText&quot;</span><span class="punctuation">:</span> <span class="string">&quot;首页&quot;</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br><span class="line"><span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line"><span class="attr">&quot;path&quot;</span> <span class="punctuation">:</span> <span class="string">&quot;pages/my/my&quot;</span><span class="punctuation">,</span></span><br><span class="line"><span class="attr">&quot;style&quot;</span> <span class="punctuation">:</span> </span><br><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line"><span class="attr">&quot;navigationBarTitleText&quot;</span> <span class="punctuation">:</span> <span class="string">&quot;我的&quot;</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br><span class="line"><span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line"><span class="attr">&quot;globalStyle&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span><span class="comment">//默认窗口表现</span></span><br><span class="line"><span class="attr">&quot;navigationBarTextStyle&quot;</span><span class="punctuation">:</span> <span class="string">&quot;white&quot;</span><span class="punctuation">,</span></span><br><span class="line"><span class="attr">&quot;navigationBarTitleText&quot;</span><span class="punctuation">:</span> <span class="string">&quot;uni-app&quot;</span><span class="punctuation">,</span></span><br><span class="line"><span class="attr">&quot;navigationBarBackgroundColor&quot;</span><span class="punctuation">:</span> <span class="string">&quot;#27BA9B&quot;</span><span class="punctuation">,</span></span><br><span class="line"><span class="attr">&quot;backgroundColor&quot;</span><span class="punctuation">:</span> <span class="string">&quot;#F8F8F8&quot;</span></span><br><span class="line"><span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line"><span class="attr">&quot;tabBar&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line"><span class="attr">&quot;selectedColor&quot;</span><span class="punctuation">:</span> <span class="string">&quot;#27BA9B&quot;</span><span class="punctuation">,</span></span><br><span class="line"><span class="attr">&quot;list&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line"><span class="attr">&quot;pagePath&quot;</span><span class="punctuation">:</span> <span class="string">&quot;pages/index/index&quot;</span><span class="punctuation">,</span></span><br><span class="line"><span class="attr">&quot;text&quot;</span><span class="punctuation">:</span> <span class="string">&quot;首页&quot;</span><span class="punctuation">,</span></span><br><span class="line"><span class="attr">&quot;iconPath&quot;</span><span class="punctuation">:</span> <span class="string">&quot;static/tabs/home_default.png&quot;</span><span class="punctuation">,</span></span><br><span class="line"><span class="attr">&quot;selectedIconPath&quot;</span><span class="punctuation">:</span> <span class="string">&quot;static/tabs/home_selected.png&quot;</span></span><br><span class="line"><span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line"><span class="attr">&quot;pagePath&quot;</span><span class="punctuation">:</span> <span class="string">&quot;pages/my/my&quot;</span><span class="punctuation">,</span></span><br><span class="line"><span class="attr">&quot;text&quot;</span><span class="punctuation">:</span> <span class="string">&quot;我的&quot;</span><span class="punctuation">,</span></span><br><span class="line"><span class="attr">&quot;iconPath&quot;</span><span class="punctuation">:</span> <span class="string">&quot;static/tabs/user_default.png&quot;</span><span class="punctuation">,</span></span><br><span class="line"><span class="attr">&quot;selectedIconPath&quot;</span><span class="punctuation">:</span> <span class="string">&quot;static/tabs/user_selected.png&quot;</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br><span class="line"><span class="punctuation">]</span></span><br><span class="line"><span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line"><span class="attr">&quot;uniIdRouter&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span><span class="punctuation">&#125;</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure></div><div class="story post-story"><h2 id="创建工程"><a href="#创建工程" class="headerlink" title="创建工程"></a>创建工程</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git <span class="built_in">clone</span> https://github.com/dcloudio/uni-preset-vue.git</span><br></pre></td></tr></table></figure></div><div class="story post-story"><h2 id="安装uni-app插件和ts类型校验"><a href="#安装uni-app插件和ts类型校验" class="headerlink" title="安装uni-app插件和ts类型校验"></a>安装uni-app插件和ts类型校验</h2><ul><li>uni-create-view</li><li>uni-helper</li><li>uniapp小程序扩展</li><li>Vue - Official</li><li><strong>工作区禁用</strong> @builtin typescript 插件（禁用后开启 Vue3 的 TS 托管模式）</li></ul><blockquote><p>pnpm i -D miniprogram-api-typings @uni-helper&#x2F;uni-app-types</p></blockquote><ul><li>配置tsconfig.json</li></ul><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">  <span class="attr">&quot;compilerOptions&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;sourceMap&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">true</span></span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;baseUrl&quot;</span><span class="punctuation">:</span> <span class="string">&quot;.&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;paths&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">      <span class="attr">&quot;@/*&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">        <span class="string">&quot;./src/*&quot;</span></span><br><span class="line">      <span class="punctuation">]</span></span><br><span class="line">    <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;lib&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">      <span class="string">&quot;esnext&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="string">&quot;dom&quot;</span></span><br><span class="line">    <span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">    <span class="comment">// 类型声明文件</span></span><br><span class="line">    <span class="attr">&quot;types&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">      <span class="string">&quot;@dcloudio/types&quot;</span><span class="punctuation">,</span> <span class="comment">// uni-app API 类型</span></span><br><span class="line">      <span class="string">&quot;miniprogram-api-typings&quot;</span><span class="punctuation">,</span> <span class="comment">// 原生微信小程序类型</span></span><br><span class="line">      <span class="string">&quot;@uni-helper/uni-app-types&quot;</span> <span class="comment">// uni-app 组件类型</span></span><br><span class="line">    <span class="punctuation">]</span></span><br><span class="line">  <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="comment">// vue 编译器类型，校验标签类型</span></span><br><span class="line">  <span class="attr">&quot;vueCompilerOptions&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;plugins&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">      <span class="string">&quot;@uni-helper/uni-app-types/volar-plugin&quot;</span></span><br><span class="line">    <span class="punctuation">]</span></span><br><span class="line">  <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;include&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">    <span class="string">&quot;src/**/*.ts&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="string">&quot;src/**/*.d.ts&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="string">&quot;src/**/*.tsx&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="string">&quot;src/**/*.vue&quot;</span></span><br><span class="line">  <span class="punctuation">]</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure></div><div class="story post-story"><h2 id="配置文件关联"><a href="#配置文件关联" class="headerlink" title="配置文件关联"></a>配置文件关联</h2><table><thead><tr><th>项</th><th>值</th></tr></thead><tbody><tr><td>manifest.json</td><td>jsonc</td></tr><tr><td>pages.json</td><td>jsonc</td></tr></tbody></table></div><div class="story post-story"><h2 id="引入-uni-ui-组件库"><a href="#引入-uni-ui-组件库" class="headerlink" title="引入 uni-ui 组件库"></a>引入 uni-ui 组件库</h2><h3 id="操作步骤"><a href="#操作步骤" class="headerlink" title="操作步骤"></a>操作步骤</h3><p>安装 <a href="https://uniapp.dcloud.net.cn/component/uniui/quickstart.html#npm%E5%AE%89%E8%A3%85">uni-ui 组件库</a></p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pnpm i @dcloudio/uni-ui</span><br></pre></td></tr></table></figure><p><strong>配置自动导入组件</strong></p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// pages.json</span></span><br><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">  <span class="comment">// 组件自动导入</span></span><br><span class="line">  <span class="attr">&quot;easycom&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;autoscan&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">true</span></span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;custom&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">      <span class="comment">// uni-ui 规则如下配置  // [!code ++]</span></span><br><span class="line">      <span class="attr">&quot;^uni-(.*)&quot;</span><span class="punctuation">:</span> <span class="string">&quot;@dcloudio/uni-ui/lib/uni-$1/uni-$1.vue&quot;</span> <span class="comment">// [!code ++]</span></span><br><span class="line">    <span class="punctuation">&#125;</span></span><br><span class="line">  <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;pages&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">    <span class="comment">// …省略</span></span><br><span class="line">  <span class="punctuation">]</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure><p><strong>安装类型声明文件</strong></p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pnpm i -D @uni-helper/uni-ui-types</span><br></pre></td></tr></table></figure><p><strong>配置类型声明文件</strong></p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// tsconfig.json</span></span><br><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">  <span class="attr">&quot;compilerOptions&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">    <span class="comment">// ...</span></span><br><span class="line">    <span class="attr">&quot;types&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">      <span class="string">&quot;@dcloudio/types&quot;</span><span class="punctuation">,</span> <span class="comment">// uni-app API 类型</span></span><br><span class="line">      <span class="string">&quot;miniprogram-api-typings&quot;</span><span class="punctuation">,</span> <span class="comment">// 原生微信小程序类型</span></span><br><span class="line">      <span class="string">&quot;@uni-helper/uni-app-types&quot;</span><span class="punctuation">,</span> <span class="comment">// uni-app 组件类型</span></span><br><span class="line">      <span class="string">&quot;@uni-helper/uni-ui-types&quot;</span> <span class="comment">// uni-ui 组件类型  // [!code ++]</span></span><br><span class="line">    <span class="punctuation">]</span></span><br><span class="line">  <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="comment">// vue 编译器类型，校验标签类型</span></span><br><span class="line">  <span class="attr">&quot;vueCompilerOptions&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;plugins&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">      <span class="string">&quot;@uni-helper/uni-app-types/volar-plugin&quot;</span></span><br><span class="line">    <span class="punctuation">]</span></span><br><span class="line">  <span class="punctuation">&#125;</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure></div><div class="story post-story"><h2 id="小程序端-Pinia-持久化"><a href="#小程序端-Pinia-持久化" class="headerlink" title="小程序端 Pinia 持久化"></a>小程序端 Pinia 持久化</h2><p>说明：<code>Pinia</code> 用法与 <code>Vue3</code> 项目完全一致，<code>uni-app</code> 项目仅需解决<strong>持久化插件兼容性</strong>问题。</p><h3 id="持久化存储插件"><a href="#持久化存储插件" class="headerlink" title="持久化存储插件"></a>持久化存储插件</h3><p>安装持久化存储插件： <a href="https://prazdevs.github.io/pinia-plugin-persistedstate/zh/guide/config.html#storage">pinia-plugin-persistedstate</a></p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pnpm i pinia-plugin-persistedstate</span><br></pre></td></tr></table></figure><p>插件默认使用 <code>localStorage</code> 实现持久化，小程序端不兼容，需要替换持久化 API。</p><h3 id="基本用法"><a href="#基本用法" class="headerlink" title="基本用法"></a>基本用法</h3><figure class="highlight ts"><figcaption><span>&#123;28-31&#125; [stores/modules/member.ts]</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; defineStore &#125; <span class="keyword">from</span> <span class="string">&#x27;pinia&#x27;</span></span><br><span class="line"><span class="keyword">import</span> &#123; ref &#125; <span class="keyword">from</span> <span class="string">&#x27;vue&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 定义 Store</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> useMemberStore = <span class="title function_">defineStore</span>(</span><br><span class="line">  <span class="string">&#x27;member&#x27;</span>,</span><br><span class="line">  <span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="comment">// 会员信息</span></span><br><span class="line">    <span class="keyword">const</span> profile = ref&lt;<span class="built_in">any</span>&gt;()</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 保存会员信息，登录时使用</span></span><br><span class="line">    <span class="keyword">const</span> <span class="title function_">setProfile</span> = (<span class="params"><span class="attr">val</span>: <span class="built_in">any</span></span>) =&gt; &#123;</span><br><span class="line">      profile.<span class="property">value</span> = val</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 清理会员信息，退出时使用</span></span><br><span class="line">    <span class="keyword">const</span> <span class="title function_">clearProfile</span> = (<span class="params"></span>) =&gt; &#123;</span><br><span class="line">      profile.<span class="property">value</span> = <span class="literal">undefined</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 记得 return</span></span><br><span class="line">    <span class="keyword">return</span> &#123;</span><br><span class="line">      profile,</span><br><span class="line">      setProfile,</span><br><span class="line">      clearProfile,</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="comment">// <span class="doctag">TODO:</span> 持久化</span></span><br><span class="line">  &#123;</span><br><span class="line">    <span class="attr">persist</span>: <span class="literal">true</span>,</span><br><span class="line">  &#125;,</span><br><span class="line">)</span><br></pre></td></tr></table></figure><figure class="highlight ts"><figcaption><span>&#123;2,7&#125; [stores/index.ts]</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; createPinia &#125; <span class="keyword">from</span> <span class="string">&#x27;pinia&#x27;</span></span><br><span class="line"><span class="keyword">import</span> persist <span class="keyword">from</span> <span class="string">&#x27;pinia-plugin-persistedstate&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 创建 pinia 实例</span></span><br><span class="line"><span class="keyword">const</span> pinia = <span class="title function_">createPinia</span>()</span><br><span class="line"><span class="comment">// 使用持久化存储插件</span></span><br><span class="line">pinia.<span class="title function_">use</span>(persist)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 默认导出，给 main.ts 使用</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> pinia</span><br><span class="line"></span><br><span class="line"><span class="comment">// 模块统一导出</span></span><br><span class="line"><span class="keyword">export</span> * <span class="keyword">from</span> <span class="string">&#x27;./modules/member&#x27;</span></span><br></pre></td></tr></table></figure><figure class="highlight ts"><figcaption><span>&#123;2,8&#125; [main.ts]</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; createSSRApp &#125; <span class="keyword">from</span> <span class="string">&#x27;vue&#x27;</span></span><br><span class="line"><span class="keyword">import</span> pinia <span class="keyword">from</span> <span class="string">&#x27;./stores&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">App</span> <span class="keyword">from</span> <span class="string">&#x27;./App.vue&#x27;</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">function</span> <span class="title function_">createApp</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">const</span> app = <span class="title function_">createSSRApp</span>(<span class="title class_">App</span>)</span><br><span class="line"></span><br><span class="line">  app.<span class="title function_">use</span>(pinia)</span><br><span class="line">  <span class="keyword">return</span> &#123;</span><br><span class="line">    app,</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="多端兼容"><a href="#多端兼容" class="headerlink" title="多端兼容"></a>多端兼容</h3><p><strong>网页端持久化 API</strong></p><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 网页端API</span></span><br><span class="line"><span class="variable language_">localStorage</span>.<span class="title function_">setItem</span>()</span><br><span class="line"><span class="variable language_">localStorage</span>.<span class="title function_">getItem</span>()</span><br></pre></td></tr></table></figure><p><strong>多端持久化 API</strong></p><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 兼容多端API</span></span><br><span class="line">uni.<span class="title function_">setStorageSync</span>()</span><br><span class="line">uni.<span class="title function_">getStorageSync</span>()</span><br></pre></td></tr></table></figure><p><strong>参考代码</strong></p><figure class="highlight ts"><figcaption><span>&#123;7-20&#125;</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// stores/modules/member.ts</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> useMemberStore = <span class="title function_">defineStore</span>(</span><br><span class="line">  <span class="string">&#x27;member&#x27;</span>,</span><br><span class="line">  <span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="comment">//…省略</span></span><br><span class="line">  &#125;,</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="comment">// 配置持久化</span></span><br><span class="line">    <span class="attr">persist</span>: &#123;</span><br><span class="line">      <span class="comment">// 调整为兼容多端的API</span></span><br><span class="line">      <span class="attr">storage</span>: &#123;</span><br><span class="line">        <span class="title function_">setItem</span>(<span class="params">key, value</span>) &#123;</span><br><span class="line">          uni.<span class="title function_">setStorageSync</span>(key, value) <span class="comment">// [!code warning]</span></span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="title function_">getItem</span>(<span class="params">key</span>) &#123;</span><br><span class="line">          <span class="keyword">return</span> uni.<span class="title function_">getStorageSync</span>(key) <span class="comment">// [!code warning]</span></span><br><span class="line">        &#125;,</span><br><span class="line">      &#125;,</span><br><span class="line">    &#125;,</span><br><span class="line">  &#125;,</span><br><span class="line">)</span><br></pre></td></tr></table></figure></div><div class="story post-story"><h2 id="uni-request-请求封装"><a href="#uni-request-请求封装" class="headerlink" title="uni.request 请求封装"></a>uni.request 请求封装</h2><h3 id="请求和上传文件拦截器"><a href="#请求和上传文件拦截器" class="headerlink" title="请求和上传文件拦截器"></a>请求和上传文件拦截器</h3><p><strong>uniapp 拦截器</strong>： <a href="https://uniapp.dcloud.net.cn/api/interceptor.html">uni.addInterceptor</a></p><p><strong>接口说明</strong>：<a href="https://www.apifox.cn/apidoc/shared-0e6ee326-d646-41bd-9214-29dbf47648fa/doc-1521513">接口文档</a></p><p>::: tip 实现需求</p><ol><li>拼接基础地址</li><li>设置超时时间</li><li>添加请求头标识</li><li>添加 token<br>:::</li></ol><p><strong>参考代码</strong></p><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// src/utils/http.ts</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 请求基地址</span></span><br><span class="line"><span class="keyword">const</span> baseURL = <span class="string">&#x27;https://pcapi-xiaotuxian-front-devtest.itheima.net&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 拦截器配置</span></span><br><span class="line"><span class="keyword">const</span> httpInterceptor = &#123;</span><br><span class="line">  <span class="comment">// 拦截前触发</span></span><br><span class="line">  <span class="title function_">invoke</span>(<span class="params"><span class="attr">options</span>: <span class="title class_">UniApp</span>.<span class="title class_">RequestOptions</span></span>) &#123;</span><br><span class="line">    <span class="comment">// 1. 非 http 开头需拼接地址</span></span><br><span class="line">    <span class="keyword">if</span> (!options.<span class="property">url</span>.<span class="title function_">startsWith</span>(<span class="string">&#x27;http&#x27;</span>)) &#123;</span><br><span class="line">      options.<span class="property">url</span> = baseURL + options.<span class="property">url</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// 2. 请求超时</span></span><br><span class="line">    options.<span class="property">timeout</span> = <span class="number">10000</span></span><br><span class="line">    <span class="comment">// 3. 添加小程序端请求头标识</span></span><br><span class="line">    options.<span class="property">header</span> = &#123;</span><br><span class="line">      <span class="string">&#x27;source-client&#x27;</span>: <span class="string">&#x27;miniapp&#x27;</span>,</span><br><span class="line">      ...options.<span class="property">header</span>,</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// 4. 添加 token 请求头标识</span></span><br><span class="line">    <span class="keyword">const</span> memberStore = <span class="title function_">useMemberStore</span>()</span><br><span class="line">    <span class="keyword">const</span> token = memberStore.<span class="property">profile</span>?.<span class="property">token</span></span><br><span class="line">    <span class="keyword">if</span> (token) &#123;</span><br><span class="line">      options.<span class="property">header</span>.<span class="property">Authorization</span> = token</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 拦截 request 请求</span></span><br><span class="line">uni.<span class="title function_">addInterceptor</span>(<span class="string">&#x27;request&#x27;</span>, httpInterceptor)</span><br><span class="line"><span class="comment">// 拦截 uploadFile 文件上传</span></span><br><span class="line">uni.<span class="title function_">addInterceptor</span>(<span class="string">&#x27;uploadFile&#x27;</span>, httpInterceptor)</span><br></pre></td></tr></table></figure><p><strong>warning 注意事项</strong></p><p>微信小程序端，需登录 <a href="https://mp.weixin.qq.com/">微信公众平台</a> 配置合法域名 👇</p><p><code>https://pcapi-xiaotuxian-front-devtest.itheima.net</code></p><h3 id="封装-Promise-请求函数"><a href="#封装-Promise-请求函数" class="headerlink" title="封装 Promise 请求函数"></a>封装 Promise 请求函数</h3><ol><li>返回 Promise 对象，用于处理返回值类型</li><li>成功 resolve<ol><li>提取数据</li><li>添加泛型</li></ol></li><li>失败 reject<ol><li>401 错误</li><li>其他错误</li><li>网络错误</li></ol></li></ol><p><strong>参考代码</strong></p><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 请求函数</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span>  UniApp.RequestOptions</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@returns</span> <span class="variable">Promise</span></span></span><br><span class="line"><span class="comment"> *  1. 返回 Promise 对象，用于处理返回值类型</span></span><br><span class="line"><span class="comment"> *  2. 获取数据成功</span></span><br><span class="line"><span class="comment"> *    2.1 提取核心数据 res.data</span></span><br><span class="line"><span class="comment"> *    2.2 添加类型，支持泛型</span></span><br><span class="line"><span class="comment"> *  3. 获取数据失败</span></span><br><span class="line"><span class="comment"> *    3.1 401错误  -&gt; 清理用户信息，跳转到登录页</span></span><br><span class="line"><span class="comment"> *    3.2 其他错误 -&gt; 根据后端错误信息轻提示</span></span><br><span class="line"><span class="comment"> *    3.3 网络错误 -&gt; 提示用户换网络</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">type</span> <span class="title class_">Data</span>&lt;T&gt; = &#123;</span><br><span class="line">  <span class="attr">code</span>: <span class="built_in">string</span></span><br><span class="line">  <span class="attr">msg</span>: <span class="built_in">string</span></span><br><span class="line">  <span class="attr">result</span>: T</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 2.2 添加类型，支持泛型</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> http = &lt;T&gt;<span class="function">(<span class="params"><span class="attr">options</span>: <span class="title class_">UniApp</span>.<span class="title class_">RequestOptions</span></span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="comment">// 1. 返回 Promise 对象</span></span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Promise</span>&lt;<span class="title class_">Data</span>&lt;T&gt;&gt;(<span class="function">(<span class="params">resolve, reject</span>) =&gt;</span> &#123;</span><br><span class="line">    uni.<span class="title function_">request</span>(&#123;</span><br><span class="line">      ...options,</span><br><span class="line">      <span class="comment">// 响应成功</span></span><br><span class="line">      <span class="title function_">success</span>(<span class="params">res</span>) &#123;</span><br><span class="line">        <span class="comment">// 状态码 2xx，参考 axios 的设计</span></span><br><span class="line">        <span class="keyword">if</span> (res.<span class="property">statusCode</span> &gt;= <span class="number">200</span> &amp;&amp; res.<span class="property">statusCode</span> &lt; <span class="number">300</span>) &#123;</span><br><span class="line">          <span class="comment">// 2.1 提取核心数据 res.data</span></span><br><span class="line">          <span class="title function_">resolve</span>(res.<span class="property">data</span> <span class="keyword">as</span> <span class="title class_">Data</span>&lt;T&gt;)</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (res.<span class="property">statusCode</span> === <span class="number">401</span>) &#123;</span><br><span class="line">          <span class="comment">// 401错误  -&gt; 清理用户信息，跳转到登录页</span></span><br><span class="line">          <span class="keyword">const</span> memberStore = <span class="title function_">useMemberStore</span>()</span><br><span class="line">          memberStore.<span class="title function_">clearProfile</span>()</span><br><span class="line">          uni.<span class="title function_">navigateTo</span>(&#123; <span class="attr">url</span>: <span class="string">&#x27;/pages/login/login&#x27;</span> &#125;)</span><br><span class="line">          <span class="title function_">reject</span>(res)</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">          <span class="comment">// 其他错误 -&gt; 根据后端错误信息轻提示</span></span><br><span class="line">          uni.<span class="title function_">showToast</span>(&#123;</span><br><span class="line">            <span class="attr">icon</span>: <span class="string">&#x27;none&#x27;</span>,</span><br><span class="line">            <span class="attr">title</span>: (res.<span class="property">data</span> <span class="keyword">as</span> <span class="title class_">Data</span>&lt;T&gt;).<span class="property">msg</span> || <span class="string">&#x27;请求错误&#x27;</span>,</span><br><span class="line">          &#125;)</span><br><span class="line">          <span class="title function_">reject</span>(res)</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;,</span><br><span class="line">      <span class="comment">// 响应失败</span></span><br><span class="line">      <span class="title function_">fail</span>(<span class="params">err</span>) &#123;</span><br><span class="line">        uni.<span class="title function_">showToast</span>(&#123;</span><br><span class="line">          <span class="attr">icon</span>: <span class="string">&#x27;none&#x27;</span>,</span><br><span class="line">          <span class="attr">title</span>: <span class="string">&#x27;网络错误，换个网络试试&#x27;</span>,</span><br><span class="line">        &#125;)</span><br><span class="line">        <span class="title function_">reject</span>(err)</span><br><span class="line">      &#125;,</span><br><span class="line">    &#125;)</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div><div class="story post-story"><h2 id="代码规范"><a href="#代码规范" class="headerlink" title="代码规范"></a>代码规范</h2><p>如果没有统一代码风格，团队协作不便于查看代码提交时所做的修改。</p><h3 id="统一代码风格"><a href="#统一代码风格" class="headerlink" title="统一代码风格"></a>统一代码风格</h3><ul><li>安装 <code>eslint</code> + <code>prettier</code></li></ul><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pnpm i -D eslint prettier eslint-plugin-vue @vue/eslint-config-prettier @vue/eslint-config-typescript @rushstack/eslint-patch @vue/tsconfig</span><br></pre></td></tr></table></figure><ul><li>xxxxxxxxxx import create from ‘zustand’​&#x2F;&#x2F; 导入核心方法import { mountStoreDevtool } from ‘simple-zustand-devtools’​&#x2F;&#x2F; 省略部分代码…​​&#x2F;&#x2F; 开发环境开启调试if (process.env.NODE_ENV &#x3D;&#x3D;&#x3D; ‘development’) {  mountStoreDevtool(‘channelStore’, useChannelStore)}​​export default useChannelStorejavascript</li></ul><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* eslint-env node */</span></span><br><span class="line"><span class="built_in">require</span>(<span class="string">&#x27;@rushstack/eslint-patch/modern-module-resolution&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="variable language_">module</span>.<span class="property">exports</span> = &#123;</span><br><span class="line">  <span class="attr">root</span>: <span class="literal">true</span>,</span><br><span class="line">  <span class="attr">extends</span>: [</span><br><span class="line">    <span class="string">&#x27;plugin:vue/vue3-essential&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;eslint:recommended&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;@vue/eslint-config-typescript&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;@vue/eslint-config-prettier&#x27;</span>,</span><br><span class="line">  ],</span><br><span class="line">  <span class="comment">// 小程序全局变量</span></span><br><span class="line">  <span class="attr">globals</span>: &#123;</span><br><span class="line">    <span class="attr">uni</span>: <span class="literal">true</span>,</span><br><span class="line">    <span class="attr">wx</span>: <span class="literal">true</span>,</span><br><span class="line">    <span class="title class_">WechatMiniprogram</span>: <span class="literal">true</span>,</span><br><span class="line">    <span class="attr">getCurrentPages</span>: <span class="literal">true</span>,</span><br><span class="line">    <span class="attr">getApp</span>: <span class="literal">true</span>,</span><br><span class="line">    <span class="title class_">UniApp</span>: <span class="literal">true</span>,</span><br><span class="line">    <span class="title class_">UniHelper</span>: <span class="literal">true</span>,</span><br><span class="line">    <span class="title class_">App</span>: <span class="literal">true</span>,</span><br><span class="line">    <span class="title class_">Page</span>: <span class="literal">true</span>,</span><br><span class="line">    <span class="title class_">Component</span>: <span class="literal">true</span>,</span><br><span class="line">    <span class="title class_">AnyObject</span>: <span class="literal">true</span>,</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">parserOptions</span>: &#123;</span><br><span class="line">    <span class="attr">ecmaVersion</span>: <span class="string">&#x27;latest&#x27;</span>,</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">rules</span>: &#123;</span><br><span class="line">    <span class="string">&#x27;prettier/prettier&#x27;</span>: [</span><br><span class="line">      <span class="string">&#x27;warn&#x27;</span>,</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="attr">singleQuote</span>: <span class="literal">true</span>,</span><br><span class="line">        <span class="attr">semi</span>: <span class="literal">false</span>,</span><br><span class="line">        <span class="attr">printWidth</span>: <span class="number">100</span>,</span><br><span class="line">        <span class="attr">trailingComma</span>: <span class="string">&#x27;all&#x27;</span>,</span><br><span class="line">        <span class="attr">endOfLine</span>: <span class="string">&#x27;auto&#x27;</span>,</span><br><span class="line">      &#125;,</span><br><span class="line">    ],</span><br><span class="line">    <span class="string">&#x27;vue/multi-word-component-names&#x27;</span>: [<span class="string">&#x27;off&#x27;</span>],</span><br><span class="line">    <span class="string">&#x27;vue/no-setup-props-destructure&#x27;</span>: [<span class="string">&#x27;off&#x27;</span>],</span><br><span class="line">    <span class="string">&#x27;vue/no-deprecated-html-element-is&#x27;</span>: [<span class="string">&#x27;off&#x27;</span>],</span><br><span class="line">    <span class="string">&#x27;@typescript-eslint/no-unused-vars&#x27;</span>: [<span class="string">&#x27;off&#x27;</span>],</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>配置 <code>package.json</code></li></ul><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">  <span class="attr">&quot;script&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">    <span class="comment">// ... 省略 ...</span></span><br><span class="line">    <span class="attr">&quot;lint&quot;</span><span class="punctuation">:</span> <span class="string">&quot;eslint . --ext .vue,.js,.ts --fix --ignore-path .gitignore&quot;</span></span><br><span class="line">  <span class="punctuation">&#125;</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure><ul><li>运行</li></ul><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pnpm lint</span><br></pre></td></tr></table></figure><h3 id="Git-工作流规范"><a href="#Git-工作流规范" class="headerlink" title="Git 工作流规范"></a>Git 工作流规范</h3><ul><li>安装并初始化 <code>husky</code></li></ul><figure class="highlight sh"><figcaption><span>[pnpx]</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pnpm dlx husky-init</span><br></pre></td></tr></table></figure><figure class="highlight sh"><figcaption><span>[npx]</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npx husky-init</span><br></pre></td></tr></table></figure><ul><li>安装 <code>lint-staged</code></li></ul><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pnpm i -D lint-staged</span><br></pre></td></tr></table></figure><ul><li>配置 <code>package.json</code></li></ul><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">  <span class="attr">&quot;script&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">    <span class="comment">// ... 省略 ...</span></span><br><span class="line">  <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;lint-staged&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;*.&#123;vue,ts,js&#125;&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span><span class="string">&quot;eslint --fix&quot;</span><span class="punctuation">]</span></span><br><span class="line">  <span class="punctuation">&#125;</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure><ul><li>修改 <code>.husky/pre-commit</code> 文件</li></ul><figure class="highlight diff"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">npm test   // [!code --]</span><br><span class="line">npm run lint-staged     // [!code ++]</span><br></pre></td></tr></table></figure></div><div class="story post-story"><h2 id="自定义导航配置"><a href="#自定义导航配置" class="headerlink" title="自定义导航配置"></a>自定义导航配置</h2><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// src/pages.json</span></span><br><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">  <span class="attr">&quot;path&quot;</span><span class="punctuation">:</span> <span class="string">&quot;pages/index/index&quot;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;style&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;navigationStyle&quot;</span><span class="punctuation">:</span> <span class="string">&quot;custom&quot;</span><span class="punctuation">,</span> <span class="comment">// 隐藏默认导航</span></span><br><span class="line">    <span class="attr">&quot;navigationBarTextStyle&quot;</span><span class="punctuation">:</span> <span class="string">&quot;white&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;navigationBarTitleText&quot;</span><span class="punctuation">:</span> <span class="string">&quot;首页&quot;</span></span><br><span class="line">  <span class="punctuation">&#125;</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure><h3 id="组件安全区适配"><a href="#组件安全区适配" class="headerlink" title="组件安全区适配"></a>组件安全区适配</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">&lt;!-- src/pages/index/componets/CustomNavbar.vue --&gt;</span><br><span class="line">&lt;script&gt;</span><br><span class="line">// 获取屏幕边界到安全区域距离</span><br><span class="line">const &#123; safeAreaInsets &#125; = uni.getSystemInfoSync()</span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;!-- 顶部占位 --&gt;</span><br><span class="line">  &lt;view class=&quot;navbar&quot; :style=&quot;&#123; paddingTop: safeAreaInsets?.top + &#x27;px&#x27; &#125;&quot;&gt;</span><br><span class="line">    &lt;!-- ...省略 --&gt;</span><br><span class="line">  &lt;/view&gt;</span><br><span class="line">&lt;/template&gt;</span><br></pre></td></tr></table></figure></div>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;uniapp小兔鲜项目&quot;&gt;&lt;a href=&quot;#uniapp小兔鲜项目&quot; class=&quot;headerlink&quot; title=&quot;uniapp小兔鲜项目&quot;&gt;&lt;/a&gt;uniapp小兔鲜项目&lt;/h1&gt;&lt;div class=&quot;story post-story&quot;&gt;&lt;h2 id=</summary>
      
    
    
    
    <category term="项目" scheme="http://example.com/categories/%E9%A1%B9%E7%9B%AE/"/>
    
    
    <category term="vue" scheme="http://example.com/tags/vue/"/>
    
  </entry>
  
  <entry>
    <title>分布式实验1_Hadoop环境安装</title>
    <link href="http://example.com/2024/10/23/%E5%88%86%E5%B8%83%E5%BC%8F%E5%AE%9E%E9%AA%8C1_Hadoop%E7%8E%AF%E5%A2%83%E5%AE%89%E8%A3%85/"/>
    <id>http://example.com/2024/10/23/%E5%88%86%E5%B8%83%E5%BC%8F%E5%AE%9E%E9%AA%8C1_Hadoop%E7%8E%AF%E5%A2%83%E5%AE%89%E8%A3%85/</id>
    <published>2024-10-23T02:37:57.000Z</published>
    <updated>2024-10-30T16:39:43.066Z</updated>
    
    <content type="html"><![CDATA[<h1 id="实验1-Hadoop环境安装"><a href="#实验1-Hadoop环境安装" class="headerlink" title="实验1  Hadoop环境安装"></a>实验1  Hadoop环境安装</h1><div class="story post-story"><h2 id="模板虚拟机环境准备"><a href="#模板虚拟机环境准备" class="headerlink" title="模板虚拟机环境准备"></a>模板虚拟机环境准备</h2><ol><li><p>安装模板虚拟机，IP 地址 192.168.10.100、主机名称 hadoop100、内存 4G、硬盘 50G</p></li><li><p>hadoop100 虚拟机配置要求如下（本文 Linux 系统全部以 CentOS-7.5-x86-1804 为例）</p><ol><li><p>使用 yum 安装需要虚拟机可以正常上网，yum 安装前可以先测试下虚拟机联网情况</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">[root@hadoop100 ~]# ping baidu.com</span><br><span class="line">PING baidu.com (110.242.68.66) 56(84) bytes of data.</span><br><span class="line">64 bytes from 110.242.68.66 (110.242.68.66): icmp_seq=1 ttl=128 time=58.6 ms</span><br><span class="line">64 bytes from 110.242.68.66 (110.242.68.66): icmp_seq=2 ttl=128 time=40.1 ms</span><br></pre></td></tr></table></figure></li><li><p>安装 epel-release</p><p>注：Extra Packages for Enterprise Linux 是为“红帽系”的操作系统提供额外的软件包，适用于 RHEL、CentOS 和 Scientific Linux。相当于是一个软件仓库，大多数 rpm 包在官方repository 中是找不到的）</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yum install -y epel-release</span><br></pre></td></tr></table></figure><p>这条指令报域名解析错误如下</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">已加载插件：fastestmirror, langpacks</span><br><span class="line">Loading mirror speeds from cached hostfile</span><br><span class="line">Could not retrieve mirrorlist http://mirrorlist.centos.org/?release=7&amp;arch=x86_64&amp;repo=os&amp;infra=stock error was</span><br><span class="line">14: curl#6 - &quot;Could not resolve host: mirrorlist.centos.org; 未知的错误&quot;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>解决方法如下，将yum源换成阿里云镜像源</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">sudo mv /etc/yum.repos.d/CentOS-Base.repo /etc/yum.repos.d/CentOS-Base.repo.bak</span><br><span class="line">sudo wget -O /etc/yum.repos.d/CentOS-Base.repo http://mirrors.aliyun.com/repo/Centos-7.repo</span><br><span class="line">sudo yum clean all</span><br><span class="line">sudo yum makecache</span><br><span class="line">sudo yum repolist</span><br></pre></td></tr></table></figure></li><li><p>安装相关工具</p><ol><li><p>net-tool：工具包集合，包含 ifconfig 等命令</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yum install -y net-tools</span><br></pre></td></tr></table></figure></li><li><p>vim：编辑器</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yum install -y vim</span><br></pre></td></tr></table></figure></li></ol></li></ol></li><li><p>关闭防火墙，关闭防火墙开机自启</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">systemctl stop firewalld</span><br><span class="line">systemctl disable firewalld.service</span><br></pre></td></tr></table></figure></li><li><p>创建 atguigu 用户，并修改 atguigu 用户的密码</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vim /etc/sudoers</span><br></pre></td></tr></table></figure><p>修改&#x2F;etc&#x2F;sudoers 文件，在%wheel 这行下面添加一行，如下所示：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">atguigu ALL=(ALL) NOPASSWD:ALL</span><br></pre></td></tr></table></figure></li><li><p>配置 atguigu 用户具有 root 权限，方便后期加 sudo 执行 root 权限的命令</p></li><li><p>在&#x2F;opt 目录下创建文件夹，并修改所属主和所属组</p><ol><li><p>在&#x2F;opt 目录下创建 module、software 文件夹</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sudo mkdir /opt/module</span><br><span class="line">sudo mkdir /opt/software</span><br></pre></td></tr></table></figure></li><li><p>修改 module、software 文件夹的所有者和所属组均为 atguigu 用户</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sudo chown atguigu:atguigu /opt/module</span><br><span class="line">sudo chown atguigu:atguigu /opt/software</span><br></pre></td></tr></table></figure></li></ol></li><li><p>卸载虚拟机自带的 JDK</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">rpm -qa | grep -i java | xargs -n1 rpm -e --nodeps</span><br></pre></td></tr></table></figure></li><li><p>重启虚拟机</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">reboot</span><br></pre></td></tr></table></figure></li></ol></div><div class="story post-story"><h2 id="克隆虚拟机"><a href="#克隆虚拟机" class="headerlink" title="克隆虚拟机"></a>克隆虚拟机</h2><ol><li><p>利用模板机 hadoop100，克隆三台虚拟机：hadoop102 hadoop103 hadoop104</p></li><li><p>修改克隆机 IP，以下以 hadoop102 举例说明</p><ol><li><p>修改克隆虚拟机的静态 IP</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vim /etc/sysconfig/network-scripts/ifcfg-ens33</span><br></pre></td></tr></table></figure><p>改成</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">IPADDR=192.168.10.102</span><br></pre></td></tr></table></figure></li><li><p>查看 Linux 虚拟机的虚拟网络编辑器，编辑-&gt;虚拟网络编辑器-&gt;VMnet8</p></li><li><p>查看 Windows 系统适配器 VMware Network Adapter VMnet8 的 IP 地址</p></li><li><p>保证 Linux 系统 ifcfg-ens33 文件中 IP 地址、虚拟网络编辑器地址和 Windows 系统 VM8 网络 IP 地址相同</p></li></ol></li><li><p>修改克隆机主机名，以下以 hadoop102 举例说明</p><ol><li><p>修改主机名称</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vim /etc/hostname</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hadoop102</span><br></pre></td></tr></table></figure></li></ol></li><li><p>重启克隆机 hadoop102</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">reboot</span><br></pre></td></tr></table></figure></li><li><p>修改 windows 的主机映射文件（hosts 文件）</p></li></ol></div><div class="story post-story"><h2 id="在-hadoop102-安装-JDK"><a href="#在-hadoop102-安装-JDK" class="headerlink" title="在 hadoop102 安装 JDK"></a>在 hadoop102 安装 JDK</h2><ol><li><p>卸载现有 JDK</p></li><li><p>用 FinalShell 传输工具将 JDK 导入到 opt 目录下面的 software 文件夹下面</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">cd /opt/software/</span><br><span class="line">rz</span><br></pre></td></tr></table></figure></li><li><p>在 Linux 系统下的 opt 目录中查看软件包是否导入成功</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ll</span><br></pre></td></tr></table></figure></li><li><p>解压 JDK 到&#x2F;opt&#x2F;module 目录下</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">tar -zxvf jdk-8u212-linux-x64.tar.gz -C /opt/module/</span><br></pre></td></tr></table></figure></li><li><p>配置 JDK 环境变量</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo vim /etc/profile.d/my_env.sh</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">#JAVA_HOME</span><br><span class="line">export JAVA_HOME=/opt/module/jdk1.8.0_212</span><br><span class="line">export PATH=$PATH:$JAVA_HOME/bin</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">source /etc/profile</span><br></pre></td></tr></table></figure></li><li><p>测试 JDK 是否安装成功</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">java -version</span><br></pre></td></tr></table></figure></li></ol></div><div class="story post-story"><h2 id="在-hadoop102-安装-Hadoop"><a href="#在-hadoop102-安装-Hadoop" class="headerlink" title="在 hadoop102 安装 Hadoop"></a>在 hadoop102 安装 Hadoop</h2><ol><li><p>用 FinalShell 文件传输工具将 hadoop-3.1.3.tar.gz 导入到 opt 目录下面的 software 文件夹下面</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">cd /opt/software/</span><br><span class="line">rz</span><br></pre></td></tr></table></figure></li><li><p>解压安装文件到&#x2F;opt&#x2F;module 下面</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">tar -zxvf hadoop-3.1.3.tar.gz -C /opt/module/</span><br></pre></td></tr></table></figure></li><li><p>查看是否解压成功</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ls /opt/module/</span><br></pre></td></tr></table></figure></li><li><p>将 Hadoop 添加到环境变量</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo vim /etc/profile.d/my_env.sh</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">#HADOOP_HOME</span><br><span class="line">export HADOOP_HOME=/opt/module/hadoop-3.1.3</span><br><span class="line">export PATH=$PATH:$HADOOP_HOME/bin</span><br><span class="line">export PATH=$PATH:$HADOOP_HOME/sbin</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">source /etc/profile</span><br></pre></td></tr></table></figure></li><li><p>测试是否安装成功</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hadoop version</span><br></pre></td></tr></table></figure></li></ol><h3 id="hadoop重要目录"><a href="#hadoop重要目录" class="headerlink" title="hadoop重要目录"></a>hadoop重要目录</h3><p>（1）bin 目录：存放对 Hadoop 相关服务（hdfs，yarn，mapred）进行操作的脚本<br>（2）etc 目录：Hadoop 的配置文件目录，存放 Hadoop 的配置文件<br>（3）lib 目录：存放 Hadoop 的本地库（对数据进行压缩解压缩功能）<br>（4）sbin 目录：存放启动或停止 Hadoop 相关服务的脚本<br>（5）share 目录：存放 Hadoop 的依赖 jar 包、文档、和官方案例</p></div><div class="story post-story"><h2 id="完全分布式运行模式"><a href="#完全分布式运行模式" class="headerlink" title="完全分布式运行模式"></a>完全分布式运行模式</h2><h3 id="编写集群分发脚本-xsync"><a href="#编写集群分发脚本-xsync" class="headerlink" title="编写集群分发脚本 xsync"></a>编写集群分发脚本 xsync</h3><ol><li><p>scp（secure copy）安全拷贝</p><ol><li>hadoop102中操作</li></ol><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">scp -r /opt/module/jdk1.8.0_212 atguigu@hadoop103:/opt/module</span><br></pre></td></tr></table></figure><ol start="2"><li>hadoop103中操作</li></ol><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">scp -r atguigu@hadoop102:/opt/module/hadoop-3.1.3 /opt/module/</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">scp -r atguigu@hadoop102:/opt/module/* atguigu@hadoop104:/opt/module</span><br></pre></td></tr></table></figure></li><li><p>xsync 集群分发脚本</p><ol><li><p>在&#x2F;home&#x2F;atguigu&#x2F;bin 目录下创建 xsync 文件</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">cd /home/atguigu</span><br><span class="line">mkdir bin</span><br><span class="line">cd bin</span><br><span class="line">vim xsync</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">#!/bin/bash</span><br><span class="line">#1. 判断参数个数</span><br><span class="line">if [ $# -lt 1 ]</span><br><span class="line">then</span><br><span class="line"> echo Not Enough Arguement!</span><br><span class="line"> exit;</span><br><span class="line">fi</span><br><span class="line">#2. 遍历集群所有机器</span><br><span class="line">for host in hadoop102 hadoop103 hadoop104</span><br><span class="line">do</span><br><span class="line"> echo ==================== $host ====================</span><br><span class="line"> #3. 遍历所有目录，挨个发送</span><br><span class="line"> for file in $@</span><br><span class="line"> do</span><br><span class="line"> #4. 判断文件是否存在</span><br><span class="line"> if [ -e $file ]</span><br><span class="line"> then</span><br><span class="line"> #5. 获取父目录</span><br><span class="line"> pdir=$(cd -P $(dirname $file); pwd)</span><br><span class="line"> #6. 获取当前文件的名称</span><br><span class="line"> fname=$(basename $file)</span><br><span class="line"> ssh $host &quot;mkdir -p $pdir&quot;</span><br><span class="line"> rsync -av $pdir/$fname $host:$pdir</span><br><span class="line"> else</span><br><span class="line"> echo $file does not exists!</span><br><span class="line"> fi</span><br><span class="line"> done</span><br><span class="line">done</span><br></pre></td></tr></table></figure></li><li><p>修改脚本 xsync 具有执行权限</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">chmod +x xsync</span><br></pre></td></tr></table></figure></li><li><p>测试脚本</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">xsync /home/atguigu/bin</span><br></pre></td></tr></table></figure></li><li><p>将脚本复制到&#x2F;bin 中，以便全局调用</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo cp xsync /bin/</span><br></pre></td></tr></table></figure></li><li><p>同步环境变量配置（root 所有者）</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo ./bin/xsync /etc/profile.d/my_env.sh</span><br></pre></td></tr></table></figure><p>在hadoop103与hadoop104中</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">source /etc/profile</span><br></pre></td></tr></table></figure></li></ol></li></ol><h3 id="SSH-无密登录配置"><a href="#SSH-无密登录配置" class="headerlink" title="SSH 无密登录配置"></a>SSH 无密登录配置</h3><ol><li><p>生成公钥和私钥</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">cd /home/atguigu/.ssh</span><br><span class="line">ssh-keygen -t rsa</span><br></pre></td></tr></table></figure></li><li><p>将公钥拷贝到要免密登录的目标机器上</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">ssh-copy-id hadoop102</span><br><span class="line">ssh-copy-id hadoop103</span><br><span class="line">ssh-copy-id hadoop104</span><br></pre></td></tr></table></figure></li></ol><h3 id="集群配置"><a href="#集群配置" class="headerlink" title="集群配置"></a>集群配置</h3><p>core-site.xml、hdfs-site.xml、yarn-site.xml、mapred-site.xml 四个配置文件存放在$HADOOP_HOME&#x2F;etc&#x2F;hadoop 这个路径上，用户可以根据项目需求重新进行修改配置。</p><ol><li><p>核心配置文件</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">cd $HADOOP_HOME/etc/hadoop</span><br><span class="line">vim core-site.xml</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span><br><span class="line">&lt;?xml-stylesheet type=&quot;text/xsl&quot; href=&quot;configuration.xsl&quot;?&gt;</span><br><span class="line">&lt;configuration&gt;</span><br><span class="line"> &lt;!-- 指定 NameNode 的地址 --&gt;</span><br><span class="line"> &lt;property&gt;</span><br><span class="line"> &lt;name&gt;fs.defaultFS&lt;/name&gt;</span><br><span class="line"> &lt;value&gt;hdfs://hadoop102:8020&lt;/value&gt;</span><br><span class="line"> &lt;/property&gt;</span><br><span class="line"> &lt;!-- 指定 hadoop 数据的存储目录 --&gt;</span><br><span class="line"> &lt;property&gt;</span><br><span class="line"> &lt;name&gt;hadoop.tmp.dir&lt;/name&gt;</span><br><span class="line"> &lt;value&gt;/opt/module/hadoop-3.1.3/data&lt;/value&gt;</span><br><span class="line"> &lt;/property&gt;</span><br><span class="line"> &lt;!-- 配置 HDFS 网页登录使用的静态用户为 atguigu --&gt;</span><br><span class="line"> &lt;property&gt;</span><br><span class="line"> &lt;name&gt;hadoop.http.staticuser.user&lt;/name&gt;</span><br><span class="line"> &lt;value&gt;atguigu&lt;/value&gt;</span><br><span class="line"> &lt;/property&gt;</span><br><span class="line">&lt;/configuration&gt;</span><br></pre></td></tr></table></figure></li><li><p>HDFS 配置文件</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vim hdfs-site.xml</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span><br><span class="line">&lt;?xml-stylesheet type=&quot;text/xsl&quot; href=&quot;configuration.xsl&quot;?&gt;</span><br><span class="line">&lt;configuration&gt;</span><br><span class="line">&lt;!-- nn web 端访问地址--&gt;</span><br><span class="line">&lt;property&gt;</span><br><span class="line"> &lt;name&gt;dfs.namenode.http-address&lt;/name&gt;</span><br><span class="line"> &lt;value&gt;hadoop102:9870&lt;/value&gt;</span><br><span class="line"> &lt;/property&gt;</span><br><span class="line">&lt;!-- 2nn web 端访问地址--&gt;</span><br><span class="line"> &lt;property&gt;</span><br><span class="line"> &lt;name&gt;dfs.namenode.secondary.http-address&lt;/name&gt;</span><br><span class="line"> &lt;value&gt;hadoop104:9868&lt;/value&gt;</span><br><span class="line"> &lt;/property&gt;</span><br><span class="line">&lt;/configuration&gt;</span><br></pre></td></tr></table></figure></li><li><p>YARN 配置文件</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vim yarn-site.xml</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span><br><span class="line">&lt;?xml-stylesheet type=&quot;text/xsl&quot; href=&quot;configuration.xsl&quot;?&gt;</span><br><span class="line">&lt;configuration&gt;</span><br><span class="line"> &lt;!-- 指定 MR 走 shuffle --&gt;</span><br><span class="line"> &lt;property&gt;</span><br><span class="line"> &lt;name&gt;yarn.nodemanager.aux-services&lt;/name&gt;</span><br><span class="line"> &lt;value&gt;mapreduce_shuffle&lt;/value&gt;</span><br><span class="line"> &lt;/property&gt;</span><br><span class="line"> &lt;!-- 指定 ResourceManager 的地址--&gt;</span><br><span class="line"> &lt;property&gt;</span><br><span class="line"> &lt;name&gt;yarn.resourcemanager.hostname&lt;/name&gt;</span><br><span class="line"> &lt;value&gt;hadoop103&lt;/value&gt;</span><br><span class="line"> &lt;/property&gt;</span><br><span class="line"> &lt;!-- 环境变量的继承 --&gt;</span><br><span class="line"> &lt;property&gt;</span><br><span class="line"> &lt;name&gt;yarn.nodemanager.env-whitelist&lt;/name&gt;</span><br><span class="line"> </span><br><span class="line">&lt;value&gt;JAVA_HOME,HADOOP_COMMON_HOME,HADOOP_HDFS_HOME,HADOOP_CO</span><br><span class="line">NF_DIR,CLASSPATH_PREPEND_DISTCACHE,HADOOP_YARN_HOME,HADOOP_MAP</span><br><span class="line">RED_HOME&lt;/value&gt;</span><br><span class="line"> &lt;/property&gt;</span><br><span class="line">&lt;/configuration&gt;</span><br></pre></td></tr></table></figure></li><li><p>MapReduce 配置文件</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vim mapred-site.xml</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span><br><span class="line">&lt;?xml-stylesheet type=&quot;text/xsl&quot; href=&quot;configuration.xsl&quot;?&gt;</span><br><span class="line">&lt;configuration&gt;</span><br><span class="line">&lt;!-- 指定 MapReduce 程序运行在 Yarn 上 --&gt;</span><br><span class="line"> &lt;property&gt;</span><br><span class="line"> &lt;name&gt;mapreduce.framework.name&lt;/name&gt;</span><br><span class="line"> &lt;value&gt;yarn&lt;/value&gt;</span><br><span class="line"> &lt;/property&gt;</span><br><span class="line">&lt;/configuration&gt;</span><br></pre></td></tr></table></figure></li><li><p>在集群上分发配置好的 Hadoop 配置文件</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">xsync /opt/module/hadoop-3.1.3/etc/hadoop/</span><br></pre></td></tr></table></figure></li><li><p>去 103 和 104 上查看文件分发情况</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cat /opt/module/hadoop-3.1.3/etc/hadoop/core-site.xml</span><br></pre></td></tr></table></figure></li></ol><h3 id="群起集群"><a href="#群起集群" class="headerlink" title="群起集群"></a>群起集群</h3><ol><li><p>配置workers</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vim /opt/module/hadoop-3.1.3/etc/hadoop/workers</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">hadoop102</span><br><span class="line">hadoop103</span><br><span class="line">hadoop104</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">xsync /opt/module/hadoop-3.1.3/etc</span><br></pre></td></tr></table></figure></li><li><p>启动集群</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">cd /opt/module/hadoop-3.1.3</span><br><span class="line">hdfs namenode -format</span><br><span class="line">sbin/start-dfs.sh</span><br></pre></td></tr></table></figure><p>在配置了 ResourceManager 的节点（hadoop103）启动 YARN</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">cd /opt/module/hadoop-3.1.3</span><br><span class="line">sbin/start-yarn.sh</span><br></pre></td></tr></table></figure><p>Web 端查看 HDFS 的 NameNode</p><ol><li>浏览器中输入：<a href="http://hadoop102:9870/">http://hadoop102:9870</a></li><li>查看 HDFS 上存储的数据信息</li></ol><p>Web 端查看 YARN 的 ResourceManager</p><ol><li>浏览器中输入：<a href="http://hadoop103:8088/">http://hadoop103:8088</a></li><li>查看 YARN 上运行的 Job 信息</li></ol></li></ol></div>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;实验1-Hadoop环境安装&quot;&gt;&lt;a href=&quot;#实验1-Hadoop环境安装&quot; class=&quot;headerlink&quot; title=&quot;实验1  Hadoop环境安装&quot;&gt;&lt;/a&gt;实验1  Hadoop环境安装&lt;/h1&gt;&lt;div class=&quot;story post-</summary>
      
    
    
    
    <category term="学习笔记" scheme="http://example.com/categories/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/"/>
    
    
    <category term="Hadoop环境安装" scheme="http://example.com/tags/Hadoop%E7%8E%AF%E5%A2%83%E5%AE%89%E8%A3%85/"/>
    
  </entry>
  
  <entry>
    <title>Hadoop</title>
    <link href="http://example.com/2024/10/22/Hadoop/"/>
    <id>http://example.com/2024/10/22/Hadoop/</id>
    <published>2024-10-22T12:13:21.000Z</published>
    <updated>2024-10-23T14:27:28.617Z</updated>
    
    <content type="html"><![CDATA[<h1 id="Hadoop"><a href="#Hadoop" class="headerlink" title="Hadoop"></a>Hadoop</h1><ul><li>Hadoop是一个由Apache基金会所开发的分布式系统基础架构。</li><li>主要解决:海量数据的存储和海量数据的分析计算问题。</li></ul><h3 id="优势"><a href="#优势" class="headerlink" title="优势"></a>优势</h3><ul><li>高可靠性：Hadoop底层维护多个数据副本，所以即使Hadoop某个计算元素或存储出现故障，也不会导致数据的丢失。</li><li>高扩展性：在集群间分配任务数据，可方便的扩展数以千计的节点。</li><li>高效性：在MapReduce的思想下，Hadoop是并行工作的，以加快任务处理速度。</li><li>高容错性：能够自动将失败的任务重新分配。</li></ul><h3 id="组成"><a href="#组成" class="headerlink" title="组成"></a>组成</h3><ul><li>MapReduce负责运算。</li><li>Yarn负责资源的调度。</li><li>HDFS负责数据存储。</li><li>Common辅助工具</li></ul><div class="story post-story"><h2 id="HDFS架构"><a href="#HDFS架构" class="headerlink" title="HDFS架构"></a>HDFS架构</h2><p>Hadoop Distributed File System，简称 HDFS，是一个分布式文件系统。</p><ul><li>NameNode（nn）：存储文件的元数据，如文件名，文件目录结构，文件属性（生成时间、副本数、 文件权限），以及每个文件的块列表和块所在的DataNode等。</li><li>DataNode(dn)：在本地文件系统存储文件块数据，以及块数据的校验和。</li><li>Secondary NameNode(2nn)：每隔一段时间对NameNode元数据备份。</li></ul></div><div class="story post-story"><h2 id="YARN"><a href="#YARN" class="headerlink" title="YARN"></a>YARN</h2><p>Yet Another Resource Negotiator 简称 YARN ，另一种资源协调者，是 Hadoop 的资源管理器。</p><ul><li>ResourceManager：整个集群资源的老大</li><li>NodeManager：单个节点服务器资源老大</li><li>ApplicationMaster：单个任务运行的老大</li><li>Container：容器，相当于一台独立运行的服务器，里面封装了任务运行所需要的资源，如内存、CPU、磁盘、网络等。</li></ul></div><div class="story post-story"><h2 id="MapReduce"><a href="#MapReduce" class="headerlink" title="MapReduce"></a>MapReduce</h2><p>MapReduce 将计算过程分为两个阶段：Map 和 Reduce</p><ul><li>Map 阶段并行处理输入数据</li><li>Reduce 阶段对 Map 结果进行汇总</li></ul><p>1. </p></div>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;Hadoop&quot;&gt;&lt;a href=&quot;#Hadoop&quot; class=&quot;headerlink&quot; title=&quot;Hadoop&quot;&gt;&lt;/a&gt;Hadoop&lt;/h1&gt;&lt;ul&gt;
&lt;li&gt;Hadoop是一个由Apache基金会所开发的分布式系统基础架构。&lt;/li&gt;
&lt;li&gt;主要解决:</summary>
      
    
    
    
    
    <category term="Hadoop" scheme="http://example.com/tags/Hadoop/"/>
    
  </entry>
  
  <entry>
    <title>api_server后端项目</title>
    <link href="http://example.com/2024/10/17/api-server%E5%90%8E%E7%AB%AF%E9%A1%B9%E7%9B%AE/"/>
    <id>http://example.com/2024/10/17/api-server%E5%90%8E%E7%AB%AF%E9%A1%B9%E7%9B%AE/</id>
    <published>2024-10-17T02:43:35.000Z</published>
    <updated>2024-10-17T08:51:58.483Z</updated>
    
    <content type="html"><![CDATA[<h1 id="项目初始化"><a href="#项目初始化" class="headerlink" title="项目初始化"></a>项目初始化</h1><div class="story post-story"><h2 id="安装依赖"><a href="#安装依赖" class="headerlink" title="安装依赖"></a>安装依赖</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm i express cors mysql2</span><br></pre></td></tr></table></figure></div><div class="story post-story"><h2 id="配置跨域、处理表单数据的中间件、路由"><a href="#配置跨域、处理表单数据的中间件、路由" class="headerlink" title="配置跨域、处理表单数据的中间件、路由"></a>配置跨域、处理表单数据的中间件、路由</h2><ol><li>在项目根目录中，新建router文件夹，用来存放路由</li><li>在项目根目录中，新建router_handler文件夹，用来存放所有的路由处理函数模块</li></ol><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//     /router_handler/user.js</span></span><br><span class="line"><span class="built_in">exports</span>.<span class="property">regUser</span> = <span class="function">(<span class="params">req, res</span>) =&gt;</span> &#123;</span><br><span class="line">    res.<span class="title function_">send</span>(<span class="string">&#x27;regUser ok&#x27;</span>)</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="built_in">exports</span>.<span class="property">login</span> = <span class="function">(<span class="params">req, res</span>) =&gt;</span> &#123;</span><br><span class="line">    res.<span class="title function_">send</span>(<span class="string">&#x27;login ok&#x27;</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//    /router/user.js</span></span><br><span class="line"><span class="keyword">const</span> express = <span class="built_in">require</span>(<span class="string">&#x27;express&#x27;</span>)</span><br><span class="line"><span class="keyword">const</span> router = express.<span class="title class_">Router</span>()</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> userHandler = <span class="built_in">require</span>(<span class="string">&#x27;../router_handler/user&#x27;</span>)</span><br><span class="line">router.<span class="title function_">post</span>(<span class="string">&#x27;/reguser&#x27;</span>, userHandler.<span class="property">regUser</span>)</span><br><span class="line"></span><br><span class="line">router.<span class="title function_">post</span>(<span class="string">&#x27;/login&#x27;</span>, userHandler.<span class="property">login</span>)</span><br><span class="line"></span><br><span class="line"><span class="variable language_">module</span>.<span class="property">exports</span> = router</span><br></pre></td></tr></table></figure><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//   app.js</span></span><br><span class="line"><span class="keyword">const</span> express = <span class="built_in">require</span>(<span class="string">&#x27;express&#x27;</span>)</span><br><span class="line"><span class="comment">//创建服务器的实例对象</span></span><br><span class="line"><span class="keyword">const</span> app = <span class="title function_">express</span>()</span><br><span class="line"></span><br><span class="line"><span class="comment">//配置cors跨域</span></span><br><span class="line"><span class="keyword">const</span> cors = <span class="built_in">require</span>(<span class="string">&#x27;cors&#x27;</span>)</span><br><span class="line">app.<span class="title function_">use</span>(<span class="title function_">cors</span>())</span><br><span class="line"><span class="comment">//配置解析application/x-www-form-urlencoded格式的表单数据的中间件</span></span><br><span class="line">app.<span class="title function_">use</span>(express.<span class="title function_">urlencoded</span>(&#123; <span class="attr">extended</span>: <span class="literal">false</span> &#125;))</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> useRouter = <span class="built_in">require</span>(<span class="string">&#x27;./router/user.js&#x27;</span>)</span><br><span class="line">app.<span class="title function_">use</span>(<span class="string">&#x27;/api&#x27;</span>, useRouter)</span><br><span class="line">app.<span class="title function_">listen</span>(<span class="number">3007</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;api server running at http://127.0.0.1:3007&#x27;</span>);</span><br><span class="line"></span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><h1 id="安装并配置mysql模块"><a href="#安装并配置mysql模块" class="headerlink" title="安装并配置mysql模块"></a>安装并配置mysql模块</h1><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">//     /db/index.js</span><br><span class="line">const mysql = require(&#x27;mysql2&#x27;)</span><br><span class="line">const db = mysql.createPool(&#123;</span><br><span class="line">    host: &#x27;127.0.0.1&#x27;,</span><br><span class="line">    user: &#x27;root&#x27;,</span><br><span class="line">    password: &#x27;123456&#x27;,</span><br><span class="line">    database: &#x27;my_db_01&#x27;</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">module.exports = db</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">const db = require(&#x27;./db&#x27;)</span><br><span class="line">const bcrypt = require(&#x27;bcryptjs&#x27;)</span><br><span class="line">const userInfo = &#123;</span><br><span class="line">    account: &#x27;sherlock&#x27;,</span><br><span class="line">    password: &#x27;aptx4869&#x27;</span><br><span class="line">&#125;</span><br><span class="line">const sqlStr = &#x27;select * from rabbit_users where account=?&#x27;</span><br><span class="line">db.query(sqlStr, userInfo.account, (err, results) =&gt; &#123;</span><br><span class="line">    if (err) &#123;</span><br><span class="line">        console.log(err.message)</span><br><span class="line">    &#125;</span><br><span class="line">    if (results.length === 1 &amp;&amp; bcrypt.compareSync(userInfo.password, results[0].password)) &#123;</span><br><span class="line">        console.log(&#x27;登录成功&#x27;)</span><br><span class="line">    &#125;</span><br><span class="line">    else &#123;</span><br><span class="line">        res.cc(&#x27;登录失败！&#x27;)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><h1 id="加密解密"><a href="#加密解密" class="headerlink" title="加密解密"></a>加密解密</h1><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm i bcryptjs</span><br></pre></td></tr></table></figure><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> bcrypt = <span class="built_in">require</span>(<span class="string">&#x27;bcryptjs&#x27;</span>)</span><br><span class="line">userinfo.<span class="property">password</span> = bcrypt.<span class="title function_">hashSync</span>(userinfo.<span class="property">password</span>,<span class="number">10</span>)</span><br></pre></td></tr></table></figure></div>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;项目初始化&quot;&gt;&lt;a href=&quot;#项目初始化&quot; class=&quot;headerlink&quot; title=&quot;项目初始化&quot;&gt;&lt;/a&gt;项目初始化&lt;/h1&gt;&lt;div class=&quot;story post-story&quot;&gt;&lt;h2 id=&quot;安装依赖&quot;&gt;&lt;a href=&quot;#安装依赖&quot; c</summary>
      
    
    
    
    <category term="项目" scheme="http://example.com/categories/%E9%A1%B9%E7%9B%AE/"/>
    
    
    <category term="node.js" scheme="http://example.com/tags/node-js/"/>
    
  </entry>
  
  <entry>
    <title>数据库</title>
    <link href="http://example.com/2024/10/15/%E6%95%B0%E6%8D%AE%E5%BA%93/"/>
    <id>http://example.com/2024/10/15/%E6%95%B0%E6%8D%AE%E5%BA%93/</id>
    <published>2024-10-15T09:17:26.000Z</published>
    <updated>2024-10-22T12:14:50.545Z</updated>
    
    <content type="html"><![CDATA[<h1 id="数据库系统概论"><a href="#数据库系统概论" class="headerlink" title="数据库系统概论"></a>数据库系统概论</h1><div class="story post-story"><h2 id="概述"><a href="#概述" class="headerlink" title="概述"></a>概述</h2><hr><h3 id="四个基本概念"><a href="#四个基本概念" class="headerlink" title="四个基本概念"></a>四个基本概念</h3><ul><li>数据(data)：描述事物的<strong>符号</strong>记录称为数据</li><li>数据库(DB)：<strong>长期储存</strong>在计算机内的，<strong>有组织的</strong>、<strong>可共享</strong>的大量数据的集合。</li><li>数据库管理系统(DBMS)：计算机基础软件。具有<ul><li>数据定义功能(DDL)，定义数据对象的组成和结构</li><li>数据组织存储和管理</li><li>数据操纵功能（DML），实现数据的增删改查</li><li>数据库的事务管理和运行管理</li><li>数据库的建立和维护功能</li></ul></li></ul><ol start="4"><li>数据库系统（DBS）：由数据库（DB）、数据库管理系统（DBMS）、应用程序（APP）和数据库管理员（DBA）组成的存储、管理、处理和维护数据的系统。</li></ol><h3 id="数据库系统的特点"><a href="#数据库系统的特点" class="headerlink" title="数据库系统的特点"></a>数据库系统的特点</h3><ul><li>数据结构化</li><li>数据共享性高、冗余度低且易扩充</li><li>数据独立性高 <ul><li>物理独立性：应用程序与数据库中数据的物理存储相互独立。</li><li>逻辑独立性：应用程序与数据库的逻辑结构相互独立。</li></ul></li><li>数据由数据库管理系统统一管理和控制</li></ul></div><div class="story post-story"><h2 id="数据模型——数据库系统的核心和基础"><a href="#数据模型——数据库系统的核心和基础" class="headerlink" title="数据模型——数据库系统的核心和基础"></a>数据模型——数据库系统的<font color="pink">核心</font>和<font color="pink">基础</font></h2><hr><h3 id="两类数据模型"><a href="#两类数据模型" class="headerlink" title="两类数据模型"></a>两类数据模型</h3><ul><li>概念模型<br> 按用户的观点来对数据和信息建模</li><li>逻辑模型和物理模型<ul><li>逻辑模型：按计算机系统的观点对数据建模。包括层次模型、网状模型、关系模型、面向对象模型、对象关系数据类型、半结构化数据类型等</li><li>物理模型：数据在系统内部的表示方式和方法</li><li>逻辑模型到物理模型的转换，主要由<strong>数据库管理系统</strong>实现</li></ul></li></ul><h3 id="概念模型"><a href="#概念模型" class="headerlink" title="概念模型"></a>概念模型</h3><ol><li>基本概念<ul><li>实体：客观存在并可区分的事物</li><li>属性：实体具有的某一特性</li><li>码：唯一标志实体的属性</li><li>实体型：用实体名及其属性名集合来刻画和抽象同类实体。</li><li>联系： 实体之间的联系，通常指不同实体集之间的联系。</li></ul></li><li>一种表示方法：实体-联系方法，也称为E-R模型</li></ol><h3 id="数据模型的组成要素"><a href="#数据模型的组成要素" class="headerlink" title="数据模型的组成要素"></a>数据模型的组成要素</h3><ul><li>数据结构</li><li>数据操作</li><li>数据的完整性约束条件</li></ul><h3 id="关系模型"><a href="#关系模型" class="headerlink" title="关系模型"></a>关系模型</h3><ul><li>术语：<ul><li>关系：对应一张表</li><li>元组：表中的一行</li><li>属性：表中的一列</li><li>码：某个属性组，唯一确定一个元组</li><li>域：一组具有相同数据类型是的集合</li><li>关系模式：对关系的描述</li></ul></li><li>优点<ul><li>与格式化模型不同，建立在严格的数学概念基础上</li><li>数据独立性保密性更高</li><li>概念单一、结构简单、清晰</li><li>存取路径对用户透明</li></ul></li><li>缺点<ul><li>查询效率不如格式化模型数据</li></ul></li></ul></div><div class="story post-story"><h2 id="数据库系统的结构"><a href="#数据库系统的结构" class="headerlink" title="数据库系统的结构"></a>数据库系统的结构</h2><hr><h3 id="模式"><a href="#模式" class="headerlink" title="模式"></a>模式</h3><ul><li>模式是相对稳定的，实例是相对变动的</li></ul><h3 id="三级模式结构"><a href="#三级模式结构" class="headerlink" title="三级模式结构"></a>三级模式结构</h3><ol><li>模式，也称逻辑模式，是所有用户的公共数据视图，模式不涉及物理存储和硬件环境，与应用程序和开发环境无关。</li><li>外模式，也称子模式或用户模式，数据库用户的数据视图，<strong>外模式通常是模式的子集</strong>。</li><li>内模式，也称存储模式，是数据在数据库内部的组织方式</li></ol><h3 id="二级映象功能与数据独立性"><a href="#二级映象功能与数据独立性" class="headerlink" title="二级映象功能与数据独立性"></a>二级映象功能与数据独立性</h3><ul><li>数据独立性是指应用程序与数据库的数据结构之间相互独立<ul><li>在物理结构改变时，尽量不影响应用程序，称为物理数据独立性</li><li>在逻辑结构改变时，尽量不影响应用程序，称为逻辑数据独立性</li></ul></li></ul><ol><li>外模式&#x2F;模式映像<br> 模式改变时，可使外模式保持不变，保证逻辑独立性</li><li>模式&#x2F;内模式映像<br> 存储结构发生改变时，可使模式保持不变，保证物理独立性</li></ol><ul><li>数据库模式是数据库的<strong>中心与关键</strong>，应首先确定。</li></ul></div><div class="story post-story"><h2 id="关系数据库结构及定义"><a href="#关系数据库结构及定义" class="headerlink" title="关系数据库结构及定义"></a>关系数据库结构及定义</h2><hr><p>在数据库中存储的是<strong>数据以及数据之间的联系</strong>。</p><h3 id="定义"><a href="#定义" class="headerlink" title="定义"></a>定义</h3><ul><li>域</li><li>笛卡尔积<ul><li>元组和分量</li><li>基数：一个域允许的不同取值的个数</li></ul></li><li>关系<ul><li>关系的度（单元关系，二元关系）</li><li>候选码（能唯一表示一个元组的属性集）——&gt;挑一个作为主码</li><li>主属性：候选码的诸属性<br>其余——非主属性或非码属性</li><li>全码：关系模式的所有属性是这个关系模式的候选码</li><li>三种类型：<ul><li>基本关系，又称基本表</li><li>查询表</li><li>视图表</li></ul></li><li>六条性质：<ul><li>行的顺序无所谓</li><li>列的顺序无所谓</li><li>列是同质的</li><li>不同列可出自同一域</li><li>任意两个元组候选码不同</li><li>分量必须取原子值（最基本的一条，满足即为第一范式）</li></ul></li></ul></li></ul><h3 id="关系模式"><a href="#关系模式" class="headerlink" title="关系模式"></a>关系模式</h3><ul><li>关系模式是<strong>静态</strong>的、<strong>稳定</strong>的，而关系是动态的</li></ul><h3 id="基本关系操作"><a href="#基本关系操作" class="headerlink" title="基本关系操作"></a>基本关系操作</h3><ul><li>查询操作<ul><li>选择</li><li>投影</li><li>并</li><li>差</li><li>笛卡尔积&#x2F;&#x2F;以上5种基本数据操作</li><li>连接</li><li>除</li><li>交</li></ul></li><li>插入、删除、修改操作</li></ul><h3 id="结构化查询语言SQL"><a href="#结构化查询语言SQL" class="headerlink" title="结构化查询语言SQL"></a>结构化查询语言SQL</h3><p>集</p><ul><li>查询</li><li>数据定义语言</li><li>数据操纵语言</li><li>数据控制语言<br>于一体的关系数据语言。</li></ul></div><div class="story post-story"><h2 id="关系的完整性"><a href="#关系的完整性" class="headerlink" title="关系的完整性"></a>关系的完整性</h2><hr><ol><li>实体完整性：若属性A是关系R的主属性，则A不能取空值。</li><li>参照完整性：若属性F是关系R的外码，它与基本关系S的主码相对应，则对于R上的每一个元组在F上的值应该或者取空值、或者取S中某个元组的主码值。</li><li>用户定义的完整性</li></ol><p>实体完整性和参照完整性是关系的两个不变性。</p></div><div class="story post-story"><h2 id="关系代数"><a href="#关系代数" class="headerlink" title="关系代数"></a>关系代数</h2><hr><h3 id="传统集合运算"><a href="#传统集合运算" class="headerlink" title="传统集合运算"></a>传统集合运算</h3><ul><li>并</li><li>差</li><li>交</li><li>笛卡尔积</li></ul><h3 id="关系运算"><a href="#关系运算" class="headerlink" title="关系运算"></a>关系运算</h3><p>象集：给定关系R（X,Z）,x在R中的象集为Zx，表示R中属性组X上的属性值为x的诸元组在Z上分量的集合，是<strong>属性组值</strong>的子集<br>关系运算的定义：</p><ul><li>选择</li><li>投影</li><li>连接<br>常用：<ul><li>等值连接</li><li>自然连接，一种特殊的等值连接，它要求两个关系中进行比较的分量必须是同名的属性组，并且在结果中把重复的属性列去掉。</li><li>外连接：保留悬浮元组<ul><li>左外连接：只保留左边关系的悬浮元组</li><li>右外连接：只保留右边关系的悬浮元组</li></ul></li></ul></li><li>除：若T为R除以S的结果，则T包含所有在R中而不在S中的属性及其值，且T与S的所有组合均在R中。</li></ul></div><div class="story post-story"><h2 id="SQL"><a href="#SQL" class="headerlink" title="SQL"></a>SQL</h2><hr><h3 id="SQL的特点"><a href="#SQL的特点" class="headerlink" title="SQL的特点"></a>SQL的特点</h3><ol><li>综合统一</li><li>高度<strong>非过程化</strong></li><li><strong>面向集合</strong>的操作方式</li><li>以同一种语法结构提供<strong>多种使用方式</strong>：交互式和嵌入式</li><li>语言简洁，易学易用</li></ol><h3 id="SQL的基本概念"><a href="#SQL的基本概念" class="headerlink" title="SQL的基本概念"></a>SQL的基本概念</h3><ul><li>外模式包括视图和若干基本表，模式包括若干基本表，内模式包括若干存储文件。</li><li>在关系数据库管理系统中一个关系就对应一个基本表。一个或多个表对应一个存储文件，一个表可以带若干索引。索引也放在存储文件当中。</li></ul><h3 id="数据定义"><a href="#数据定义" class="headerlink" title="数据定义"></a>数据定义</h3><h4 id="模式的定义与删除"><a href="#模式的定义与删除" class="headerlink" title="模式的定义与删除"></a>模式的定义与删除</h4><ul><li>建立模式<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> SCHEMA <span class="operator">&lt;</span>模式名<span class="operator">&gt;</span> <span class="keyword">AUTHORIZATION</span> <span class="operator">&lt;</span>用户名<span class="operator">&gt;</span></span><br><span class="line">[<span class="operator">&lt;</span>表定义子句<span class="operator">&gt;</span><span class="operator">|</span><span class="operator">&lt;</span>视图定义子句<span class="operator">&gt;</span><span class="operator">|</span><span class="operator">&lt;</span>授权定义子句<span class="operator">&gt;</span>];</span><br></pre></td></tr></table></figure></li><li>删除模式<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">DROP</span> SCHEMA <span class="operator">&lt;</span>CASCADE<span class="operator">|</span>RESRICT<span class="operator">&gt;</span>;</span><br></pre></td></tr></table></figure></li></ul><h4 id="基本表的定义、删除与修改"><a href="#基本表的定义、删除与修改" class="headerlink" title="基本表的定义、删除与修改"></a>基本表的定义、删除与修改</h4><ul><li>创建表<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> <span class="operator">&lt;</span>表名<span class="operator">&gt;</span> (</span><br><span class="line"><span class="operator">&lt;</span>列名<span class="operator">&gt;</span><span class="operator">&lt;</span>数据类型<span class="operator">&gt;</span>[<span class="operator">&lt;</span>列级完整性约束条件<span class="operator">&gt;</span>]</span><br><span class="line">[,<span class="operator">&lt;</span>列名<span class="operator">&gt;</span><span class="operator">&lt;</span>数据类型<span class="operator">&gt;</span>[<span class="operator">&lt;</span>列级完整性约束条件<span class="operator">&gt;</span>]]</span><br><span class="line">...</span><br><span class="line">[,<span class="operator">&lt;</span>表级完整性约束条件<span class="operator">&gt;</span>]</span><br><span class="line">);</span><br></pre></td></tr></table></figure></li><li>模式与表<ol><li>在表中给出模式名，如CREATE TABLE “&lt;模式名&gt;”.&lt;表名&gt;</li><li>创建模式语句同时创建表</li><li>设置所属模式，如下<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SHOW</span> search_path; #显示当前搜索路径</span><br><span class="line"><span class="keyword">SET</span> search_path <span class="keyword">TO</span> &quot;&lt;模式名&gt;&quot;,PUBLIC; #设置搜索路径</span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> <span class="operator">&lt;</span>表名<span class="operator">&gt;</span>();</span><br></pre></td></tr></table></figure></li></ol></li><li>修改基本表<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> <span class="operator">&lt;</span>表名<span class="operator">&gt;</span></span><br><span class="line">[<span class="keyword">ADD</span> [<span class="keyword">COLUMN</span>] <span class="operator">&lt;</span>新列名<span class="operator">&gt;</span><span class="operator">&lt;</span>数据类型<span class="operator">&gt;</span> [完整性约束]]</span><br><span class="line">[<span class="keyword">ADD</span> <span class="operator">&lt;</span>表级完整性约束<span class="operator">&gt;</span>]</span><br><span class="line">[<span class="keyword">DROP</span>[<span class="keyword">COLUMN</span>]<span class="operator">&lt;</span>列名<span class="operator">&gt;</span>[CASCADE<span class="operator">|</span>RESCTICT]]</span><br><span class="line">[<span class="keyword">DROP</span> <span class="keyword">CONSTRAINT</span><span class="operator">&lt;</span>完整性约束名<span class="operator">&gt;</span>[CASCADE<span class="operator">|</span>RESTRICT]]</span><br><span class="line">[<span class="keyword">ALTER</span> <span class="keyword">COLUMN</span> <span class="operator">&lt;</span>列名<span class="operator">&gt;</span><span class="operator">&lt;</span>数据类型<span class="operator">&gt;</span>];</span><br></pre></td></tr></table></figure></li><li>删除表<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">DROP</span> <span class="keyword">TABLE</span> <span class="operator">&lt;</span>表名<span class="operator">&gt;</span> [RESTRICT<span class="operator">|</span>CASCADE];</span><br></pre></td></tr></table></figure></li></ul><h4 id="索引的建立与删除"><a href="#索引的建立与删除" class="headerlink" title="索引的建立与删除"></a>索引的建立与删除</h4><ul><li>建立索引<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> [<span class="keyword">UNIQUE</span>] [CLUSTER] INDEX <span class="operator">&lt;</span>索引名<span class="operator">&gt;</span></span><br><span class="line"><span class="keyword">ON</span> <span class="operator">&lt;</span>表名<span class="operator">&gt;</span>(<span class="operator">&lt;</span>列名<span class="operator">&gt;</span>[<span class="operator">&lt;</span><span class="keyword">ASC</span><span class="operator">|</span><span class="keyword">DESC</span><span class="operator">&gt;</span>][,<span class="operator">&lt;</span>列名<span class="operator">&gt;</span>[<span class="operator">&lt;</span><span class="keyword">ASC</span><span class="operator">|</span><span class="keyword">DESC</span><span class="operator">&gt;</span>]]...);</span><br></pre></td></tr></table></figure></li><li>修改索引<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">ALTER</span> INDEX <span class="operator">&lt;</span>旧索引名<span class="operator">&gt;</span> RENAME <span class="keyword">TO</span> <span class="operator">&lt;</span>新索引名<span class="operator">&gt;</span>;</span><br></pre></td></tr></table></figure></li><li>删除索引<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">DROP</span> INDEX <span class="operator">&lt;</span>索引名<span class="operator">&gt;</span>;</span><br></pre></td></tr></table></figure></li></ul><h3 id="数据操纵"><a href="#数据操纵" class="headerlink" title="数据操纵"></a>数据操纵</h3><h4 id="数据查询"><a href="#数据查询" class="headerlink" title="数据查询"></a>数据查询</h4><ul><li><p>SELECT语句</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> [<span class="keyword">ALL</span><span class="operator">|</span><span class="keyword">DISTINCT</span>]<span class="operator">&lt;</span>目标列表达式<span class="operator">&gt;</span>[,<span class="operator">&lt;</span>目标列表达式<span class="operator">&gt;</span>]...</span><br><span class="line"><span class="keyword">FROM</span> <span class="operator">&lt;</span>表名或视图名<span class="operator">&gt;</span> [,<span class="operator">&lt;</span>表名或视图名<span class="operator">&gt;</span>...]<span class="operator">|</span>(<span class="keyword">SELECT</span>语句)[<span class="keyword">AS</span>](别名)</span><br><span class="line">[<span class="keyword">WHERE</span> <span class="operator">&lt;</span>条件表达式<span class="operator">&gt;</span>]</span><br><span class="line">[<span class="keyword">GROUP</span> <span class="keyword">BY</span> <span class="operator">&lt;</span>列名<span class="number">1</span><span class="operator">&gt;</span> [<span class="keyword">HAVING</span> <span class="operator">&lt;</span>条件表达式<span class="operator">&gt;</span>]]</span><br><span class="line">[<span class="keyword">ORDER</span> <span class="keyword">BY</span> <span class="operator">&lt;</span>列名<span class="number">2</span><span class="operator">&gt;</span> [<span class="keyword">ASC</span><span class="operator">|</span><span class="keyword">DESC</span>]];</span><br></pre></td></tr></table></figure><ul><li>tips</li></ul><ol><li>SELECT * —-查询全部列</li><li>常用查询条件<ul><li>&#x3D;,&gt;,&lt;,&gt;&#x3D;,&lt;&#x3D;,&lt;&gt;,!&gt;,!&lt;;NOT+ 上述比较符</li><li>[NOT] BETWEEN AND</li><li>[NOT] IN</li><li>[NOT] LIKE</li><li><font color="blue">IS </font>[NOT] NULL</li><li>AND,OR,NOT</li></ul></li><li>聚集函数<ul><li>COUNT(*)    ！！！不忽略空值NULL</li><li>COUNT([DISTINCT|ALL]&lt;列名&gt;)</li><li>SUM([DISTINCT|ALL]&lt;列名&gt;)</li><li>AVG([DISTINCT|ALL]&lt;列名&gt;)</li><li>MAX([DISTINCT|ALL]&lt;列名&gt;)</li><li>MIN([DISTINCT|ALL]&lt;列名&gt;)</li></ul></li><li>GROUP BY子句 + HAVING子句</li></ol></li><li><p>连接查询</p><ol><li>等值与非等值连接查询</li><li>自身连接（要给表取两个别名）</li><li>外连接</li><li>多表连接</li></ol></li><li><p>嵌套查询<br>  相关定义：</p><ol><li>一个SELECT-FROM-WHERE语句称为一个查询块，将一个查询块嵌套在另一个查询块的WHERE子句或HAVING短语的条件中的查询称为嵌套查询</li><li>外层查询又称父查询，内层查询又称子查询</li><li>子查询不能使用ORDER BY语句</li><li>不相关子查询：子查询的查询条件不依赖于父查询</li><li>相关子查询：子查询的查询条件依赖于父查询，不能一次性将子查询的结果求解出来，而是反复求值</li><li>嵌套查询中维持ANY&#x2F;SOME表示任一，ALL表示所有（任意）</li><li>带有EXISTS谓词的子查询，产生ture或false。（！！！所有带有IN谓词，、比较运算符、ANY和ALL谓词的子查询都能用带EXISTS的子查询等价替代）</li><li>空值进行四则运算还是空值</li></ol></li><li><p>集合查询–各查询结果列数必须相同，对应数据项的数据类型也必须相同</p><ul><li>UNION–自动去掉重复元组，如要保留则用UNION ALL操作符。</li><li>INTERSECT</li><li>EXCEPT</li></ul></li><li><p>派生表查询：子查询嵌套于FROM子句中。（！！！AS关键字可以省略，但必须为派生关系指定别名）</p></li></ul><h4 id="插入数据"><a href="#插入数据" class="headerlink" title="插入数据"></a>插入数据</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> <span class="operator">&lt;</span>表名<span class="operator">&gt;</span>[(<span class="operator">&lt;</span>属性列<span class="number">1</span><span class="operator">&gt;</span>[,<span class="operator">&lt;</span>属性列<span class="number">2</span><span class="operator">&gt;</span>]...)]</span><br><span class="line"><span class="keyword">VALUES</span>(<span class="operator">&lt;</span>常量<span class="number">1</span><span class="operator">&gt;</span>[,<span class="operator">&lt;</span>常量<span class="number">2</span><span class="operator">&gt;</span>]...);</span><br></pre></td></tr></table></figure><p>或</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> <span class="operator">&lt;</span>表名<span class="operator">&gt;</span>[(<span class="operator">&lt;</span>属性列<span class="number">1</span><span class="operator">&gt;</span>[,<span class="operator">&lt;</span>属性列<span class="number">2</span><span class="operator">&gt;</span>]...)]</span><br><span class="line">子查询;</span><br></pre></td></tr></table></figure><h4 id="修改数据"><a href="#修改数据" class="headerlink" title="修改数据"></a>修改数据</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">UPDATE</span> <span class="operator">&lt;</span>表名<span class="operator">&gt;</span></span><br><span class="line"><span class="keyword">SET</span> <span class="operator">&lt;</span>列名<span class="operator">&gt;=</span><span class="operator">&lt;</span>表达式<span class="operator">&gt;</span> [,<span class="operator">&lt;</span>列名<span class="operator">&gt;=</span><span class="operator">&lt;</span>表达式<span class="operator">&gt;</span>]...</span><br><span class="line">[<span class="keyword">WHERE</span> <span class="operator">&lt;</span>条件<span class="operator">&gt;</span>];</span><br></pre></td></tr></table></figure><h4 id="删除数据"><a href="#删除数据" class="headerlink" title="删除数据"></a>删除数据</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">DELETE</span> <span class="keyword">FROM</span> <span class="operator">&lt;</span>表名<span class="operator">&gt;</span></span><br><span class="line">[<span class="keyword">WHERE</span> <span class="operator">&lt;</span>条件<span class="operator">&gt;</span>];</span><br></pre></td></tr></table></figure><h3 id="视图——只存放定义，不存放数据"><a href="#视图——只存放定义，不存放数据" class="headerlink" title="视图——只存放定义，不存放数据"></a>视图——只存放定义，不存放数据</h3><ul><li>建立视图<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">VIEW</span> <span class="operator">&lt;</span>视图名<span class="operator">&gt;</span> [<span class="operator">&lt;</span>列名<span class="operator">&gt;</span>[,<span class="operator">&lt;</span>列名<span class="operator">&gt;</span>]...]</span><br><span class="line"><span class="keyword">AS</span> <span class="operator">&lt;</span>子查询<span class="operator">&gt;</span></span><br><span class="line">[<span class="keyword">WITH</span> <span class="keyword">CHECK</span> OPTION];</span><br></pre></td></tr></table></figure>创建视图时并不执行SELECT语句，对视图查询时，才将数据查出。</li><li>删除视图<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">DROP</span> <span class="keyword">VIEW</span> <span class="operator">&lt;</span>视图名<span class="operator">&gt;</span> CASCADE;</span><br></pre></td></tr></table></figure></li><li>视图的作用<ol><li>视图能够简化用户操作</li><li>视图使用户能以多角度看待同一数据</li><li>视图对重构数据库提供了一定程度的逻辑独立性</li><li>视图能够对机密数据提供安全保护</li><li>更加清晰地表达查询</li></ol></li></ul></div><div class="story post-story"><h2 id="数据库安全"><a href="#数据库安全" class="headerlink" title="数据库安全"></a>数据库安全</h2><h3 id="授予与收回权限（控制类指令）–实现自主存取控制"><a href="#授予与收回权限（控制类指令）–实现自主存取控制" class="headerlink" title="授予与收回权限（控制类指令）–实现自主存取控制"></a>授予与收回权限（控制类指令）–实现自主存取控制</h3><ul><li>用户权限由两要素组成：数据库对象和操作类型</li><li>GRANT：授予用户对列的操作权限<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">GRANT</span> <span class="operator">&lt;</span>权限<span class="operator">&gt;</span>[,<span class="operator">&lt;</span>权限<span class="operator">&gt;</span>]...</span><br><span class="line"><span class="keyword">ON</span> <span class="operator">&lt;</span>对象类型<span class="operator">&gt;</span><span class="operator">&lt;</span>对象名<span class="operator">&gt;</span>[,<span class="operator">&lt;</span>对象类型<span class="operator">&gt;</span><span class="operator">&lt;</span>对象名<span class="operator">&gt;</span>]...</span><br><span class="line"><span class="keyword">TO</span> <span class="operator">&lt;</span>用户<span class="operator">&gt;</span>[,<span class="operator">&lt;</span>用户<span class="operator">&gt;</span>]...</span><br><span class="line">[<span class="keyword">WITH</span> <span class="keyword">GRANT</span> OPTION];</span><br></pre></td></tr></table></figure></li><li>REVOKE<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">REVOKE</span> <span class="operator">&lt;</span>权限<span class="operator">&gt;</span>[,<span class="operator">&lt;</span>权限<span class="operator">&gt;</span>]...</span><br><span class="line"><span class="keyword">ON</span> <span class="operator">&lt;</span>对象类型<span class="operator">&gt;</span><span class="operator">&lt;</span>对象名<span class="operator">&gt;</span>[,<span class="operator">&lt;</span>对象类型<span class="operator">&gt;</span><span class="operator">&lt;</span>对象名<span class="operator">&gt;</span>]...</span><br><span class="line"><span class="keyword">FROM</span> <span class="operator">&lt;</span>用户<span class="operator">&gt;</span>[,<span class="operator">&lt;</span>用户<span class="operator">&gt;</span>]...</span><br><span class="line">[CASCADE<span class="operator">|</span>RESTRINCT];</span><br></pre></td></tr></table></figure></li><li>创建数据库模式的权限<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">USER</span> <span class="operator">&lt;</span>username<span class="operator">&gt;</span> [<span class="keyword">WITH</span>][DBA<span class="operator">|</span>RESOURCE<span class="operator">|</span><span class="keyword">CONNECT</span>];</span><br></pre></td></tr></table></figure></li></ul><h3 id="数据库角色"><a href="#数据库角色" class="headerlink" title="数据库角色"></a>数据库角色</h3><ul><li>数据库角色是被命名的一组与数据库操作相关的权限，角色是权限的集合。</li><li>创建角色<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> ROLE <span class="operator">&lt;</span>角色名<span class="operator">&gt;</span>;</span><br></pre></td></tr></table></figure></li><li>给角色授权<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">GRANT</span> <span class="operator">&lt;</span>权限<span class="operator">&gt;</span>[,<span class="operator">&lt;</span>权限<span class="operator">&gt;</span>]...</span><br><span class="line"><span class="keyword">ON</span> <span class="operator">&lt;</span>对象类型<span class="operator">&gt;</span> <span class="operator">&lt;</span>对象名<span class="operator">&gt;</span></span><br><span class="line"><span class="keyword">TO</span> <span class="operator">&lt;</span>角色<span class="operator">&gt;</span>[,<span class="operator">&lt;</span>角色<span class="operator">&gt;</span>]...;</span><br></pre></td></tr></table></figure></li><li>将一个角色授权给其他角色或用户<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">GRANT</span> <span class="operator">&lt;</span>角色<span class="number">1</span><span class="operator">&gt;</span>[,<span class="operator">&lt;</span>角色<span class="number">2</span><span class="operator">&gt;</span>]...</span><br><span class="line"><span class="keyword">TO</span> <span class="operator">&lt;</span>角色<span class="number">3</span><span class="operator">&gt;</span>[,<span class="operator">&lt;</span>用户<span class="number">1</span><span class="operator">&gt;</span>]...</span><br><span class="line">[<span class="keyword">WITH</span> ADMIN OPTION];</span><br></pre></td></tr></table></figure></li><li>角色权限的收回<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">REVOKE</span> <span class="operator">&lt;</span>权限<span class="operator">&gt;</span>[,<span class="operator">&lt;</span>权限<span class="operator">&gt;</span>]...</span><br><span class="line"><span class="keyword">ON</span> <span class="operator">&lt;</span>对象类型<span class="operator">&gt;</span> <span class="operator">&lt;</span>对象名<span class="operator">&gt;</span></span><br><span class="line"><span class="keyword">FROM</span> <span class="operator">&lt;</span>角色<span class="operator">&gt;</span>[,<span class="operator">&lt;</span>角色<span class="operator">&gt;</span>]...</span><br></pre></td></tr></table></figure></li></ul><h3 id="强制存取控制"><a href="#强制存取控制" class="headerlink" title="强制存取控制"></a>强制存取控制</h3><p>敏感度标记：TS&gt;&#x3D;S&gt;&#x3D;C&gt;&#x3D;P<br>规则：</p><ul><li>仅当主体的许可证级别大于或者等于客体的密级时，改主体才能读取相应的客体。</li><li>仅当主体的许可证级别小于或者等于客体的密级时，改主体才能写相应的客体。</li></ul><h3 id="审计功能–一种事后检查的安全机制"><a href="#审计功能–一种事后检查的安全机制" class="headerlink" title="审计功能–一种事后检查的安全机制"></a>审计功能–一种事后检查的安全机制</h3><ul><li>记录一切<strong>成功</strong>和<strong>不成功</strong>的操作<br>-AUDIT&#x2F;NOAUDIT<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[<span class="keyword">NO</span>]AUDIT <span class="operator">&lt;</span>操作名<span class="operator">&gt;</span>[,<span class="operator">&lt;</span>操作名<span class="operator">&gt;</span>]...</span><br><span class="line"><span class="keyword">ON</span> <span class="operator">&lt;</span>表名<span class="operator">&gt;</span>;</span><br></pre></td></tr></table></figure></li></ul><h3 id="数据加密"><a href="#数据加密" class="headerlink" title="数据加密"></a>数据加密</h3><ol><li>存储加密</li><li>传输加密</li></ol><h3 id="其他安全性保护"><a href="#其他安全性保护" class="headerlink" title="其他安全性保护"></a>其他安全性保护</h3><ul><li>推理控制</li><li>隐蔽信道</li><li>数据隐私保护</li></ul></div><div class="story post-story"><h2 id="数据库完整性——数据库的正确性和相容性"><a href="#数据库完整性——数据库的正确性和相容性" class="headerlink" title="数据库完整性——数据库的正确性和相容性"></a>数据库完整性——数据库的正确性和相容性</h2><hr><ol><li>实体完整性<ol><li>检查主码值是否唯一，如果不唯一则拒绝插入或修改</li><li>检查主码的各个属性是否为空，只要有一个空值就拒绝插入或修改。</li></ol></li><li>参照完整性</li></ol><table><thead><tr><th>（破坏参照完整性的）操作</th><th>违约处理</th></tr></thead><tbody><tr><td>参照表插入元组</td><td>拒绝</td></tr><tr><td>参照表修改外码值</td><td>拒绝</td></tr><tr><td>被参照表删除元组</td><td>拒绝&#x2F;级联删除&#x2F;设置为空值</td></tr><tr><td>被参照表修改主码值</td><td>拒绝&#x2F;级联删除&#x2F;设置为空值</td></tr><tr><td>3. 用户自定义的完整性</td><td></td></tr></tbody></table><pre><code>1. 属性上的约束条件——不满足则拒绝执行    - NOT NULL    - UNIQUE    - CHECK短语2. 元组上的约束条件——不满足则拒绝执行</code></pre><h3 id="完整性命令约束命名子句"><a href="#完整性命令约束命名子句" class="headerlink" title="完整性命令约束命名子句"></a>完整性命令约束命名子句</h3><ul><li>完整性约束命名子句(新建表时)<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CONSTRAINT</span> <span class="operator">&lt;</span>完整性约束条件名<span class="operator">&gt;</span> <span class="operator">&lt;</span>完整性约束条件<span class="operator">&gt;</span>;</span><br></pre></td></tr></table></figure></li><li>修改表中的完整性限制</li></ul><p>删除完整性约束</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> <span class="operator">&lt;</span>表名<span class="operator">&gt;</span></span><br><span class="line"><span class="keyword">DROP</span> <span class="keyword">CONSTRAINT</span> <span class="operator">&lt;</span>完整性约束条件名<span class="operator">&gt;</span>;</span><br></pre></td></tr></table></figure><p>增加完整性约束</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> <span class="operator">&lt;</span>表名<span class="operator">&gt;</span></span><br><span class="line"><span class="keyword">ADD</span> <span class="keyword">CONSTRAINT</span> <span class="operator">&lt;</span>完整性约束条件名<span class="operator">&gt;</span> <span class="operator">&lt;</span>完整性约束条件<span class="operator">&gt;</span>;</span><br></pre></td></tr></table></figure><h3 id="断言"><a href="#断言" class="headerlink" title="断言"></a>断言</h3><ul><li>通过声明断言来指定更具一般性的约束。可以定义涉及多个表或聚集操作的比较复杂的完整性约束，任何使断言不为真值的操作都会被拒绝执行。</li><li>创建断言语句<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> ASSERTION <span class="operator">&lt;</span>断言名<span class="operator">&gt;</span> <span class="operator">&lt;</span><span class="keyword">CHECK</span> 子句<span class="operator">&gt;</span>;</span><br></pre></td></tr></table></figure></li><li>删除断言语句<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">DROP</span> ASSERTION <span class="operator">&lt;</span>断言名<span class="operator">&gt;</span>;</span><br></pre></td></tr></table></figure></li></ul><h3 id="触发器"><a href="#触发器" class="headerlink" title="触发器"></a>触发器</h3><ul><li>定义触发器<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TRIGGER</span> <span class="operator">&lt;</span>触发器名<span class="operator">&gt;</span></span><br><span class="line">&#123;BEFORE<span class="operator">|</span>AFTER&#125; <span class="operator">&lt;</span>触发事件<span class="operator">&gt;</span> <span class="keyword">ON</span> <span class="operator">&lt;</span>表名<span class="operator">&gt;</span></span><br><span class="line"><span class="keyword">REFERENCES</span> <span class="keyword">NEW</span><span class="operator">|</span><span class="keyword">OLD</span> <span class="type">ROW</span> <span class="keyword">AS</span> <span class="operator">&lt;</span>变量<span class="operator">&gt;</span></span><br><span class="line"><span class="keyword">FOR</span> <span class="keyword">EACH</span> &#123;<span class="type">ROW</span><span class="operator">|</span>STATEMENT&#125;</span><br><span class="line">[<span class="keyword">WHEN</span> <span class="operator">&lt;</span>触发条件<span class="operator">&gt;</span>] <span class="operator">&lt;</span>触发动作体<span class="operator">&gt;</span>;</span><br></pre></td></tr></table></figure></li><li>激活触发器，<br>  多个触发器时：<ol><li>执行该表上的BEFORE触发器</li><li>激活触发器的SQL语句</li><li>执行该表上的AFTER触发器</li></ol></li><li>删除触发器<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">DROP</span> <span class="keyword">TRIGGER</span> <span class="operator">&lt;</span>触发器名<span class="operator">&gt;</span> <span class="keyword">ON</span> <span class="operator">&lt;</span>表名<span class="operator">&gt;</span>;</span><br></pre></td></tr></table></figure></li></ul></div><div class="story post-story"><h2 id="关系数据理论"><a href="#关系数据理论" class="headerlink" title="关系数据理论"></a>关系数据理论</h2><hr><h3 id="相关术语"><a href="#相关术语" class="headerlink" title="相关术语"></a>相关术语</h3><ul><li>函数依赖：R(U)是属性集U上的关系模式，X，Y是U的子集。对于R的任意一个可能关系r，r中不可能存在两个元组在X上的属性值相等，在Y上的属性值不等，称Y函数依赖于X，记作X-&gt;Y。<ul><li>若Y$\subseteqq$X，为平凡的函数依赖。</li></ul></li><li>部分函数依赖：X-&gt;Y，若对于X的每一个真子集X’，X’-&#x2F;-&gt;Y，则称Y对X完全函数依赖，记作X$\frac{F}{}$&gt;Y。<strong>否则</strong>称为部分函数依赖。</li><li>传递函数依赖：X-&gt;Y,<strong>Y-&#x2F;-&gt;X</strong>，Y-&gt;Z(Z$\subsetneqq$Y，Y$\subsetneqq$X)，称Z传递函数依赖于X，记作X$\frac{传递}{}$&gt;Z。</li><li>超码：K为R&lt;U,F&gt;中的属性或属性组合，K-&gt;U，称K为超码。</li><li>候选码：K$\frac{F}{}$&gt;U,称K为候选码。(特殊的超码)</li><li>主码：选定的一个候选码。</li><li>全码：整个属性组是码。</li><li>主属性：包含在任何一个<strong>候选码</strong>中的属性。</li><li>非主属性&#x2F;非码属性：不包含在任何候选码中的属性。</li><li>多值依赖：X，Y，Z是U的子集，且Z&#x3D;U-X-Y，若给定一对(x,z)值，有一组Y值，这组值仅仅决定于x值而与z无关。称Y多值依赖于X，记作X-&gt;-&gt;Y。</li><li>闭包：$X^{+}<em>{F}$&#x3D;{A|X-&gt;A能由F导出}，$X^{+}</em>{F}$称为属性集X关于函数依赖集F的闭包。</li><li>最小依赖集&#x2F;最小覆盖：<ol><li>任一函数依赖右部仅含一个属性。</li><li>函数依赖个数精简到最少</li><li>函数依赖的左部精简到最少</li></ol></li></ul><h3 id="范式"><a href="#范式" class="headerlink" title="范式"></a>范式</h3><ul><li>第一范式（1NF）：每一个分量都是不可分的数据项</li><li>第二范式（2NF）：1NF&amp;<strong>不</strong>存在<strong>非主属性</strong>对任一<strong>候选码</strong>的<strong>部分函数依赖</strong>。</li><li>第三范式（3NF）：2NF&amp;<strong>不</strong>存在<strong>非主属性</strong>对任一<strong>候选码</strong>的<strong>传递函数依赖</strong>。<ul><li>所有属性都是主属性的模式最高一定可以达到</li></ul></li><li>BC范式（BCNF）:每一个决定因素都包含码，消除了插入、删除的异常。满足：<ul><li>3NF</li><li>所有主属性对于任一不包含它的码也是完全函数依赖</li><li>没有任何属性完全函数依赖于非码的任何一组属性。</li><li>(全码组成的关系模式最高一定可以到达||3NF+唯一候选码||二元模式最高一定可以到达)</li></ul></li><li>4NF：属性之间不允许有<strong>非平凡且非函数依赖</strong>的多值依赖</li><li>判断范式<ol><li>求候选码<ol><li>如果有属性只在函数依赖集的左边出现，则该属性一定包含在候选码中（继续求它的闭包，如果他的闭包是属性全集，则为候选码，如果不是，则需要结合其他属性求闭包，继而判断是否是候选码）</li><li>只在函数依赖集右边出现的属性，一定不属于候选码</li><li>对于左右都出现过的属性：<br>（1）先结合只在左边出现的属性求闭包，看看是否包括所有属性，如果他的闭包是属性全集，则为候选码；<br>（2）如果没有包括所有属性，就结合其他左右都出现的求闭包，看看是否包括所有属性，如果他的闭包是属性全集，则为候选码</li><li>如果有属性不在函数依赖集中出现（外部属性），那么一定包含在候选码中（继续求它的闭包，如果他的闭包是属性全集，则为候选码，如果不是，则需要结合其他属性求闭包，继而判断是否是候选码）</li></ol></li><li>分主属性、非主属性</li><li>判断范式。</li></ol></li></ul><h3 id="规范化"><a href="#规范化" class="headerlink" title="规范化"></a>规范化</h3><p>1NF$\frac{消除非主属性对码的部分函数依赖}{}$&gt;2NF$\frac{消除非主属性对码的传递函数依赖}{}$&gt;3NF$\frac{消除主属性对码的部分和传递函数依赖}{}$&gt;BCNF$\frac{消除非平凡且非函数依赖的多值依赖}{}$&gt;4NF</p><h3 id="函数依赖的公理系统"><a href="#函数依赖的公理系统" class="headerlink" title="函数依赖的公理系统"></a>函数依赖的公理系统</h3><ul><li>推理规则——Armstrong公理系统<ul><li>自反率：<br>若Y$\subseteqq$X$\subseteqq$U，则X——&gt;Y被F所蕴含</li><li>增广率：<br>若X——&gt;Y被F所蕴含，且Z$\subseteqq$U，则XZ——&gt;YZ被F所蕴含</li><li>传递率：<br>若X——&gt;Y及Y——&gt;Z被F所蕴含，则X——&gt;Z被F所蕴含</li></ul></li></ul><h3 id="模式的分解"><a href="#模式的分解" class="headerlink" title="模式的分解"></a>模式的分解</h3><h4 id="无损连接性"><a href="#无损连接性" class="headerlink" title="无损连接性"></a>无损连接性</h4><ul><li>保证不丢失信息</li><li>判断无损连接</li></ul><h4 id="保持函数依赖性"><a href="#保持函数依赖性" class="headerlink" title="保持函数依赖性"></a>保持函数依赖性</h4><ul><li>减轻或解决各种异常情况</li><li>判断保持函数依赖：<ol><li>求投影F’&#x3D;F1∪F2∪…Fn是否包含全部函数依赖。</li><li>对于缺少的函数依赖，求左侧属性在判断F’中的闭包是否蕴含右侧。（$F’^{+}$&#x3D;&#x3D;$F^{+}$?）</li></ol></li></ul><h3 id="模式分解算法"><a href="#模式分解算法" class="headerlink" title="模式分解算法"></a>模式分解算法</h3><ul><li>保持函数依赖，最多可以达到3NF。</li><li>保持无损连接性，最多可以达到4NF。</li><li>保持函数依赖和无损连接性，最多可以达到3NF</li></ul></div><div class="story post-story"><h2 id="数据库恢复技术"><a href="#数据库恢复技术" class="headerlink" title="数据库恢复技术"></a>数据库恢复技术</h2><hr><h3 id="事务的基本概念"><a href="#事务的基本概念" class="headerlink" title="事务的基本概念"></a>事务的基本概念</h3><ul><li>事务的定义：用户定义的一个数据库操作序列，这些操作要么全做，要么全不做，是一个不可分割的工作单位。</li><li>事务通常以BEGIN TRANSACTION开始，以COMMIT（提交）或ROLLBACK（回滚）结束。</li><li>事务的ACID特性：<ul><li>原子性：事务是数据库的逻辑工作单位，事务中所包括的诸操作要么都做，要么都不做。</li><li>一致性：事务执行的结果必须是使数据库从一个一致性状态变到另一个一致性状态。</li><li>隔离性：对于并发执行而言，一个事务的执行不能被其他事务干扰。</li><li>持久性：也称永久性，一个事务一旦提交，它对数据库中数据的改变就应该是永久的。</li></ul></li></ul><h3 id="故障的种类"><a href="#故障的种类" class="headerlink" title="故障的种类"></a>故障的种类</h3><ul><li>事务内部的故障：非预期的，不能由应用程序处理的。<ul><li>常见原因：<ol><li>运算溢出</li><li>并发进程发生死锁而被选中撤销该事务</li><li>违反了某些完整性限制</li></ol></li><li>恢复操作：事务撤销（UNDO）：反向扫描日志文件，查找事务的更新操作执行逆操作</li></ul></li><li>系统故障：称为软故障，指造成系统停止运转的任何事件，使得系统要重新启动<ul><li>常见原因  <ol><li>特定类型的硬件错误</li><li>操作系统故障</li><li>DBMS代码错误</li><li>系统断电</li></ol></li><li>恢复策略<ol start="5"><li>正向扫描日志文件</li><li>发生系统故障时，事务未提交：强行撤销所有未完成的事务</li><li>发生系统故障时，事务已提交，但缓冲区的信息未完全写回到磁盘上：重做所有已提交的事务。</li></ol></li></ul></li><li>介质故障：称为硬故障，指外存故障。<ul><li>常见原因<ol><li>磁盘损坏</li><li>磁头碰撞</li><li>操作系统的某种潜在错误</li><li>瞬时强磁场干扰</li></ol></li><li>恢复策略<ol><li>装入数据库发生介质故障前某个时刻的数据副本</li><li>重做此时起的所有成功事务，将这些事务已提交的结果重新记入数据库。</li></ol></li><li>使用检查点改善恢复效率</li><li>数据库镜像</li></ul></li><li>计算机病毒<ul><li>人为故障或破坏的计算机程序，可以繁殖和传播，等同于介质故障。</li></ul></li></ul><h3 id="恢复的实现技术"><a href="#恢复的实现技术" class="headerlink" title="恢复的实现技术"></a>恢复的实现技术</h3><ul><li>基本原理：冗余——利用存储在系统其他地方的冗余数据来重建数据库中已被破坏或不正确的那部分数据。</li><li>如何建立冗余数据？数据转储和登记日志文件</li></ul><h4 id="数据转储"><a href="#数据转储" class="headerlink" title="数据转储"></a>数据转储</h4><ul><li>转储方式分类<ul><li>海量转储</li><li>增量转储</li></ul></li><li>转储状态分类<ul><li>动态转储</li><li>静态转储</li></ul></li></ul><h4 id="登记日志文件——用来记录事务对数据库的更新操作的文件"><a href="#登记日志文件——用来记录事务对数据库的更新操作的文件" class="headerlink" title="登记日志文件——用来记录事务对数据库的更新操作的文件"></a>登记日志文件——用来记录事务对数据库的更新操作的文件</h4><ul><li>登记内容（每个登记内容作为日志文件的一个日志记录）：<ul><li>各个事务开始标记</li><li>各个事务结束登记</li><li>各个事务的所有更新操作</li></ul></li><li>日志记录内容<ul><li>事务标识</li><li>操作类型</li><li>操作对象</li><li>更新前数据的旧值</li><li>更新后数据的新值</li></ul></li><li>作用：<ul><li>进行事务故障和系统故障恢复</li><li>协助后备副本对介质故障进行恢复</li></ul></li><li>登记日志文件时必须遵循两条原则：<ul><li>登记的次序严格按并发事务执行的时间次序。</li><li>必须先写日志文件，后写数据库。</li></ul></li></ul></div><div class="story post-story"><h2 id="并发控制"><a href="#并发控制" class="headerlink" title="并发控制"></a>并发控制</h2><hr><h3 id="概述-1"><a href="#概述-1" class="headerlink" title="概述"></a>概述</h3><ul><li>事务是并发控制的基本单位</li><li>并发操作带来的数据不一致性<ul><li>丢失修改</li><li>读“脏”数据</li><li>不可重复读&#x2F;幻影现象</li></ul></li><li>主要方法<ul><li>封锁</li><li>时间戳</li><li>乐观控制法</li><li>多版本控制</li></ul></li></ul><h3 id="封锁"><a href="#封锁" class="headerlink" title="封锁"></a>封锁</h3><ul><li>排他锁&#x2F;写锁（X锁）</li><li>共享锁（S锁）</li><li>封锁协议：<ul><li>一级封锁协议：修改数据之前必须加X锁，直到事务结束才释放——解决丢失修改</li><li>二级封锁协议：读数据之前必须加S锁，读完后释放——解决读脏数据</li><li>三级封锁协议：读数据之前必须加S锁，直到事务结束才释放——解决不可重复读</li></ul></li></ul><h3 id="活锁和死锁"><a href="#活锁和死锁" class="headerlink" title="活锁和死锁"></a>活锁和死锁</h3><ul><li><p>当两个（或多个）并发的事务分别等待对方释放封锁的资源，而使事务处于长期等待状态的现象称为死锁。</p></li><li><p>解决活锁的方法：先来先服务策略</p></li><li><p>解决死锁的两种方法：</p><ul><li>预防：<ul><li>一次封锁法:为了完成一个事务，一次性封锁所需要的全部表</li><li>顺序封锁法:所有的事务约定都按相同的顺序来封锁表</li></ul></li><li>诊断与解除<ul><li>超时法</li><li>事务等待图法</li></ul></li></ul></li></ul><h3 id="并发调度的可串行性——并发事务正确调度的准则"><a href="#并发调度的可串行性——并发事务正确调度的准则" class="headerlink" title="并发调度的可串行性——并发事务正确调度的准则"></a>并发调度的可串行性——并发事务正确调度的准则</h3><ul><li>冲突可串行化是可串行化的充分条件</li></ul><h3 id="两段锁协议"><a href="#两段锁协议" class="headerlink" title="两段锁协议"></a>两段锁协议</h3><ul><li>事务分为两个阶段<ol><li>扩展阶段，获得封锁</li><li>收缩阶段，释放封锁</li></ol></li><li>事务遵守两段锁协议是可串行化的充分条件</li></ul><h3 id="封锁的粒度"><a href="#封锁的粒度" class="headerlink" title="封锁的粒度"></a>封锁的粒度</h3><ul><li><p>封锁对象的大小称为<strong>封锁粒度</strong>，封锁对象可以是<strong>逻辑对象</strong>，也可以是<strong>物理对象</strong></p></li><li><p>封锁粒度越大、数据库所能封锁的数据单元就越少，并发度就越小，系统开销越小；反之，封锁粒度越小、数据库所能封锁的数据单元就越多，并发度就越大，系统开销越大</p></li><li><p>多粒度封锁</p><ul><li>显示封锁：应事务要求直接加到数据对象上的锁</li><li>隐式封锁：由于上级对象加锁而导致该数据对象加上了锁</li></ul></li></ul></div>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;数据库系统概论&quot;&gt;&lt;a href=&quot;#数据库系统概论&quot; class=&quot;headerlink&quot; title=&quot;数据库系统概论&quot;&gt;&lt;/a&gt;数据库系统概论&lt;/h1&gt;&lt;div class=&quot;story post-story&quot;&gt;&lt;h2 id=&quot;概述&quot;&gt;&lt;a href=&quot;#概</summary>
      
    
    
    
    <category term="学习笔记" scheme="http://example.com/categories/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/"/>
    
    
    <category term="数据库" scheme="http://example.com/tags/%E6%95%B0%E6%8D%AE%E5%BA%93/"/>
    
  </entry>
  
  <entry>
    <title>node.js</title>
    <link href="http://example.com/2024/10/12/node-js/"/>
    <id>http://example.com/2024/10/12/node-js/</id>
    <published>2024-10-12T13:31:48.000Z</published>
    <updated>2024-12-18T11:27:40.796Z</updated>
    
    <content type="html"><![CDATA[<h1 id="fs文件系统"><a href="#fs文件系统" class="headerlink" title="fs文件系统"></a>fs文件系统</h1><div class="story post-story"><h2 id="读取文件内容"><a href="#读取文件内容" class="headerlink" title="读取文件内容"></a>读取文件内容</h2><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> fs = <span class="built_in">require</span>(<span class="string">&quot;fs&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 异步读取</span></span><br><span class="line">fs.<span class="title function_">readFile</span>(<span class="string">&#x27;input.txt&#x27;</span>,<span class="string">&#x27;utf8&#x27;</span>, <span class="keyword">function</span> (<span class="params">err, data</span>) &#123;</span><br><span class="line">    <span class="comment">//如果读取成功，则err的值为null</span></span><br><span class="line">    <span class="comment">//如果读取失败，则err的值为错误对象，dataStr的值为undefined</span></span><br><span class="line">   <span class="keyword">if</span> (err) &#123;</span><br><span class="line">       <span class="keyword">return</span> <span class="variable language_">console</span>.<span class="title function_">error</span>(err);</span><br><span class="line">   &#125;</span><br><span class="line">   <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;异步读取: &quot;</span> + data.<span class="title function_">toString</span>());</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 同步读取</span></span><br><span class="line"><span class="keyword">var</span> data = fs.<span class="title function_">readFileSync</span>(<span class="string">&#x27;input.txt&#x27;</span>);</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;同步读取: &quot;</span> + data.<span class="title function_">toString</span>());</span><br><span class="line"></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;程序执行完毕。&quot;</span>);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">//执行结果</span></span><br><span class="line">同步读取: 文件读取实例</span><br><span class="line"></span><br><span class="line">程序执行完毕。</span><br><span class="line">异步读取: 文件读取实例</span><br></pre></td></tr></table></figure></div><div class="story post-story"><h2 id="写入文件内容"><a href="#写入文件内容" class="headerlink" title="写入文件内容"></a>写入文件内容</h2><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> fs = <span class="built_in">require</span>(<span class="string">&quot;fs&quot;</span>);</span><br><span class="line"></span><br><span class="line">fs.<span class="title function_">writeFile</span>(<span class="string">&#x27;input.txt&#x27;</span>, <span class="string">&#x27;我是通 过fs.writeFile 写入文件的内容&#x27;</span>,  <span class="keyword">function</span>(<span class="params">err</span>) &#123;</span><br><span class="line">   <span class="keyword">if</span> (err) &#123;</span><br><span class="line">       <span class="keyword">return</span> <span class="variable language_">console</span>.<span class="title function_">error</span>(err);</span><br><span class="line">   &#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure></div><div class="story post-story"><h2 id="处理路径问题"><a href="#处理路径问题" class="headerlink" title="处理路径问题"></a>处理路径问题</h2><p>__dirname表示当前文件所处目录</p><h3 id="path路径模块"><a href="#path路径模块" class="headerlink" title="path路径模块"></a>path路径模块</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> path = <span class="built_in">require</span>(<span class="string">&quot;path&quot;</span>)</span><br></pre></td></tr></table></figure><table><thead><tr><th>方法</th><th>描述</th></tr></thead><tbody><tr><td>path.join([path1][, path2][, …])</td><td>用于连接路径。</td></tr><tr><td>path.basename()</td><td>获取路径中的文件名</td></tr><tr><td>path.extname(p)</td><td>获取文件的扩展名</td></tr><tr><td>path.dirname(p)</td><td>返回路径中代表文件夹的部分</td></tr><tr><td>path.resolve([from …], to)</td><td>将 to 参数解析为绝对路径</td></tr><tr><td>path.relative(from, to)</td><td>xxxxxxxxxx import requestInstance from ‘.&#x2F;http’​export { requestInstance as http }typescript</td></tr></tbody></table><h1 id="http"><a href="#http" class="headerlink" title="http"></a>http</h1></div><div class="story post-story"><h2 id="创建服务器"><a href="#创建服务器" class="headerlink" title="创建服务器"></a>创建服务器</h2><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> http = <span class="built_in">require</span>(<span class="string">&#x27;http&#x27;</span>)</span><br><span class="line"><span class="keyword">const</span> server = http.<span class="title function_">createServer</span>()</span><br><span class="line">server.<span class="title function_">on</span>(<span class="string">&#x27;request&#x27;</span>, <span class="keyword">function</span> (<span class="params">req, res</span>) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;Someone visit our web server.&#x27;</span>)</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">server.<span class="title function_">listen</span>(<span class="number">8080</span>, <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;服务器启动了，运行在http://127.0.0.1:8080&#x27;</span>)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><table><thead><tr><th>req请求对象属性</th><th>描述</th></tr></thead><tbody><tr><td>req.url</td><td>客户端请求的url地址</td></tr><tr><td>req.method</td><td>客户端请求方式</td></tr><tr><td>req.session</td><td>访问和使用session对象，需要配置express-session中间件</td></tr><tr><td>req.session.destroy()</td><td>清空session对象</td></tr></tbody></table><table><thead><tr><th>res响应对象属性</th><th>描述</th></tr></thead><tbody><tr><td>res.end()</td><td>向客户端响应内容</td></tr><tr><td>res.writeHead(200, { “Content-Type”: “text&#x2F;html; charset&#x3D;utf-8” })</td><td>写入响应头</td></tr><tr><td>res.setHeader(“Content-Type”,”text&#x2F;html; charset&#x3D;utf-8”)</td><td>设置响应头的内容类型，解决中文乱码</td></tr></tbody></table><h1 id="模块化"><a href="#模块化" class="headerlink" title="模块化"></a>模块化</h1><h3 id="模块作用域"><a href="#模块作用域" class="headerlink" title="模块作用域"></a>模块作用域</h3><p>自定义模块中定义的方法、变量等成员，只能在当前模块内被访问，这种模块级别的访问限制，叫做模块作用域。</p><h3 id="module对象"><a href="#module对象" class="headerlink" title="module对象"></a>module对象</h3><p>在每一个.js自定义模块中都有一个module对象，它里面存储了和当前模块有关的信息</p><ul><li>module.exports可以将模块内的成员共享出去，供外界使用。外界用require()方法导入自定义模块时，得到的就是module.exports所指向的对象（也可写成exports）</li></ul><h1 id="npm命令"><a href="#npm命令" class="headerlink" title="npm命令"></a>npm命令</h1><ul><li>npm init -y：新建包管理配置文件</li><li>npm uninstall：卸载包</li><li>npm install -D：安装包到开发环境中，这些包只在项目开发环境中用到，如sass,记录在devDependencies节点中</li><li>npm install：安装到开发和生产环境中，记录在dependencies节点中</li><li>npm install -g：安装为全局包</li></ul><h1 id="Express"><a href="#Express" class="headerlink" title="Express"></a>Express</h1><p>封装的http模块</p><h3 id="安装"><a href="#安装" class="headerlink" title="安装"></a>安装</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm i express</span><br></pre></td></tr></table></figure><h3 id="创建基本的Web服务器"><a href="#创建基本的Web服务器" class="headerlink" title="创建基本的Web服务器"></a>创建基本的Web服务器</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//1.导入 express</span></span><br><span class="line"><span class="keyword">const</span> express = <span class="built_in">require</span>(<span class="string">&#x27;express&#x27;</span>)</span><br><span class="line"><span class="comment">//2.创建 web 服务器</span></span><br><span class="line"><span class="keyword">const</span> app = <span class="title function_">express</span>()</span><br><span class="line">app.<span class="title function_">get</span>(<span class="string">&#x27;/user&#x27;</span>, <span class="function">(<span class="params">req, res</span>) =&gt;</span> &#123;</span><br><span class="line">    res.<span class="title function_">send</span>(&#123; <span class="attr">name</span>: <span class="string">&#x27;hzx&#x27;</span>, <span class="attr">age</span>: <span class="number">20</span>, <span class="attr">gender</span>: <span class="string">&#x27;男&#x27;</span> &#125;)</span><br><span class="line">&#125;)</span><br><span class="line">app.<span class="title function_">post</span>(<span class="string">&#x27;/user&#x27;</span>, <span class="function">(<span class="params">req, res</span>) =&gt;</span> &#123;</span><br><span class="line">    res.<span class="title function_">send</span>(<span class="string">&#x27;请求成功&#x27;</span>)</span><br><span class="line">&#125;)</span><br><span class="line"><span class="comment">//3. 启动 web 服务器</span></span><br><span class="line">app.<span class="title function_">listen</span>(<span class="number">80</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;express server running at http://127.0.0.1&#x27;</span>)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><h3 id="获取请求参数"><a href="#获取请求参数" class="headerlink" title="获取请求参数"></a>获取请求参数</h3><p>req.query     通过?匹配到的参数</p><p>req.params    通过:匹配到的动态参数</p><p>req.body 请求体数据，需要调用express.json()和express.urlencoded({extended:false})中间件</p><h3 id="托管静态资源"><a href="#托管静态资源" class="headerlink" title="托管静态资源"></a>托管静态资源</h3><p>app.use(express.static(‘public’))</p><p>如果要托管多个静态资源目录，多次调用express.static()函数，访问静态资源函数时，根据目录的添加顺序查找所需的文件</p><p>挂载路径前缀：app.use(“&#x2F;public”,express.static(‘public’))</p><h1 id="nodemon"><a href="#nodemon" class="headerlink" title="nodemon"></a>nodemon</h1><p>nodemon能够监听项目文件的变动，当代码被修改后，nodemon会自动帮我们重启项目。</p><h3 id="安装-1"><a href="#安装-1" class="headerlink" title="安装"></a>安装</h3><p>npm install -g nodemon</p><h3 id="使用"><a href="#使用" class="headerlink" title="使用"></a>使用</h3><p>nodemon test.js</p><h1 id="路由"><a href="#路由" class="headerlink" title="路由"></a>路由</h1><p>Express中的路由分3部分组成，分别是请求的类型、请求的URL地址、处理函数</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">app.METHOD(PATH,HANDLER(req,res))</span><br></pre></td></tr></table></figure><h3 id="模块化路由"><a href="#模块化路由" class="headerlink" title="模块化路由"></a>模块化路由</h3><p>为了方便对路由进行模块化的管理，推荐将路由抽离为单独的模块</p><ol><li>创建路由模块对应的.js文件</li><li>调用express.Router()函数创建路由对象</li><li>向路由对象上挂载具体的路由</li><li>module.exports向外共享路由对象</li><li>使用app.use()函数注册路由模块</li></ol><h3 id="示例代码"><a href="#示例代码" class="headerlink" title="示例代码"></a>示例代码</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//router.js</span></span><br><span class="line"><span class="keyword">const</span> express = <span class="built_in">require</span>(<span class="string">&#x27;express&#x27;</span>)</span><br><span class="line"><span class="keyword">const</span> router = express.<span class="title class_">Router</span>()</span><br><span class="line">router.<span class="title function_">get</span>(<span class="string">&#x27;/user/list&#x27;</span>, <span class="function">(<span class="params">req, res</span>) =&gt;</span> &#123;</span><br><span class="line">    res.<span class="title function_">send</span>(<span class="string">&#x27;Get user list.&#x27;</span>)</span><br><span class="line">&#125;)</span><br><span class="line">router.<span class="title function_">post</span>(<span class="string">&#x27;/user/add&#x27;</span>, <span class="function">(<span class="params">req, res</span>) =&gt;</span> &#123;</span><br><span class="line">    res.<span class="title function_">send</span>(<span class="string">&#x27;Add new user.&#x27;</span>)</span><br><span class="line">&#125;)</span><br><span class="line"><span class="variable language_">module</span>.<span class="property">exports</span> = router</span><br></pre></td></tr></table></figure><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//index.js</span></span><br><span class="line"><span class="comment">//1.导入 express</span></span><br><span class="line"><span class="keyword">const</span> express = <span class="built_in">require</span>(<span class="string">&#x27;express&#x27;</span>)</span><br><span class="line"><span class="comment">//2.创建 web 服务器</span></span><br><span class="line"><span class="keyword">const</span> app = <span class="title function_">express</span>()</span><br><span class="line"><span class="comment">//注册路由模块</span></span><br><span class="line"><span class="keyword">const</span> router = <span class="built_in">require</span>(<span class="string">&#x27;./router&#x27;</span>)</span><br><span class="line">app.<span class="title function_">use</span>(router)</span><br><span class="line"><span class="comment">//3. 启动 web 服务器</span></span><br><span class="line">app.<span class="title function_">listen</span>(<span class="number">80</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;express server running at http://127.0.0.1&#x27;</span>)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><h1 id="中间件"><a href="#中间件" class="headerlink" title="中间件"></a>中间件</h1><p>作用：对请求进行预处理</p><h3 id="中间件的格式"><a href="#中间件的格式" class="headerlink" title="中间件的格式"></a>中间件的格式</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">app.<span class="title function_">get</span>(<span class="string">&#x27;/&#x27;</span>,<span class="keyword">function</span>(<span class="params">req,res,next</span>)&#123;</span><br><span class="line"><span class="title function_">next</span>()<span class="comment">//把流转关系转交给下一个中间件或者路由</span></span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><h3 id="全局生效的中间件"><a href="#全局生效的中间件" class="headerlink" title="全局生效的中间件"></a>全局生效的中间件</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> app = <span class="title function_">express</span>()</span><br><span class="line"><span class="keyword">const</span> mw = <span class="keyword">function</span> (<span class="params">req,res,next</span>)&#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;这是最简单的中间件函数&#x27;</span>)</span><br><span class="line">    <span class="title function_">next</span>()</span><br><span class="line">&#125;</span><br><span class="line">app.<span class="title function_">use</span>(mw)</span><br><span class="line">app.<span class="title function_">get</span>(<span class="string">&#x27;/&#x27;</span>,<span class="function">(<span class="params">req,res</span>)=&gt;</span>&#123;</span><br><span class="line">    res.<span class="title function_">send</span>(<span class="string">&#x27;Home Page.&#x27;</span>)</span><br><span class="line">&#125;)</span><br><span class="line">app.<span class="title function_">get</span>(<span class="string">&#x27;/user&#x27;</span>,<span class="function">(<span class="params">req,res</span>)=&gt;</span>&#123;</span><br><span class="line">    res.<span class="title function_">send</span>(<span class="string">&quot;User Page&quot;</span>)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><h3 id="局部生效的中间件"><a href="#局部生效的中间件" class="headerlink" title="局部生效的中间件"></a>局部生效的中间件</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> app = <span class="title function_">express</span>()</span><br><span class="line"><span class="keyword">const</span> mw = <span class="keyword">function</span> (<span class="params">req,res,next</span>)&#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;这是最简单的中间件函数&#x27;</span>)</span><br><span class="line">    <span class="title function_">next</span>()</span><br><span class="line">&#125;</span><br><span class="line">app.<span class="title function_">get</span>(<span class="string">&#x27;/&#x27;</span>,mw,<span class="function">(<span class="params">req,res</span>)=&gt;</span>&#123;</span><br><span class="line">    res.<span class="title function_">send</span>(<span class="string">&#x27;Home Page.&#x27;</span>)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><h3 id="多个局部生效的中间件"><a href="#多个局部生效的中间件" class="headerlink" title="多个局部生效的中间件"></a>多个局部生效的中间件</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">app.<span class="title function_">get</span>(<span class="string">&#x27;/&#x27;</span>,mw1,mw2,<span class="function">(<span class="params">req,res</span>)=&gt;</span>&#123;</span><br><span class="line">    res.<span class="title function_">send</span>(<span class="string">&#x27;Home Page.&#x27;</span>)</span><br><span class="line">&#125;)</span><br><span class="line">app.<span class="title function_">get</span>(<span class="string">&#x27;/&#x27;</span>,[mw1,mw2],<span class="function">(<span class="params">req,res</span>)=&gt;</span>&#123;</span><br><span class="line">    res.<span class="title function_">send</span>(<span class="string">&#x27;Home Page.&#x27;</span>)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><h3 id="注意事项"><a href="#注意事项" class="headerlink" title="注意事项"></a>注意事项</h3><ul><li>在路由之前注册中间件</li><li>客户端发送的请求，可以连续调用多个中间件进行处理</li><li>执行完中间件后，要调用next()函数</li><li>调用next()函数后，不要再写业务逻辑</li><li>多个中间件共享req、res对象</li></ul><h3 id="中间件的分类"><a href="#中间件的分类" class="headerlink" title="中间件的分类"></a>中间件的分类</h3><ol><li><p>应用级别：app.use(),app.get(),app.post()</p></li><li><p>路由级别：绑定在express.Router()实例上</p></li><li><p>错误级别：function处理函数中必须有4个形参，分别是(err,req,res,next)。<strong>必须注册在所有路由之后！</strong></p></li><li><p>Express内置</p><ol><li><p>express.static快速托管静态资源的内置中间件</p></li><li><p>express.json解析JSON格式的请求体数据</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">app.<span class="title function_">use</span>(express.<span class="title function_">json</span>())</span><br><span class="line">app.<span class="title function_">post</span>(<span class="string">&#x27;/user&#x27;</span>, <span class="keyword">function</span> (<span class="params">req, res</span>) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(req.<span class="property">body</span>)</span><br><span class="line">    res.<span class="title function_">send</span>(<span class="string">&#x27;ok&#x27;</span>)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure></li><li><p>express.urlencoded({extended:false})解析URL-encoded格式的请求体数据</p></li></ol></li><li><p>第三方</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//定义中间件</span></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">bodyParser</span> = (<span class="params">req, res, next</span>) =&gt; &#123;</span><br><span class="line">    <span class="keyword">let</span> str = <span class="string">&#x27;&#x27;</span></span><br><span class="line">    req.<span class="title function_">on</span>(<span class="string">&#x27;data&#x27;</span>, <span class="function">(<span class="params">chunk</span>) =&gt;</span> &#123;</span><br><span class="line">        str += chunk</span><br><span class="line">    &#125;)</span><br><span class="line">    req.<span class="title function_">on</span>(<span class="string">&#x27;end&#x27;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">        req.<span class="property">body</span> = querystring.<span class="title function_">parse</span>(str)</span><br><span class="line">    &#125;)</span><br><span class="line">    <span class="title function_">next</span>()</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable language_">module</span>.<span class="property">exports</span> = bodyParser</span><br><span class="line">------------------------------------</span><br><span class="line"><span class="comment">//使用中间件</span></span><br><span class="line"><span class="keyword">const</span> bodyParser = <span class="built_in">require</span>(<span class="string">&#x27;./bodyParser&#x27;</span>)</span><br><span class="line">app.<span class="title function_">use</span>(bodyParser)</span><br></pre></td></tr></table></figure></li></ol><h1 id="基于CORS解决跨域问题"><a href="#基于CORS解决跨域问题" class="headerlink" title="基于CORS解决跨域问题"></a>基于CORS解决跨域问题</h1><h3 id="安装-2"><a href="#安装-2" class="headerlink" title="安装"></a>安装</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install cors</span><br></pre></td></tr></table></figure><h3 id="导入并配置"><a href="#导入并配置" class="headerlink" title="导入并配置"></a>导入并配置</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> cors = <span class="built_in">require</span>(<span class="string">&#x27;cors&#x27;</span>)</span><br><span class="line">app.<span class="title function_">use</span>(<span class="title function_">cors</span>())</span><br></pre></td></tr></table></figure><p><strong>注意：</strong>先配置cors（跨域资源共享）再配置路由</p><p><strong>原理：</strong>CORS由一系列HTTP响应头组成，这些响应头决定浏览器是否阻止前端JS代码跨域获取资源。浏览器的同源安全策略（协议、ip地址、端口号必须相同）默认会阻止网页”跨域“获取资源。但是如果接口服务器配置了CORS相关的HTTP响应头，就可以解除浏览器端的跨域访问限制。</p><table><thead><tr><th>CORS响应头部</th><th>描述</th></tr></thead><tbody><tr><td>res.setHeader(‘Access-Control-Allow-Origin’,’*’)</td><td>设置允许访问该资源的外域URL</td></tr><tr><td>res.setHeader(‘Access-Control-Allow-Headers’,’X-Custom-Header’)</td><td>对额外的请求头进行声明</td></tr><tr><td>res.setHeader(‘Access-Control-Allow-Methods’,’*’)</td><td>设置实际请求所允许使用的HTTP方法</td></tr></tbody></table><h3 id="预检请求"><a href="#预检请求" class="headerlink" title="预检请求"></a>预检请求</h3><p>只要符合以下任何条件之一，都需要进行预检请求：</p><ol><li>请求方式为GET、POST、HEAD之外的请求Method类型</li><li>请求头中包含自定义头部字段</li><li>向服务器发送了application&#x2F;json格式的数据</li></ol><p>在浏览器与服务器正式通信之前，浏览器会先发送OPTION请求进行预检，以获知服务器是否允许该实际请求，所以这一次的OPTION请求称为“预检请求”。服务器成功响应预检请求后，才会发送真正的请求，并携带真实数据。</p><h3 id="JSONP接口"><a href="#JSONP接口" class="headerlink" title="JSONP接口"></a>JSONP接口</h3><p>浏览器通过<code>&lt;script&gt;</code>标签的src属性，请求服务器上的数据，同时，服务器返回一个函数的调用。这种请求数据的方式叫做JSONP</p><p>JSONP不属于真正的Ajax请求，没有使用XMLHttpRequest这个对象。JSONP仅支持GET请求，不支持POST、PUT、DELETE请求。</p><p>JSONP接口要声明在CORS接口之前</p><h1 id="操作MySQL"><a href="#操作MySQL" class="headerlink" title="操作MySQL"></a>操作MySQL</h1><ol><li>安装mysql2模块</li></ol>   <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm i mysql2</span><br></pre></td></tr></table></figure><ol start="2"><li><p>配置mysql模块</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> mysql = <span class="built_in">require</span>(<span class="string">&#x27;mysql2&#x27;</span>)</span><br><span class="line"><span class="keyword">const</span> db = mysql.<span class="title function_">createPool</span>(&#123;</span><br><span class="line">    <span class="attr">host</span>: <span class="string">&#x27;127.0.0.1&#x27;</span>,</span><br><span class="line">    <span class="attr">user</span>: <span class="string">&#x27;root&#x27;</span>,</span><br><span class="line">    <span class="attr">password</span>: <span class="string">&#x27;123456&#x27;</span>,</span><br><span class="line">    <span class="attr">database</span>: <span class="string">&#x27;my_db_01&#x27;</span></span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure></li><li><p>测试mysql模块是否正常工作</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">db.query(&#x27;SELECT 1&#x27;,(err,results)=&gt;&#123;</span><br><span class="line">if(err) return console.log(err.message)</span><br><span class="line">console.log(results)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure></li></ol><h3 id="增删改查"><a href="#增删改查" class="headerlink" title="增删改查"></a>增删改查</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> user = &#123; <span class="attr">username</span>:<span class="string">&#x27;spider-man&#x27;</span>, <span class="attr">password</span>:<span class="string">&#x27;pcc123&#x27;</span>&#125;</span><br><span class="line"><span class="keyword">const</span> sqlStr = <span class="string">&#x27;insert into users (username,password) values (?,?)&#x27;</span></span><br><span class="line">db.<span class="title function_">query</span>(sqlStr,[user.<span class="property">username</span>,user.<span class="property">password</span>],<span class="function">(<span class="params">err,results</span>)=&gt;</span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(err) <span class="keyword">return</span> <span class="variable language_">console</span>.<span class="title function_">log</span>(err.<span class="property">message</span>)</span><br><span class="line">    <span class="comment">//insert into 的返回结果为对象,select 的结果为数组</span></span><br><span class="line">    <span class="keyword">if</span>(results.<span class="property">affectedRows</span> === <span class="number">1</span>) <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;数据插入成功！&#x27;</span>)</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">//若对象的属性值与数据表的字段一一对应</span></span><br><span class="line"><span class="keyword">const</span> sqlStr = <span class="string">&#x27;insert into users set ?&#x27;</span></span><br><span class="line">db.<span class="title function_">query</span>(sqlStr, user, <span class="function">(<span class="params">err, results</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (err) <span class="keyword">return</span> <span class="variable language_">console</span>.<span class="title function_">log</span>(err.<span class="property">message</span>)</span><br><span class="line">    <span class="keyword">if</span> (results.<span class="property">affectedRows</span> === <span class="number">1</span>) <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;数据插入成功！&#x27;</span>)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> user = &#123; <span class="attr">id</span>: <span class="number">5</span>, <span class="attr">username</span>: <span class="string">&#x27;aaa&#x27;</span>, <span class="attr">password</span>: <span class="string">&#x27;000123&#x27;</span> &#125;</span><br><span class="line"><span class="keyword">const</span> sqlStr = <span class="string">&#x27;update users set username=?,password=? where id=?&#x27;</span></span><br><span class="line">db.<span class="title function_">query</span>(sqlStr, [user.<span class="property">username</span>, user.<span class="property">password</span>, user.<span class="property">id</span>], <span class="function">(<span class="params">err, results</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (err) <span class="keyword">return</span> <span class="variable language_">console</span>.<span class="title function_">log</span>(err.<span class="property">message</span>)</span><br><span class="line">    <span class="comment">//update 的返回结果为对象</span></span><br><span class="line">    <span class="keyword">if</span> (results.<span class="property">affectedRows</span> === <span class="number">1</span>) <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;数据修改成功！&#x27;</span>)</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">//若对象的属性值与数据表的字段一一对应</span></span><br><span class="line"><span class="keyword">const</span> sqlStr = <span class="string">&#x27;update users set ? where id=?&#x27;</span></span><br><span class="line">db.<span class="title function_">query</span>(sqlStr, [user, user.<span class="property">id</span>], <span class="function">(<span class="params">err, results</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (err) <span class="keyword">return</span> <span class="variable language_">console</span>.<span class="title function_">log</span>(err.<span class="property">message</span>)</span><br><span class="line">    <span class="comment">//update 的返回结果为对象</span></span><br><span class="line">    <span class="keyword">if</span> (results.<span class="property">affectedRows</span> === <span class="number">1</span>) <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;数据修改成功！&#x27;</span>)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> sqlStr = <span class="string">&#x27;delete from users where id=?&#x27;</span></span><br><span class="line">db.<span class="title function_">query</span>(sqlStr, <span class="number">5</span>, <span class="function">(<span class="params">err, results</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (err) <span class="keyword">return</span> <span class="variable language_">console</span>.<span class="title function_">log</span>(err.<span class="property">message</span>)</span><br><span class="line">    <span class="comment">//update 的返回结果为对象</span></span><br><span class="line">    <span class="keyword">if</span> (results.<span class="property">affectedRows</span> === <span class="number">1</span>) <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;数据删除成功！&#x27;</span>)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><h1 id="前后端的身份认证"><a href="#前后端的身份认证" class="headerlink" title="前后端的身份认证"></a>前后端的身份认证</h1></div><div class="story post-story"><h2 id="Session认证机制"><a href="#Session认证机制" class="headerlink" title="Session认证机制"></a>Session认证机制</h2><h3 id="http的无状态性"><a href="#http的无状态性" class="headerlink" title="http的无状态性"></a>http的无状态性</h3><p>客户端的每次HTTP请求都是独立的，服务器不会主动保留每次HTTP请求的状态</p><h3 id="突破http的无状态性"><a href="#突破http的无状态性" class="headerlink" title="突破http的无状态性"></a>突破http的无状态性</h3><p>设置cookie</p><h3 id="Cookie"><a href="#Cookie" class="headerlink" title="Cookie"></a>Cookie</h3><p>Cookie是存储在用户浏览器中一段不超过4KB的字符串。它由一个名称、一个值和其他几个用于控制Cookie有效期、安全性、使用范围的可选属性组成。</p><p>客户端第一次请求服务器时，服务器通过响应头的形式，向客户端发送一个身份认证的Cookie。当客户端每次请求服务器时，浏览器自动将身份认证相关的Cookie，通过请求头的形式发送给服务器，服务器即可验明客户端的身份。</p><h3 id="使用-1"><a href="#使用-1" class="headerlink" title="使用"></a>使用</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install express-session</span><br></pre></td></tr></table></figure><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> express = <span class="built_in">require</span>(<span class="string">&#x27;express&#x27;</span>)</span><br><span class="line"><span class="keyword">const</span> session = <span class="built_in">require</span>(<span class="string">&#x27;express-session&#x27;</span>)</span><br><span class="line"><span class="keyword">const</span> app = <span class="title function_">express</span>()</span><br><span class="line">app.<span class="title function_">use</span>(<span class="title function_">session</span>(&#123;</span><br><span class="line">    <span class="attr">secret</span>: <span class="string">&#x27;keyboard cat&#x27;</span>,<span class="comment">//可以为任意字符串</span></span><br><span class="line">    <span class="attr">resave</span>: <span class="literal">false</span>,</span><br><span class="line">    <span class="attr">saveUninitialized</span>: <span class="literal">true</span></span><br><span class="line">&#125;))</span><br></pre></td></tr></table></figure></div><div class="story post-story"><h2 id="JWT认证机制"><a href="#JWT认证机制" class="headerlink" title="JWT认证机制"></a>JWT认证机制</h2><p>session不支持跨域访问，当前端请求后端接口不跨域时，推荐使用session。当前端请求后端接口跨域时，推荐使用JWT（JSON Web Token)</p><h3 id="JWT组成成分"><a href="#JWT组成成分" class="headerlink" title="JWT组成成分"></a>JWT组成成分</h3><p>Header.Payload.Signature</p><ul><li>Payload是真正的用户信息，是用户信息经过加密后生成的字符串</li><li>Header和Signature是安全性相关的部分，只是为了保证Token的安全性</li></ul><h3 id="JWT使用方式"><a href="#JWT使用方式" class="headerlink" title="JWT使用方式"></a>JWT使用方式</h3><p>客户端收到服务器返回的JWT后，通常将它存储在localStorage和sessionStorage中</p><p>客户端把JWT放在HTTP请求头的Authorization字段中，此后每次通信都要带上这个JWT的字符串，格式如下</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Authorization: Bear &lt;token&gt;</span><br></pre></td></tr></table></figure></div><div class="story post-story"><h2 id="安装及使用"><a href="#安装及使用" class="headerlink" title="安装及使用"></a>安装及使用</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install jsonwebtoken express-jwt</span><br></pre></td></tr></table></figure><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 1.导入用于生成JWT字符串的包</span></span><br><span class="line"><span class="keyword">const</span> jwt = <span class="built_in">require</span>(<span class="string">&#x27;jsonwebtoken&#x27;</span>)</span><br><span class="line"><span class="comment">// 2.导入将JWT字符串还原成JSON对象的包</span></span><br><span class="line"><span class="keyword">const</span> &#123;expressjwt&#125; = <span class="built_in">require</span>(<span class="string">&#x27;express-jwt&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">//错误级别的中间件</span></span><br><span class="line">app.<span class="title function_">use</span>(<span class="function">(<span class="params">err, req, res, next</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="comment">//token解析失败</span></span><br><span class="line">    <span class="keyword">if</span> (err.<span class="property">name</span> === <span class="string">&quot;UnauthorizedError&quot;</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> res.<span class="title function_">send</span>(&#123;</span><br><span class="line">            <span class="attr">status</span>: <span class="number">401</span>,</span><br><span class="line">            <span class="attr">message</span>: <span class="string">&quot;无效的token&quot;</span>,</span><br><span class="line">        &#125;)</span><br><span class="line">    &#125;</span><br><span class="line">    res.<span class="title function_">send</span>(&#123;</span><br><span class="line">        <span class="attr">status</span>: <span class="number">500</span>,</span><br><span class="line">        <span class="attr">message</span>: <span class="string">&quot;服务端错误&quot;</span>,</span><br><span class="line">    &#125;)</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment">//.unless(&#123;&#125;)用来指定哪一些接口不需要访问权限，以下匹配/api/开头的路径</span></span><br><span class="line"><span class="keyword">const</span> secretKey = <span class="string">&#x27;Sherlock Holmes ^_^&#x27;</span></span><br><span class="line">app.<span class="title function_">use</span>(<span class="title function_">expressjwt</span>(&#123;<span class="attr">secret</span>:secretKey,<span class="attr">algorithms</span>:[<span class="string">&#x27;HS256&#x27;</span>]&#125;).<span class="title function_">unless</span>(&#123;<span class="attr">path</span>:[<span class="regexp">/^\/api\//</span>]&#125;))</span><br></pre></td></tr></table></figure><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//登录获取token</span></span><br><span class="line">app.<span class="title function_">post</span>(<span class="string">&#x27;/api/login&#x27;</span>,<span class="keyword">function</span>(<span class="params">req,res</span>)&#123;</span><br><span class="line">    res.<span class="title function_">send</span>(&#123;</span><br><span class="line">        <span class="attr">status</span>:<span class="number">200</span>,</span><br><span class="line">        <span class="attr">message</span>:<span class="string">&#x27;登录成功！&#x27;</span>,</span><br><span class="line">        <span class="comment">//参数1：用户的信息对象，参数2：加密的密钥，参数3：配置对象：可以配置当前token的有效期</span></span><br><span class="line">        <span class="attr">token</span>:jwt.<span class="title function_">sign</span>(&#123;<span class="attr">username</span>:userinfo.<span class="property">username</span>&#125;,secretKey,&#123;<span class="attr">expiresIn</span>:<span class="string">&#x27;30s&#x27;</span>&#125;)</span><br><span class="line">    &#125;)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">app.<span class="title function_">get</span>(<span class="string">&#x27;/admin/getinfo&#x27;</span>, <span class="keyword">function</span> (<span class="params">req, res</span>) &#123;</span><br><span class="line">    res.<span class="title function_">send</span>(&#123;</span><br><span class="line">        <span class="attr">status</span>: <span class="number">200</span>,</span><br><span class="line">        <span class="attr">message</span>: <span class="string">&quot;获取用户信息成功!&quot;</span>,</span><br><span class="line">        <span class="attr">data</span>: req.<span class="property">auth</span></span><br><span class="line">    &#125;)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><h1 id="密码加密"><a href="#密码加密" class="headerlink" title="密码加密"></a>密码加密</h1><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm i bcryptjs</span><br></pre></td></tr></table></figure><p>加密存储密码：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">var bcrypt = require(&#x27;bcryptjs&#x27;);</span><br><span class="line">//生成随机盐</span><br><span class="line">var salt = bcrypt.genSaltSync(10);</span><br><span class="line">//生成加密密码</span><br><span class="line">var hash = bcrypt.hashSync(&quot;B4c0/\/&quot;, salt);</span><br><span class="line">// 存入数据库</span><br></pre></td></tr></table></figure><p>检测密码：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">// 从数据库中获取加密密码</span><br><span class="line">bcrypt.compareSync(&quot;B4c0/\/&quot;, hash); // true</span><br><span class="line">bcrypt.compareSync(&quot;not_bacon&quot;, hash); // false</span><br></pre></td></tr></table></figure><p>自动生成随机盐和哈希值:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">// bcrypt.hashSync(明文密码，随机盐的长度)</span><br><span class="line">var hash = bcrypt.hashSync(&#x27;bacon&#x27;, 8);</span><br></pre></td></tr></table></figure></div>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;fs文件系统&quot;&gt;&lt;a href=&quot;#fs文件系统&quot; class=&quot;headerlink&quot; title=&quot;fs文件系统&quot;&gt;&lt;/a&gt;fs文件系统&lt;/h1&gt;&lt;div class=&quot;story post-story&quot;&gt;&lt;h2 id=&quot;读取文件内容&quot;&gt;&lt;a href=&quot;#读</summary>
      
    
    
    
    <category term="学习笔记" scheme="http://example.com/categories/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/"/>
    
    
    <category term="node.js" scheme="http://example.com/tags/node-js/"/>
    
  </entry>
  
  <entry>
    <title>设计模式</title>
    <link href="http://example.com/2024/10/12/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/"/>
    <id>http://example.com/2024/10/12/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/</id>
    <published>2024-10-11T16:00:44.000Z</published>
    <updated>2024-12-21T03:15:22.704Z</updated>
    
    <content type="html"><![CDATA[<h1 id="设计模式的分类"><a href="#设计模式的分类" class="headerlink" title="设计模式的分类"></a>设计模式的分类</h1><table><thead><tr><th align="left">模式 &amp; 描述</th><th align="left">包括</th></tr></thead><tbody><tr><td align="left"><strong>创建型模式</strong> 这些设计模式提供了一种在创建对象的同时隐藏创建逻辑的方式，而不是使用 new 运算符直接实例化对象。这使得程序在判断针对某个给定实例需要创建哪些对象时更加灵活。</td><td align="left">工厂模式（Factory Pattern）抽象工厂模式（Abstract Factory Pattern）单例模式（Singleton Pattern）建造者模式（Builder Pattern）原型模式（Prototype Pattern）</td></tr><tr><td align="left"><strong>结构型模式</strong> 这些模式关注对象之间的组合和关系，旨在解决如何构建灵活且可复用的类和对象结构。</td><td align="left">适配器模式（Adapter Pattern）桥接模式（Bridge Pattern）过滤器模式（Filter、Criteria Pattern）组合模式（Composite Pattern）装饰器模式（Decorator Pattern）外观模式（Facade Pattern）享元模式（Flyweight Pattern）代理模式（Proxy Pattern）</td></tr><tr><td align="left"><strong>行为型模式</strong> 这些模式关注对象之间的通信和交互，旨在解决对象之间的责任分配和算法的封装。</td><td align="left">责任链模式（Chain of Responsibility Pattern）命令模式（Command Pattern）解释器模式（Interpreter Pattern）迭代器模式（Iterator Pattern）中介者模式（Mediator Pattern）备忘录模式（Memento Pattern）观察者模式（Observer Pattern）状态模式（State Pattern）空对象模式（Null Object Pattern）策略模式（Strategy Pattern）模板模式（Template Pattern）访问者模式（Visitor Pattern）</td></tr></tbody></table><div class="story post-story"><h2 id="设计模式"><a href="#设计模式" class="headerlink" title="设计模式"></a>设计模式</h2><h3 id="工厂模式"><a href="#工厂模式" class="headerlink" title="工厂模式"></a>工厂模式</h3><h4 id="表现形式"><a href="#表现形式" class="headerlink" title="表现形式"></a>表现形式</h4><p>调用工厂函数返回新对象</p><h4 id="使用场景"><a href="#使用场景" class="headerlink" title="使用场景"></a>使用场景</h4><ol><li>Vue3-createApp：将全局改变Vue实例的行为，移到Vue实例上</li><li>axios-create：基于自定义配置新建实例</li></ol><h3 id="单例模式"><a href="#单例模式" class="headerlink" title="单例模式"></a>单例模式</h3><h4 id="表现形式-1"><a href="#表现形式-1" class="headerlink" title="表现形式"></a>表现形式</h4><p>整个系统只有一个单例对象</p><h4 id="使用场景-1"><a href="#使用场景-1" class="headerlink" title="使用场景"></a>使用场景</h4><p>vant中的toast和notify组件</p><p>vue中的use方法</p><h4 id="观察者模式"><a href="#观察者模式" class="headerlink" title="观察者模式"></a>观察者模式</h4><h4 id="表现形式-2"><a href="#表现形式-2" class="headerlink" title="表现形式"></a>表现形式</h4><p>在对象之间定义一个一对多的依赖，当一个对象状态改变的时候，所有依赖的对象都会自动收到通知</p><h4 id="使用场景-2"><a href="#使用场景-2" class="headerlink" title="使用场景"></a>使用场景</h4><p>addEventListener</p><p>vue中的watch</p><p>react中的useEffect</p><h3 id="发布订阅模式"><a href="#发布订阅模式" class="headerlink" title="发布订阅模式"></a>发布订阅模式</h3><h4 id="表现形式-3"><a href="#表现形式-3" class="headerlink" title="表现形式"></a>表现形式</h4><p>与观察者模式相似，有中间商进行发布订阅</p><h4 id="使用场景-3"><a href="#使用场景-3" class="headerlink" title="使用场景"></a>使用场景</h4><p>pubsub.js</p><p>vue的provide与inject</p><h3 id="原型模式"><a href="#原型模式" class="headerlink" title="原型模式"></a>原型模式</h3><h4 id="表现形式-4"><a href="#表现形式-4" class="headerlink" title="表现形式"></a>表现形式</h4><p>复制一个已经存在的实例来返回新的实例，而不是新建实例</p><h4 id="使用场景-4"><a href="#使用场景-4" class="headerlink" title="使用场景"></a>使用场景</h4><p>Object.create()</p><p>vue的数组方法重写</p><h3 id="代理模式"><a href="#代理模式" class="headerlink" title="代理模式"></a>代理模式</h3><h4 id="表现形式-5"><a href="#表现形式-5" class="headerlink" title="表现形式"></a>表现形式</h4><p>为一个对象提供一个代用品或占位符，以便控制对它的访问</p><h4 id="使用场景-5"><a href="#使用场景-5" class="headerlink" title="使用场景"></a>使用场景</h4><p>缓存代理：第一次查询的数据通过接口获取，重复查询通过缓存获取</p><h3 id="迭代器模式"><a href="#迭代器模式" class="headerlink" title="迭代器模式"></a>迭代器模式</h3><h4 id="表现形式-6"><a href="#表现形式-6" class="headerlink" title="表现形式"></a>表现形式</h4><p>遍历容器中的每一个元素</p><h4 id="使用场景-6"><a href="#使用场景-6" class="headerlink" title="使用场景"></a>使用场景</h4><p>for in 和 for of</p><blockquote><p>区别：</p><ul><li>for in 遍历的是索引，继承而来的也可以遍历</li><li>for of 遍历的是值，继承而来的无法遍历，无法遍历对象</li></ul></blockquote><p>可迭代对象：实现迭代协议</p></div>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;设计模式的分类&quot;&gt;&lt;a href=&quot;#设计模式的分类&quot; class=&quot;headerlink&quot; title=&quot;设计模式的分类&quot;&gt;&lt;/a&gt;设计模式的分类&lt;/h1&gt;&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th align=&quot;left&quot;&gt;模式 &amp;amp; 描述&lt;/th</summary>
      
    
    
    
    <category term="学习笔记" scheme="http://example.com/categories/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/"/>
    
    
    <category term="面试八股" scheme="http://example.com/tags/%E9%9D%A2%E8%AF%95%E5%85%AB%E8%82%A1/"/>
    
  </entry>
  
  <entry>
    <title>linux</title>
    <link href="http://example.com/2024/10/11/linux/"/>
    <id>http://example.com/2024/10/11/linux/</id>
    <published>2024-10-11T15:25:06.000Z</published>
    <updated>2024-10-14T08:47:45.124Z</updated>
    
    <content type="html"><![CDATA[<h1 id="linux常用命令"><a href="#linux常用命令" class="headerlink" title="linux常用命令"></a>linux常用命令</h1><div class="story post-story"><h2 id="处理目录的常用命令"><a href="#处理目录的常用命令" class="headerlink" title="处理目录的常用命令"></a>处理目录的常用命令</h2><ul><li>ls（英文全拼：list files）: 列出目录及文件名</li><li>cd（英文全拼：change directory）：切换目录</li><li>pwd（英文全拼：print work directory）：显示目前的目录</li><li>mkdir（英文全拼：make directory）：创建一个新的目录</li><li>rmdir（英文全拼：remove directory）：删除一个空的目录</li><li>cp（英文全拼：copy file）: 复制文件或目录</li><li>rm（英文全拼：remove）: 删除文件或目录</li><li>mv（英文全拼：move file）: 移动文件与目录，或修改文件与目录的名称</li></ul><p>可以使用 *man [命令]*来查看各个命令的使用文档，如 ：man cp。</p><h3 id="ls-列出目录"><a href="#ls-列出目录" class="headerlink" title="ls (列出目录)"></a>ls (列出目录)</h3><p>语法：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[root@www ~]# ls [-aAdfFhilnrRSt] 目录名称</span><br><span class="line">[root@www ~]# ls [--color=&#123;never,auto,always&#125;] 目录名称</span><br><span class="line">[root@www ~]# ls [--full-time] 目录名称</span><br></pre></td></tr></table></figure><p>选项与参数：</p><ul><li>-a ：全部的文件，连同隐藏文件( 开头为 . 的文件) 一起列出来(常用)</li><li>-d ：仅列出目录本身，而不是列出目录内的文件数据(常用)</li><li>-l ：长数据串列出，包含文件的属性与权限等等数据；(常用)</li></ul><p>将目录下的所有文件列出来(含属性与隐藏档)</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[root@www ~]# ls -al ~</span><br></pre></td></tr></table></figure><p>~为根目录</p><h3 id="cd-切换目录"><a href="#cd-切换目录" class="headerlink" title="cd (切换目录)"></a>cd (切换目录)</h3><p>cd是Change Directory的缩写，这是用来变换工作目录的命令。</p><h3 id="pwd-显示目前所在的目录"><a href="#pwd-显示目前所在的目录" class="headerlink" title="pwd (显示目前所在的目录)"></a>pwd (显示目前所在的目录)</h3><p>pwd 是 <strong>Print Working Directory</strong> 的缩写，也就是显示目前所在目录的命令。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[root@www ~]# pwd [-P]</span><br></pre></td></tr></table></figure><p>选项与参数：</p><ul><li><strong>-P</strong> ：显示出确实的路径，而非使用链接 (link) 路径。</li></ul><h3 id="mkdir-创建新目录"><a href="#mkdir-创建新目录" class="headerlink" title="mkdir (创建新目录)"></a>mkdir (创建新目录)</h3><p>语法：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mkdir [-mp] 目录名称</span><br></pre></td></tr></table></figure><p>选项与参数：</p><ul><li>-m ：配置文件的权限喔！直接配置，不需要看默认权限 (umask) 的脸色～</li><li>-p ：帮助你直接将所需要的目录(包含上一级目录)递归创建起来！</li></ul><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">[root@www ~]# cd /tmp</span><br><span class="line">[root@www tmp]# mkdir test    &lt;==创建一名为 test 的新目录</span><br><span class="line">[root@www tmp]# mkdir test1/test2/test3/test4</span><br><span class="line">mkdir: cannot create directory `test1/test2/test3/test4&#x27;: </span><br><span class="line">No such file or directory       &lt;== 没办法直接创建此目录啊！</span><br><span class="line">[root@www tmp]# mkdir -p test1/test2/test3/test4</span><br></pre></td></tr></table></figure><p>加了这个 -p 的选项，可以自行帮你创建多层目录！</p><p>实例：创建权限为 <strong>rwx–x–x</strong> 的目录。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">[root@www tmp]# mkdir -m 711 test2</span><br><span class="line">[root@www tmp]# ls -l</span><br><span class="line">drwxr-xr-x  3 root  root 4096 Jul 18 12:50 test</span><br><span class="line">drwxr-xr-x  3 root  root 4096 Jul 18 12:53 test1</span><br><span class="line">drwx--x--x  2 root  root 4096 Jul 18 12:54 test2</span><br></pre></td></tr></table></figure><p>上面的权限部分，如果没有加上 -m 来强制配置属性，系统会使用默认属性。</p><p>如果我们使用 -m ，如上例我们给予 -m 711 来给予新的目录 drwx–x–x 的权限。</p><h3 id="rmdir-删除空的目录"><a href="#rmdir-删除空的目录" class="headerlink" title="rmdir (删除空的目录)"></a>rmdir (删除空的目录)</h3><p>语法：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">rmdir [-p] 目录名称</span><br></pre></td></tr></table></figure><p>选项与参数：</p><ul><li><strong>-p ：</strong>从该目录起，一次删除多级空目录</li></ul><p>删除 runoob 目录</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[root@www tmp]# rmdir runoob/</span><br></pre></td></tr></table></figure><p>将 mkdir 实例中创建的目录(&#x2F;tmp 底下)删除掉！</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">[root@www tmp]# ls -l   &lt;==看看有多少目录存在？</span><br><span class="line">drwxr-xr-x  3 root  root 4096 Jul 18 12:50 test</span><br><span class="line">drwxr-xr-x  3 root  root 4096 Jul 18 12:53 test1</span><br><span class="line">drwx--x--x  2 root  root 4096 Jul 18 12:54 test2</span><br><span class="line">[root@www tmp]# rmdir test   &lt;==可直接删除掉，没问题</span><br><span class="line">[root@www tmp]# rmdir test1  &lt;==因为尚有内容，所以无法删除！</span><br><span class="line">rmdir: `test1&#x27;: Directory not empty</span><br><span class="line">[root@www tmp]# rmdir -p test1/test2/test3/test4</span><br><span class="line">[root@www tmp]# ls -l        &lt;==您看看，底下的输出中test与test1不见了！</span><br><span class="line">drwx--x--x  2 root  root 4096 Jul 18 12:54 test2</span><br></pre></td></tr></table></figure><p>利用 -p 这个选项，立刻就可以将 test1&#x2F;test2&#x2F;test3&#x2F;test4 一次删除。</p><p>要注意的是，这个 rmdir 仅能删除空的目录，可以使用 rm 命令来删除非空目录。</p><h3 id="cp-复制文件或目录"><a href="#cp-复制文件或目录" class="headerlink" title="cp (复制文件或目录)"></a>cp (复制文件或目录)</h3><p>cp 即拷贝文件和目录。</p><p>语法:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[root@www ~]# cp [-adfilprsu] 来源档(source) 目标档(destination)</span><br><span class="line">[root@www ~]# cp [options] source1 source2 source3 .... directory</span><br></pre></td></tr></table></figure><p>选项与参数：</p><ul><li><strong>-a：</strong>相当於 -pdr 的意思，至於 pdr 请参考下列说明；(常用)</li><li><strong>-d：</strong>若来源档为链接档的属性(link file)，则复制链接档属性而非文件本身；</li><li><strong>-f：</strong>为强制(force)的意思，若目标文件已经存在且无法开启，则移除后再尝试一次；</li><li><strong>-i：</strong>若目标档(destination)已经存在时，在覆盖时会先询问动作的进行(常用)</li><li><strong>-l：</strong>进行硬式链接(hard link)的链接档创建，而非复制文件本身；</li><li><strong>-p：</strong>连同文件的属性一起复制过去，而非使用默认属性(备份常用)；</li><li><strong>-r：</strong>递归持续复制，用于目录的复制行为；(常用)</li><li><strong>-s：</strong>复制成为符号链接档 (symbolic link)，亦即『捷径』文件；</li><li><strong>-u：</strong>若 destination 比 source 旧才升级 destination ！</li></ul><p>用 root 身份，将 root 目录下的 .bashrc 复制到 &#x2F;tmp 下，并命名为 bashrc</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[root@www ~]# cp ~/.bashrc /tmp/bashrc</span><br><span class="line">[root@www ~]# cp -i ~/.bashrc /tmp/bashrc</span><br><span class="line">cp: overwrite `/tmp/bashrc&#x27;? n  &lt;==n不覆盖，y为覆盖</span><br></pre></td></tr></table></figure><h3 id="rm-移除文件或目录"><a href="#rm-移除文件或目录" class="headerlink" title="rm (移除文件或目录)"></a>rm (移除文件或目录)</h3><p>语法：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">rm [-fir] 文件或目录</span><br></pre></td></tr></table></figure><p>选项与参数：</p><ul><li>-f ：就是 force 的意思，忽略不存在的文件，不会出现警告信息；</li><li>-i ：互动模式，在删除前会询问使用者是否动作</li><li>-r ：递归删除啊！最常用在目录的删除了！这是非常危险的选项！！！</li></ul><h3 id="mv-移动文件与目录，或修改名称"><a href="#mv-移动文件与目录，或修改名称" class="headerlink" title="mv (移动文件与目录，或修改名称)"></a>mv (移动文件与目录，或修改名称)</h3><p>语法：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[root@www ~]# mv [-fiu] source destination</span><br><span class="line">[root@www ~]# mv [options] source1 source2 source3 .... directory</span><br></pre></td></tr></table></figure><p>选项与参数：</p><ul><li>-f ：force 强制的意思，如果目标文件已经存在，不会询问而直接覆盖；</li><li>-i ：若目标文件 (destination) 已经存在时，就会询问是否覆盖！</li><li>-u ：若目标文件已经存在，且 source 比较新，才会升级 (update)</li></ul><p>复制一文件，创建一目录，将文件移动到目录中</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">[root@www ~]# cd /tmp</span><br><span class="line">[root@www tmp]# cp ~/.bashrc bashrc</span><br><span class="line">[root@www tmp]# mkdir mvtest</span><br><span class="line">[root@www tmp]# mv bashrc mvtest</span><br></pre></td></tr></table></figure></div><div class="story post-story"><h2 id="查看文件"><a href="#查看文件" class="headerlink" title="查看文件"></a>查看文件</h2><h3 id="cat"><a href="#cat" class="headerlink" title="cat"></a>cat</h3><p>由第一行开始显示文件内容</p><p>语法：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cat [-AbEnTv]</span><br></pre></td></tr></table></figure><p>选项与参数：</p><ul><li>-A ：相当於 -vET 的整合选项，可列出一些特殊字符而不是空白而已；</li><li>-b ：列出行号，仅针对非空白行做行号显示，空白行不标行号！</li><li>-E ：将结尾的断行字节 $ 显示出来；</li><li>-n ：列印出行号，连同空白行也会有行号，与 -b 的选项不同；</li><li>-T ：将 [tab] 按键以 ^I 显示出来；</li><li>-v ：列出一些看不出来的特殊字符</li></ul><p>检看 &#x2F;etc&#x2F;issue 这个文件的内容：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[root@www ~]# cat /etc/issue</span><br><span class="line">CentOS release 6.4 (Final)</span><br><span class="line">Kernel \r on an \m</span><br></pre></td></tr></table></figure></div><div class="story post-story"><h2 id="创建文件"><a href="#创建文件" class="headerlink" title="创建文件"></a>创建文件</h2><h3 id="touch"><a href="#touch" class="headerlink" title="touch"></a>touch</h3><p>touch命令用于修改文件或者目录的时间属性，包括存取时间和更改时间。若文件不存在，系统会建立一个新的文件。</p><h3 id="语法"><a href="#语法" class="headerlink" title="语法"></a>语法</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">touch [-acfm][-d&lt;日期时间&gt;][-r&lt;参考文件或目录&gt;] [-t&lt;日期时间&gt;][--help][--version][文件或目录…]</span><br></pre></td></tr></table></figure><ul><li><strong>参数说明</strong>：</li><li>a 改变档案的读取时间记录。</li><li>m 改变档案的修改时间记录。</li><li>c 假如目的档案不存在，不会建立新的档案。与 –no-create 的效果一样。</li><li>f 不使用，是为了与其他 unix 系统的相容性而保留。</li><li>r 使用参考档的时间记录，与 –file 的效果一样。</li><li>d 设定时间与日期，可以使用各种不同的格式。</li><li>t 设定档案的时间记录，格式与 date 指令相同。</li><li>–no-create 不会建立新档案。</li><li>–help 列出指令格式。</li><li>–version 列出版本讯息。</li></ul></div><div class="story post-story"><h2 id="vim"><a href="#vim" class="headerlink" title="vim"></a>vim</h2><p><img src="/../images/vim.gif" class="lazyload" data-srcset="/../images/vim.gif" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw=="></p></div>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;linux常用命令&quot;&gt;&lt;a href=&quot;#linux常用命令&quot; class=&quot;headerlink&quot; title=&quot;linux常用命令&quot;&gt;&lt;/a&gt;linux常用命令&lt;/h1&gt;&lt;div class=&quot;story post-story&quot;&gt;&lt;h2 id=&quot;处理目录的常用</summary>
      
    
    
    
    
    <category term="linux" scheme="http://example.com/tags/linux/"/>
    
  </entry>
  
  <entry>
    <title>2024-10-9</title>
    <link href="http://example.com/2024/10/09/2024-10-9/"/>
    <id>http://example.com/2024/10/09/2024-10-9/</id>
    <published>2024-10-09T15:58:54.000Z</published>
    <updated>2024-10-09T16:11:22.592Z</updated>
    
    <content type="html"><![CDATA[<p><strong>好累好累，每天高强度学习，脑子转不过来了555，明天应该可以把vue3项目做完吧</strong></p><p><img src="/../images/34.jpg" class="lazyload" data-srcset="/../images/34.jpg" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt="累趴的猫学长"></p><p><img src="/../images/35.jpg" class="lazyload" data-srcset="/../images/35.jpg" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt="夕阳"></p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;&lt;strong&gt;好累好累，每天高强度学习，脑子转不过来了555，明天应该可以把vue3项目做完吧&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;/../images/34.jpg&quot; class=&quot;lazyload&quot; data-srcset=&quot;/../images/34</summary>
      
    
    
    
    <category term="随笔" scheme="http://example.com/categories/%E9%9A%8F%E7%AC%94/"/>
    
    
  </entry>
  
  <entry>
    <title>vue3</title>
    <link href="http://example.com/2024/10/02/vue3/"/>
    <id>http://example.com/2024/10/02/vue3/</id>
    <published>2024-10-02T15:00:05.000Z</published>
    <updated>2024-12-14T16:15:13.793Z</updated>
    
    <content type="html"><![CDATA[<h1 id="组合式API-reactive和ref函数"><a href="#组合式API-reactive和ref函数" class="headerlink" title="组合式API - reactive和ref函数"></a>组合式API - reactive和ref函数</h1><div class="story post-story"><h2 id="1-reactive"><a href="#1-reactive" class="headerlink" title="1. reactive"></a>1. reactive</h2><blockquote><p>接受对象类型数据的参数传入并返回一个响应式的对象</p></blockquote><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">&lt;script setup&gt;</span><br><span class="line"> // 导入</span><br><span class="line"> import &#123; reactive &#125; from &#x27;vue&#x27;</span><br><span class="line"> // 执行函数 传入参数 变量接收</span><br><span class="line"> const state = reactive(&#123;</span><br><span class="line">   msg:&#x27;this is msg&#x27;</span><br><span class="line"> &#125;)</span><br><span class="line"> const setState = ()=&gt;&#123;</span><br><span class="line">   // 修改数据更新视图</span><br><span class="line">   state.msg = &#x27;this is new msg&#x27;</span><br><span class="line"> &#125;</span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br><span class="line">&lt;template&gt;</span><br><span class="line">  &#123;&#123; state.msg &#125;&#125;</span><br><span class="line">  &lt;button @click=&quot;setState&quot;&gt;change msg&lt;/button&gt;</span><br><span class="line">&lt;/template&gt;</span><br></pre></td></tr></table></figure></div><div class="story post-story"><h2 id="2-ref"><a href="#2-ref" class="headerlink" title="2. ref"></a>2. ref</h2><blockquote><p>接收简单类型或者对象类型的数据传入并返回一个响应式的对象</p></blockquote><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">&lt;script setup&gt;</span><br><span class="line"> // 导入</span><br><span class="line"> import &#123; ref &#125; from &#x27;vue&#x27;</span><br><span class="line"> // 执行函数 传入参数 变量接收</span><br><span class="line"> const count = ref(0)</span><br><span class="line"> const setCount = ()=&gt;&#123;</span><br><span class="line">   // 修改数据更新视图必须加上.value</span><br><span class="line">   count.value++</span><br><span class="line"> &#125;</span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;button @click=&quot;setCount&quot;&gt;&#123;&#123;count&#125;&#125;&lt;/button&gt;</span><br><span class="line">&lt;/template&gt;</span><br></pre></td></tr></table></figure></div><div class="story post-story"><h2 id="3-reactive-对比-ref"><a href="#3-reactive-对比-ref" class="headerlink" title="3. reactive 对比 ref"></a>3. reactive 对比 ref</h2><ol><li>都是用来生成响应式数据</li><li>不同点<ol><li>reactive不能处理简单类型的数据</li><li>ref参数类型支持更好，但是必须通过.value做访问修改</li><li>ref函数内部的实现依赖于reactive函数</li></ol></li></ol><h1 id="组合式API-computed"><a href="#组合式API-computed" class="headerlink" title="组合式API - computed"></a>组合式API - computed</h1><blockquote><p>计算属性基本思想和Vue2保持一致，组合式API下的计算属性只是修改了API写法</p></blockquote><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">&lt;script setup&gt;</span><br><span class="line">// 导入</span><br><span class="line">import &#123;ref, computed &#125; from &#x27;vue&#x27;</span><br><span class="line">// 原始数据</span><br><span class="line">const count = ref(0)</span><br><span class="line">// 计算属性</span><br><span class="line">const doubleCount = computed(()=&gt;count.value * 2)</span><br><span class="line"></span><br><span class="line">// 原始数据</span><br><span class="line">const list = ref([1,2,3,4,5,6,7,8])</span><br><span class="line">// 计算属性list</span><br><span class="line">const filterList = computed(()=&gt;list.value.filter(item=&gt;item &gt; 2))</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure><h1 id="组合式API-watch"><a href="#组合式API-watch" class="headerlink" title="组合式API - watch"></a>组合式API - watch</h1><blockquote><p>侦听一个或者多个数据的变化，数据变化时执行回调函数，俩个额外参数 immediate控制立刻执行，deep开启深度侦听</p></blockquote><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">&lt;script setup&gt;</span><br><span class="line">  // 1. 导入watch</span><br><span class="line">  import &#123; ref, watch &#125; from &#x27;vue&#x27;</span><br><span class="line">  const count = ref(0)</span><br><span class="line">  // 2. 调用watch 侦听变化</span><br><span class="line">  watch(count, (newValue, oldValue)=&gt;&#123;</span><br><span class="line">    console.log(`count发生了变化，老值为$&#123;oldValue&#125;,新值为$&#123;newValue&#125;`)</span><br><span class="line">  &#125;)</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure></div><div class="story post-story"><h2 id="2-侦听多个数据"><a href="#2-侦听多个数据" class="headerlink" title="2. 侦听多个数据"></a>2. 侦听多个数据</h2><blockquote><p>侦听多个数据，第一个参数可以改写成数组的写法</p></blockquote><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">&lt;script setup&gt;</span><br><span class="line">  // 1. 导入watch</span><br><span class="line">  import &#123; ref, watch &#125; from &#x27;vue&#x27;</span><br><span class="line">  const count = ref(0)</span><br><span class="line">  const name = ref(&#x27;cp&#x27;)</span><br><span class="line">  // 2. 调用watch 侦听变化</span><br><span class="line">  watch([count, name], ([newCount, newName],[oldCount,oldName])=&gt;&#123;</span><br><span class="line">    console.log(`count或者name变化了，[newCount, newName],[oldCount,oldName])</span><br><span class="line">  &#125;)</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure></div><div class="story post-story"><h2 id="3-immediate"><a href="#3-immediate" class="headerlink" title="3. immediate"></a>3. immediate</h2><blockquote><p>在侦听器创建时立即出发回调，响应式数据变化之后继续执行回调</p></blockquote><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">&lt;script setup&gt;</span><br><span class="line">  // 1. 导入watch</span><br><span class="line">  import &#123; ref, watch &#125; from &#x27;vue&#x27;</span><br><span class="line">  const count = ref(0)</span><br><span class="line">  // 2. 调用watch 侦听变化</span><br><span class="line">  watch(count, (newValue, oldValue)=&gt;&#123;</span><br><span class="line">    console.log(`count发生了变化，老值为$&#123;oldValue&#125;,新值为$&#123;newValue&#125;`)</span><br><span class="line">  &#125;,&#123;</span><br><span class="line">    immediate: true</span><br><span class="line">  &#125;)</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure></div><div class="story post-story"><h2 id="4-deep"><a href="#4-deep" class="headerlink" title="4. deep"></a>4. deep</h2><blockquote><p>通过watch监听的ref对象默认是浅层侦听的，直接修改嵌套的对象属性不会触发回调执行，需要开启deep</p></blockquote><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">&lt;script setup&gt;</span><br><span class="line">  // 1. 导入watch</span><br><span class="line">  import &#123; ref, watch &#125; from &#x27;vue&#x27;</span><br><span class="line">  const state = ref(&#123; count: 0 &#125;)</span><br><span class="line">  // 2. 监听对象state</span><br><span class="line">  watch(state, ()=&gt;&#123;</span><br><span class="line">    console.log(&#x27;数据变化了&#x27;)</span><br><span class="line">  &#125;)</span><br><span class="line">  const changeStateByCount = ()=&gt;&#123;</span><br><span class="line">    // 直接修改不会引发回调执行</span><br><span class="line">    state.value.count++</span><br><span class="line">  &#125;</span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br><span class="line">&lt;script setup&gt;</span><br><span class="line">  // 1. 导入watch</span><br><span class="line">  import &#123; ref, watch &#125; from &#x27;vue&#x27;</span><br><span class="line">  const state = ref(&#123; count: 0 &#125;)</span><br><span class="line">  // 2. 监听对象state 并开启deep</span><br><span class="line">  watch(state, ()=&gt;&#123;</span><br><span class="line">    console.log(&#x27;数据变化了&#x27;)</span><br><span class="line">  &#125;,&#123;deep:true&#125;)</span><br><span class="line">  const changeStateByCount = ()=&gt;&#123;</span><br><span class="line">    // 此时修改可以触发回调</span><br><span class="line">    state.value.count++</span><br><span class="line">  &#125;</span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br></pre></td></tr></table></figure><h1 id="组合式API-生命周期函数"><a href="#组合式API-生命周期函数" class="headerlink" title="组合式API - 生命周期函数"></a>组合式API - 生命周期函数</h1></div><div class="story post-story"><h2 id="1-API"><a href="#1-API" class="headerlink" title="1. API"></a>1. API</h2><ul><li>setup()</li><li>onBeforemount()</li><li>onMounted()</li><li>onBeforeUpdate()</li><li>onUpdated()</li><li>onBeforeUnMount()</li><li>onUnMounted()</li></ul></div><div class="story post-story"><h2 id="2-生命周期函数基本使用"><a href="#2-生命周期函数基本使用" class="headerlink" title="2. 生命周期函数基本使用"></a>2. 生命周期函数基本使用</h2><blockquote><ol><li>导入生命周期函数</li><li>执行生命周期函数，传入回调</li></ol></blockquote><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&lt;scirpt setup&gt;</span><br><span class="line">import &#123; onMounted &#125; from &#x27;vue&#x27;</span><br><span class="line">onMounted(()=&gt;&#123;</span><br><span class="line">  // 自定义逻辑</span><br><span class="line">&#125;)</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure></div><div class="story post-story"><h2 id="3-执行多次"><a href="#3-执行多次" class="headerlink" title="3. 执行多次"></a>3. 执行多次</h2><blockquote><p>生命周期函数执行多次的时候，会按照顺序依次执行</p></blockquote><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">&lt;scirpt setup&gt;</span><br><span class="line">import &#123; onMounted &#125; from &#x27;vue&#x27;</span><br><span class="line">onMounted(()=&gt;&#123;</span><br><span class="line">  // 自定义逻辑</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">onMounted(()=&gt;&#123;</span><br><span class="line">  // 自定义逻辑</span><br><span class="line">&#125;)</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure><h1 id="组合式API-父子通信"><a href="#组合式API-父子通信" class="headerlink" title="组合式API - 父子通信"></a>组合式API - 父子通信</h1></div><div class="story post-story"><h2 id="1-父传子"><a href="#1-父传子" class="headerlink" title="1. 父传子"></a>1. 父传子</h2><blockquote><p>基本思想</p><ol><li>父组件中给子组件绑定属性</li><li>子组件内部通过props选项接收数据</li></ol></blockquote><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//App.vue</span></span><br><span class="line">&lt;template&gt;</span><br><span class="line">  <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;<span class="name">SonCom</span> <span class="attr">message</span>=<span class="string">&quot;this is a message&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">SonCom</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">script</span> <span class="attr">setup</span>&gt;</span><span class="language-javascript"></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"><span class="keyword">import</span> <span class="title class_">SonCom</span> <span class="keyword">from</span> <span class="string">&#x27;./SonCom.vue&#x27;</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">//SonCom.vue</span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">template</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">  <span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    &#123;&#123; message &#125;&#125;</span></span><br><span class="line"><span class="language-xml">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">script</span> <span class="attr">setup</span>&gt;</span><span class="language-javascript"></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"><span class="keyword">const</span> props = <span class="title function_">defineProps</span>(&#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="attr">message</span>:<span class="title class_">String</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">&#125;)</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span></span><br></pre></td></tr></table></figure></div><div class="story post-story"><h2 id="2-子传父"><a href="#2-子传父" class="headerlink" title="2. 子传父"></a>2. 子传父</h2><blockquote><p>基本思想</p><ol><li>父组件中给子组件标签通过@绑定事件</li><li>子组件内部通过 emit 方法触发事件</li></ol></blockquote><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//App.vue</span></span><br><span class="line">&lt;template&gt;</span><br><span class="line">  <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;<span class="name">SonCom</span> @<span class="attr">get-message</span>=<span class="string">&quot;messageHandler&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">SonCom</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">script</span> <span class="attr">setup</span>&gt;</span><span class="language-javascript"></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"><span class="keyword">import</span> <span class="title class_">SonCom</span> <span class="keyword">from</span> <span class="string">&#x27;./SonCom.vue&#x27;</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"><span class="keyword">const</span> <span class="title function_">messageHandler</span> = (<span class="params">message</span>)=&gt;&#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">  <span class="variable language_">console</span>.<span class="title function_">log</span>(message)</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">&#125;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">//SonCom.vue</span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">template</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">  <span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;<span class="name">button</span> @<span class="attr">click</span>=<span class="string">&quot;sendMsg&quot;</span>&gt;</span>点我发送信息<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">script</span> <span class="attr">setup</span>&gt;</span><span class="language-javascript"></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"><span class="keyword">const</span> emit = <span class="title function_">defineEmits</span>([<span class="string">&#x27;get-message&#x27;</span>])</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"><span class="keyword">const</span> <span class="title function_">sendMsg</span> = (<span class="params"></span>)=&gt;&#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="title function_">emit</span>(<span class="string">&#x27;get-message&#x27;</span>,<span class="string">&quot;this is son message&quot;</span>)</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">&#125;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span></span><br></pre></td></tr></table></figure><h1 id="组合式API-模版引用"><a href="#组合式API-模版引用" class="headerlink" title="组合式API - 模版引用"></a>组合式API - 模版引用</h1><blockquote><p>概念：通过 ref标识 获取真实的 dom对象或者组件实例对象</p></blockquote></div><div class="story post-story"><h2 id="1-基本使用"><a href="#1-基本使用" class="headerlink" title="1. 基本使用"></a>1. 基本使用</h2><blockquote><p>实现步骤：</p><ol><li>调用ref函数生成一个ref对象</li><li>通过ref标识绑定ref对象到标签</li></ol></blockquote><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;<span class="name">h1</span> <span class="attr">ref</span>=<span class="string">&quot;h1Ref&quot;</span>&gt;</span>我是dom标签对象h1<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">script</span> <span class="attr">setup</span>&gt;</span><span class="language-javascript"></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"><span class="keyword">import</span> &#123; ref &#125; <span class="keyword">from</span> <span class="string">&#x27;vue&#x27;</span>;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"><span class="keyword">const</span> h1Ref = <span class="title function_">ref</span>(<span class="literal">null</span>)</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span></span><br></pre></td></tr></table></figure></div><div class="story post-story"><h2 id="2-defineExpose"><a href="#2-defineExpose" class="headerlink" title="2. defineExpose"></a>2. defineExpose</h2><blockquote><p>默认情况下在 <script setup>语法糖下组件内部的属性和方法是不开放给父组件访问的，可以通过defineExpose编译宏指定哪些属性和方法容许访问<br>说明：指定testMsg属性可以被访问到</p></blockquote><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&lt;script setup&gt;</span><br><span class="line"><span class="keyword">import</span> &#123; ref &#125; <span class="keyword">from</span> <span class="string">&#x27;vue&#x27;</span>;</span><br><span class="line"><span class="keyword">const</span> testMsg = <span class="title function_">ref</span>(<span class="string">&quot;this is a test message&quot;</span>)</span><br><span class="line"><span class="title function_">defineExpose</span>(&#123;</span><br><span class="line">  testMsg</span><br><span class="line">&#125;)</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure><h1 id="组合式API-provide和inject"><a href="#组合式API-provide和inject" class="headerlink" title="组合式API - provide和inject"></a>组合式API - provide和inject</h1><p>顶层组件向任意的底层组件传递数据和方法，实现跨层组件通信</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//顶层组件</span></span><br><span class="line"><span class="title function_">provide</span>(<span class="string">&#x27;key&#x27;</span>,refObj)</span><br><span class="line"><span class="comment">//底层组件</span></span><br><span class="line"><span class="keyword">const</span> refObj = <span class="title function_">inject</span>(<span class="string">&#x27;key&#x27;</span>)</span><br></pre></td></tr></table></figure><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//顶层组件</span></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">func</span> = (<span class="params"></span>)=&gt;&#123;&#125;</span><br><span class="line"><span class="title function_">provide</span>(<span class="string">&#x27;key&#x27;</span>,func)</span><br><span class="line"><span class="comment">//底层组件</span></span><br><span class="line"><span class="keyword">const</span> func = <span class="title function_">inject</span>(<span class="string">&#x27;key&#x27;</span>)</span><br></pre></td></tr></table></figure><h1 id="pinia"><a href="#pinia" class="headerlink" title="pinia"></a>pinia</h1><p>Pinia 是 Vue 的专属状态管理库，可以实现跨组件或页面共享状态，是 vuex 状态管理工具的替代品，和 Vuex相比，具备以下优势</p><ol><li>提供更加简单的API （去掉了 mutation ）</li><li>提供符合组合式API风格的API （和 Vue3 新语法统一）</li><li>去掉了modules的概念，每一个store都是一个独立的模块</li><li>搭配 TypeScript 一起使用提供可靠的类型推断</li></ol><h1 id="创建空Vue项目并安装Pinia"><a href="#创建空Vue项目并安装Pinia" class="headerlink" title="创建空Vue项目并安装Pinia"></a>创建空Vue项目并安装Pinia</h1><h3 id="1-创建空Vue项目"><a href="#1-创建空Vue项目" class="headerlink" title="1. 创建空Vue项目"></a>1. 创建空Vue项目</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm init vue@latest</span><br></pre></td></tr></table></figure><h3 id="2-安装Pinia并注册"><a href="#2-安装Pinia并注册" class="headerlink" title="2. 安装Pinia并注册"></a>2. 安装Pinia并注册</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm i pinia</span><br></pre></td></tr></table></figure><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; createPinia &#125; <span class="keyword">from</span> <span class="string">&#x27;pinia&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> app = <span class="title function_">createApp</span>(<span class="title class_">App</span>)</span><br><span class="line"><span class="comment">// 以插件的形式注册</span></span><br><span class="line">app.<span class="title function_">use</span>(<span class="title function_">createPinia</span>())</span><br><span class="line">app.<span class="title function_">use</span>(router)</span><br><span class="line">app.<span class="title function_">mount</span>(<span class="string">&#x27;#app&#x27;</span>)</span><br></pre></td></tr></table></figure><h1 id="实现counter"><a href="#实现counter" class="headerlink" title="实现counter"></a>实现counter</h1><blockquote><p>核心步骤：</p><ol><li>定义store</li><li>组件使用store</li></ol></blockquote><p>1- 定义store</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; defineStore &#125; <span class="keyword">from</span> <span class="string">&#x27;pinia&#x27;</span></span><br><span class="line"><span class="keyword">import</span> &#123; ref &#125; <span class="keyword">from</span> <span class="string">&#x27;vue&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> useCounterStore = <span class="title function_">defineStore</span>(<span class="string">&#x27;counter&#x27;</span>, <span class="function">()=&gt;</span>&#123;</span><br><span class="line">  <span class="comment">// 数据 （state）</span></span><br><span class="line">  <span class="keyword">const</span> count = <span class="title function_">ref</span>(<span class="number">0</span>)</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 修改数据的方法 （action）</span></span><br><span class="line">  <span class="keyword">const</span> <span class="title function_">increment</span> = (<span class="params"></span>)=&gt;&#123;</span><br><span class="line">    count.<span class="property">value</span>++</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 以对象形式返回</span></span><br><span class="line">  <span class="keyword">return</span> &#123;</span><br><span class="line">    count,</span><br><span class="line">    increment</span><br><span class="line">  &#125;</span><br><span class="line">&#125;)</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>2- 组件使用store</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">&lt;script setup&gt;</span><br><span class="line">  // 1. 导入use方法</span><br><span class="line">import &#123; useCounterStore &#125; from &#x27;@/stores/counter&#x27;</span><br><span class="line">  // 2. 执行方法得到store store里有数据和方法</span><br><span class="line">  const counterStore = useCounterStore()</span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br><span class="line">&lt;template&gt;</span><br><span class="line">&lt;button @click=&quot;counterStore.increment&quot;&gt;</span><br><span class="line">    &#123;&#123; counterStore.count &#125;&#125;</span><br><span class="line">  &lt;/button&gt;</span><br><span class="line">&lt;/template&gt;</span><br></pre></td></tr></table></figure><h1 id="实现getters"><a href="#实现getters" class="headerlink" title="实现getters"></a>实现getters</h1><blockquote><p>getters直接使用计算属性即可实现</p></blockquote><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 数据（state）</span></span><br><span class="line"><span class="keyword">const</span> count = <span class="title function_">ref</span>(<span class="number">0</span>)</span><br><span class="line"><span class="comment">// getter (computed)</span></span><br><span class="line"><span class="keyword">const</span> doubleCount = <span class="title function_">computed</span>(<span class="function">() =&gt;</span> count.<span class="property">value</span> * <span class="number">2</span>)</span><br></pre></td></tr></table></figure><h1 id="异步action"><a href="#异步action" class="headerlink" title="异步action"></a>异步action</h1><blockquote><p>思想：action函数既支持同步也支持异步，和在组件中发送网络请求写法保持一致<br>步骤：</p><ol><li>store中定义action</li><li>组件中触发action</li></ol></blockquote><p>1- store中定义action</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="variable constant_">API_URL</span> = <span class="string">&#x27;http://geek.itheima.net/v1_0/channels&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> useCounterStore = <span class="title function_">defineStore</span>(<span class="string">&#x27;counter&#x27;</span>, <span class="function">()=&gt;</span>&#123;</span><br><span class="line">  <span class="comment">// 数据</span></span><br><span class="line">  <span class="keyword">const</span> list = <span class="title function_">ref</span>([])</span><br><span class="line">  <span class="comment">// 异步action</span></span><br><span class="line">  <span class="keyword">const</span> <span class="title function_">loadList</span> = <span class="keyword">async</span> (<span class="params"></span>)=&gt;&#123;</span><br><span class="line">    <span class="keyword">const</span> res = <span class="keyword">await</span> axios.<span class="title function_">get</span>(<span class="variable constant_">API_URL</span>)</span><br><span class="line">    list.<span class="property">value</span> = res.<span class="property">data</span>.<span class="property">data</span>.<span class="property">channels</span></span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">return</span> &#123;</span><br><span class="line">    list,</span><br><span class="line">    loadList</span><br><span class="line">  &#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><p>2- 组件中调用action</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">&lt;script setup&gt;</span><br><span class="line">import &#123; useCounterStore &#125; from &#x27;@/stores/counter&#x27;</span><br><span class="line">  const counterStore = useCounterStore()</span><br><span class="line">  // 调用异步action</span><br><span class="line">  counterStore.loadList()</span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br><span class="line">&lt;template&gt;</span><br><span class="line">&lt;ul&gt;</span><br><span class="line">    &lt;li v-for=&quot;item in counterStore.list&quot; :key=&quot;item.id&quot;&gt;&#123;&#123; item.name &#125;&#125;&lt;/li&gt;</span><br><span class="line">  &lt;/ul&gt;</span><br><span class="line">&lt;/template&gt;</span><br></pre></td></tr></table></figure><h1 id="storeToRefs保持响应式解构"><a href="#storeToRefs保持响应式解构" class="headerlink" title="storeToRefs保持响应式解构"></a>storeToRefs保持响应式解构</h1><blockquote><p>直接基于store进行解构赋值，响应式数据（state和getter）会丢失响应式特性，使用storeToRefs辅助保持响应式</p></blockquote><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">&lt;script setup&gt;</span><br><span class="line">  import &#123; storeToRefs &#125; from &#x27;pinia&#x27;</span><br><span class="line">import &#123; useCounterStore &#125; from &#x27;@/stores/counter&#x27;</span><br><span class="line">  const counterStore = useCounterStore()</span><br><span class="line">  // 使用它storeToRefs包裹之后解构保持响应式</span><br><span class="line">  const &#123; count &#125; = storeToRefs(counterStore)</span><br><span class="line"></span><br><span class="line">  const &#123; increment &#125; = counterStore</span><br><span class="line">  </span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br><span class="line">&lt;template&gt;</span><br><span class="line">&lt;button @click=&quot;increment&quot;&gt;</span><br><span class="line">    &#123;&#123; count &#125;&#125;</span><br><span class="line">  &lt;/button&gt;</span><br><span class="line">&lt;/template&gt;</span><br></pre></td></tr></table></figure></div><div class="story post-story"><h2 id="Pinia持久化存储"><a href="#Pinia持久化存储" class="headerlink" title="Pinia持久化存储"></a>Pinia持久化存储</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm i pinia-plugin-persistedstate</span><br></pre></td></tr></table></figure><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//main.js</span></span><br><span class="line"><span class="keyword">import</span> &#123; createPinia &#125; <span class="keyword">from</span> <span class="string">&#x27;pinia&#x27;</span></span><br><span class="line"><span class="keyword">import</span> piniaPluginPersistedstate <span class="keyword">from</span> <span class="string">&#x27;pinia-plugin-persistedstate&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> pinia = <span class="title function_">createPinia</span>()</span><br><span class="line">pinia.<span class="title function_">use</span>(piniaPluginPersistedstate)</span><br><span class="line"></span><br></pre></td></tr></table></figure><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//定义store时</span></span><br><span class="line"><span class="keyword">import</span> &#123; defineStore &#125; <span class="keyword">from</span> <span class="string">&#x27;pinia&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> useStore = <span class="title function_">defineStore</span>(</span><br><span class="line">  <span class="string">&#x27;main&#x27;</span>,</span><br><span class="line">  <span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">const</span> someState = <span class="title function_">ref</span>(<span class="string">&#x27;hello pinia&#x27;</span>)</span><br><span class="line">    <span class="keyword">return</span> &#123; someState &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="attr">persist</span>: <span class="literal">true</span>,</span><br><span class="line">  &#125;,</span><br><span class="line">)</span><br></pre></td></tr></table></figure><h1 id="全局组件统一插件化"><a href="#全局组件统一插件化" class="headerlink" title="全局组件统一插件化"></a>全局组件统一插件化</h1></div><div class="story post-story"><h2 id="插件化开发"><a href="#插件化开发" class="headerlink" title="插件化开发"></a>插件化开发</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 把components中的所组件都进行全局化注册</span></span><br><span class="line"><span class="comment">// 通过插件的方式</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">ImageView</span> <span class="keyword">from</span> <span class="string">&#x27;./ImageView/index.vue&#x27;</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">Sku</span> <span class="keyword">from</span> <span class="string">&#x27;./XtxSku/index.vue&#x27;</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> componentPlugin = &#123;</span><br><span class="line">  <span class="title function_">install</span> (app) &#123;</span><br><span class="line">    <span class="comment">// app.component(&#x27;组件名字&#x27;，组件配置对象)</span></span><br><span class="line">    app.<span class="title function_">component</span>(<span class="string">&#x27;XtxImageView&#x27;</span>, <span class="title class_">ImageView</span>)</span><br><span class="line">    app.<span class="title function_">component</span>(<span class="string">&#x27;XtxSku&#x27;</span>, <span class="title class_">Sku</span>)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div><div class="story post-story"><h2 id="插件注册"><a href="#插件注册" class="headerlink" title="插件注册"></a>插件注册</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">// 引入全局组件插件</span><br><span class="line">import &#123; componentPlugin &#125; from &#x27;@/components&#x27;</span><br><span class="line"></span><br><span class="line">app.use(componentPlugin)</span><br></pre></td></tr></table></figure></div><div class="story post-story"><h2 id="响应式"><a href="#响应式" class="headerlink" title="响应式"></a>响应式</h2><p>原理就是数据劫持结合发布者-订阅者模式，Vue在初始化数据时，会使用<code>Object.defineProperty</code>重新定义data中的所有属性，劫持各个属性的setter和getter，在数据变动时发布消息给订阅者，触发相应的监听回调。Vue3改用<code>Proxy</code>替代Object.defineProperty。因为Proxy可以直接监听对象和数组的变化，并且有多种拦截方法。</p></div>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;组合式API-reactive和ref函数&quot;&gt;&lt;a href=&quot;#组合式API-reactive和ref函数&quot; class=&quot;headerlink&quot; title=&quot;组合式API - reactive和ref函数&quot;&gt;&lt;/a&gt;组合式API - reactive和ref</summary>
      
    
    
    
    <category term="学习笔记" scheme="http://example.com/categories/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/"/>
    
    
    <category term="vue3" scheme="http://example.com/tags/vue3/"/>
    
  </entry>
  
  <entry>
    <title>vue3-rabbit小兔鲜电商项目</title>
    <link href="http://example.com/2024/10/01/vue3-rabbit%E5%B0%8F%E5%85%94%E9%B2%9C%E7%94%B5%E5%95%86%E9%A1%B9%E7%9B%AE/"/>
    <id>http://example.com/2024/10/01/vue3-rabbit%E5%B0%8F%E5%85%94%E9%B2%9C%E7%94%B5%E5%95%86%E9%A1%B9%E7%9B%AE/</id>
    <published>2024-10-01T14:48:11.000Z</published>
    <updated>2024-12-09T12:18:53.871Z</updated>
    
    <content type="html"><![CDATA[<h1 id="技术栈"><a href="#技术栈" class="headerlink" title="技术栈"></a>技术栈</h1><p>vue3+JavaScript+vue-router+pinia+element-plus+axios+echarts+vueuse</p><h1 id="创建项目并整理目录"><a href="#创建项目并整理目录" class="headerlink" title="创建项目并整理目录"></a>创建项目并整理目录</h1><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm init vue@latest</span><br></pre></td></tr></table></figure><div class="story post-story"><h2 id="目录结构"><a href="#目录结构" class="headerlink" title="目录结构"></a>目录结构</h2><table><thead><tr><th>文件夹</th><th>作用</th></tr></thead><tbody><tr><td>apis</td><td>接口</td></tr><tr><td>assets</td><td>静态资源</td></tr><tr><td>components</td><td>通用组件</td></tr><tr><td>composables</td><td>组合函数</td></tr><tr><td>directives</td><td>全局指令</td></tr><tr><td>router</td><td>路由Router</td></tr><tr><td>stores</td><td>Pinia仓库</td></tr><tr><td>styles</td><td>全局样式文件夹</td></tr><tr><td>utils</td><td>工具函数</td></tr><tr><td>views</td><td>页面级组件</td></tr></tbody></table><h1 id="关联远程github项目"><a href="#关联远程github项目" class="headerlink" title="关联远程github项目"></a>关联远程github项目</h1><p>git init </p><p>git add .</p><p>git commit -m “init”</p><p>git remote add origin …</p><p>git branch -M main</p><p>git push –set-upstream origin main</p><h1 id="jsconfig-json配置别名路径"><a href="#jsconfig-json配置别名路径" class="headerlink" title="jsconfig.json配置别名路径"></a>jsconfig.json配置别名路径</h1><blockquote><p>配置别名路径可以在写代码时联想提示路径</p></blockquote><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">  <span class="attr">&quot;compilerOptions&quot;</span> <span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;baseUrl&quot;</span> <span class="punctuation">:</span> <span class="string">&quot;./&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;paths&quot;</span> <span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">      <span class="attr">&quot;@/*&quot;</span><span class="punctuation">:</span><span class="punctuation">[</span><span class="string">&quot;src/*&quot;</span><span class="punctuation">]</span></span><br><span class="line">    <span class="punctuation">&#125;</span></span><br><span class="line">  <span class="punctuation">&#125;</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure><h1 id="elementPlus引入"><a href="#elementPlus引入" class="headerlink" title="elementPlus引入"></a>elementPlus引入</h1></div><div class="story post-story"><h2 id="安装elementPlus和自动导入插件"><a href="#安装elementPlus和自动导入插件" class="headerlink" title="安装elementPlus和自动导入插件"></a>安装elementPlus和自动导入插件</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">npm install element-plus</span><br><span class="line">npm install -D unplugin-vue-components unplugin-auto-import</span><br></pre></td></tr></table></figure></div><div class="story post-story"><h2 id="配置自动按需导入"><a href="#配置自动按需导入" class="headerlink" title="配置自动按需导入"></a>配置自动按需导入</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 引入插件</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">AutoImport</span> <span class="keyword">from</span> <span class="string">&#x27;unplugin-auto-import/vite&#x27;</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">Components</span> <span class="keyword">from</span> <span class="string">&#x27;unplugin-vue-components/vite&#x27;</span></span><br><span class="line"><span class="keyword">import</span> &#123; <span class="title class_">ElementPlusResolver</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;unplugin-vue-components/resolvers&#x27;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="title function_">defineConfig</span>(&#123;</span><br><span class="line">  <span class="attr">plugins</span>: [</span><br><span class="line">    <span class="comment">// 配置插件</span></span><br><span class="line">    <span class="title class_">AutoImport</span>(&#123;</span><br><span class="line">      <span class="attr">resolvers</span>: [<span class="title class_">ElementPlusResolver</span>()],</span><br><span class="line">    &#125;),</span><br><span class="line">    <span class="title class_">Components</span>(&#123;</span><br><span class="line">      <span class="attr">resolvers</span>: [<span class="title class_">ElementPlusResolver</span>()],</span><br><span class="line">    &#125;),</span><br><span class="line">  ]</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure></div><div class="story post-story"><h2 id="测试组件"><a href="#测试组件" class="headerlink" title="测试组件"></a>测试组件</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;el-button type=&quot;primary&quot;&gt;i am button&lt;/el-button&gt;</span><br><span class="line">&lt;/template&gt;</span><br></pre></td></tr></table></figure><h1 id="定制elementPlus主题"><a href="#定制elementPlus主题" class="headerlink" title="定制elementPlus主题"></a>定制elementPlus主题</h1></div><div class="story post-story"><h2 id="安装sass"><a href="#安装sass" class="headerlink" title="安装sass"></a>安装sass</h2><blockquote><p>基于vite的项目默认不支持css预处理器，需要开发者单独安装</p></blockquote><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm i sass -D</span><br></pre></td></tr></table></figure></div><div class="story post-story"><h2 id="准备定制化的样式文件"><a href="#准备定制化的样式文件" class="headerlink" title="准备定制化的样式文件"></a>准备定制化的样式文件</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* 只需要重写你需要的即可 */</span></span><br><span class="line">@forward <span class="string">&#x27;element-plus/theme-chalk/src/common/var.scss&#x27;</span> <span class="title function_">with</span> (</span><br><span class="line">  <span class="attr">$colors</span>: (</span><br><span class="line">    <span class="string">&#x27;primary&#x27;</span>: (</span><br><span class="line">      <span class="comment">// 主色</span></span><br><span class="line">      <span class="string">&#x27;base&#x27;</span>: #27ba9b,</span><br><span class="line">    ),</span><br><span class="line">    <span class="string">&#x27;success&#x27;</span>: (</span><br><span class="line">      <span class="comment">// 成功色</span></span><br><span class="line">      <span class="string">&#x27;base&#x27;</span>: #1dc779,</span><br><span class="line">    ),</span><br><span class="line">    <span class="string">&#x27;warning&#x27;</span>: (</span><br><span class="line">      <span class="comment">// 警告色</span></span><br><span class="line">      <span class="string">&#x27;base&#x27;</span>: #ffb302,</span><br><span class="line">    ),</span><br><span class="line">    <span class="string">&#x27;danger&#x27;</span>: (</span><br><span class="line">      <span class="comment">// 危险色</span></span><br><span class="line">      <span class="string">&#x27;base&#x27;</span>: #e26237,</span><br><span class="line">    ),</span><br><span class="line">    <span class="string">&#x27;error&#x27;</span>: (</span><br><span class="line">      <span class="comment">// 错误色</span></span><br><span class="line">      <span class="string">&#x27;base&#x27;</span>: #cf4444,</span><br><span class="line">    ),</span><br><span class="line">  )</span><br><span class="line">)</span><br></pre></td></tr></table></figure></div><div class="story post-story"><h2 id="自动导入配置"><a href="#自动导入配置" class="headerlink" title="自动导入配置"></a>自动导入配置</h2><blockquote><p>这里自动导入需要深入到elementPlus的组件中，按照官方的配置文档来</p><ol><li>自动导入定制化样式文件进行样式覆盖</li><li>按需定制主题配置 （需要安装 unplugin-element-plus）</li></ol></blockquote><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; fileURLToPath, <span class="variable constant_">URL</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;node:url&#x27;</span></span><br><span class="line"><span class="keyword">import</span> &#123; defineConfig &#125; <span class="keyword">from</span> <span class="string">&#x27;vite&#x27;</span></span><br><span class="line"><span class="keyword">import</span> vue <span class="keyword">from</span> <span class="string">&#x27;@vitejs/plugin-vue&#x27;</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">AutoImport</span> <span class="keyword">from</span> <span class="string">&#x27;unplugin-auto-import/vite&#x27;</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">Components</span> <span class="keyword">from</span> <span class="string">&#x27;unplugin-vue-components/vite&#x27;</span></span><br><span class="line"><span class="keyword">import</span> &#123; <span class="title class_">ElementPlusResolver</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;unplugin-vue-components/resolvers&#x27;</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="title function_">defineConfig</span>(&#123;</span><br><span class="line">  <span class="attr">plugins</span>: [</span><br><span class="line">    <span class="title function_">vue</span>(),</span><br><span class="line">    <span class="title class_">AutoImport</span>(&#123;</span><br><span class="line">      <span class="attr">resolvers</span>: [<span class="title class_">ElementPlusResolver</span>()],</span><br><span class="line">    &#125;),</span><br><span class="line">    <span class="title class_">Components</span>(&#123;</span><br><span class="line">      <span class="attr">resolvers</span>: [<span class="title class_">ElementPlusResolver</span>(&#123;<span class="attr">importStyle</span>: <span class="string">&quot;sass&quot;</span>&#125;)],</span><br><span class="line">    &#125;),</span><br><span class="line">  ],</span><br><span class="line">  <span class="attr">resolve</span>: &#123;</span><br><span class="line">    <span class="attr">alias</span>: &#123;</span><br><span class="line">      <span class="string">&#x27;@&#x27;</span>: <span class="title function_">fileURLToPath</span>(<span class="keyword">new</span> <span class="title function_">URL</span>(<span class="string">&#x27;./src&#x27;</span>, <span class="keyword">import</span>.<span class="property">meta</span>.<span class="property">url</span>))</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">css</span>: &#123;</span><br><span class="line">    <span class="attr">preprocessorOptions</span>: &#123;</span><br><span class="line">      <span class="attr">scss</span>: &#123;</span><br><span class="line">        <span class="comment">// 自动导入定制化样式文件进行样式覆盖</span></span><br><span class="line">        <span class="attr">additionalData</span>: <span class="string">`</span></span><br><span class="line"><span class="string">          @use &quot;@/styles/element/index.scss&quot; as *;</span></span><br><span class="line"><span class="string">        `</span>,</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><h1 id="axios安装并简单封装"><a href="#axios安装并简单封装" class="headerlink" title="axios安装并简单封装"></a>axios安装并简单封装</h1></div><div class="story post-story"><h2 id="安装axios"><a href="#安装axios" class="headerlink" title="安装axios"></a>安装axios</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm i axios</span><br></pre></td></tr></table></figure></div><div class="story post-story"><h2 id="基础配置"><a href="#基础配置" class="headerlink" title="基础配置"></a>基础配置</h2><blockquote><p>官方文档地址：<a href="https://axios-http.com/zh/docs/intro">https://axios-http.com/zh/docs/intro</a><br>基础配置通常包括：</p><ol><li>实例化 - baseURL + timeout</li><li>拦截器 - 携带token 401拦截等</li></ol></blockquote><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> router <span class="keyword">from</span> <span class="string">&#x27;@/router&#x27;</span></span><br><span class="line"><span class="keyword">import</span> &#123; useUserStore &#125; <span class="keyword">from</span> <span class="string">&#x27;@/stores/user&#x27;</span></span><br><span class="line"><span class="keyword">import</span> axios <span class="keyword">from</span> <span class="string">&#x27;axios&#x27;</span></span><br><span class="line"><span class="keyword">import</span> &#123; <span class="title class_">ElMessage</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;element-plus&#x27;</span></span><br><span class="line"><span class="keyword">import</span> <span class="string">&#x27;element-plus/theme-chalk/el-message.css&#x27;</span></span><br><span class="line"><span class="comment">// 创建axios实例</span></span><br><span class="line"><span class="keyword">const</span> httpInstance = axios.<span class="title function_">create</span>(&#123;</span><br><span class="line">    <span class="attr">baseURL</span>: <span class="string">&#x27;http://pcapi-xiaotuxian-front-devtest.itheima.net&#x27;</span>,</span><br><span class="line">    <span class="attr">timeout</span>: <span class="number">5000</span></span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment">// axios请求拦截器</span></span><br><span class="line">httpInstance.<span class="property">interceptors</span>.<span class="property">request</span>.<span class="title function_">use</span>(<span class="function"><span class="params">config</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">const</span> userStore = <span class="title function_">useUserStore</span>()</span><br><span class="line">    <span class="keyword">const</span> token = userStore.<span class="property">userInfo</span>.<span class="property">token</span></span><br><span class="line">    <span class="keyword">if</span> (token) &#123;</span><br><span class="line">        config.<span class="property">headers</span>.<span class="property">Authorization</span> = <span class="string">`Bearer <span class="subst">$&#123;token&#125;</span>`</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> config</span><br><span class="line">&#125;, <span class="function"><span class="params">e</span> =&gt;</span> <span class="title class_">Promise</span>.<span class="title function_">reject</span>(e))</span><br><span class="line"></span><br><span class="line"><span class="comment">// axios响应式拦截器</span></span><br><span class="line">httpInstance.<span class="property">interceptors</span>.<span class="property">response</span>.<span class="title function_">use</span>(<span class="function"><span class="params">res</span> =&gt;</span> res.<span class="property">data</span>, <span class="function"><span class="params">e</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">const</span> userStore = <span class="title function_">useUserStore</span>()</span><br><span class="line">    <span class="title class_">ElMessage</span>(&#123;</span><br><span class="line">        <span class="attr">type</span>: <span class="string">&#x27;warning&#x27;</span>,</span><br><span class="line">        <span class="attr">message</span>: e.<span class="property">response</span>.<span class="property">data</span>.<span class="property">message</span></span><br><span class="line">    &#125;)</span><br><span class="line">    <span class="comment">//401token失效处理</span></span><br><span class="line">    <span class="keyword">if</span> (e.<span class="property">response</span>.<span class="property">status</span> === <span class="number">401</span>) &#123;</span><br><span class="line">        userStore.<span class="title function_">clearUserInfo</span>()</span><br><span class="line">        router.<span class="title function_">push</span>(<span class="string">&#x27;/login&#x27;</span>)</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="title class_">Promise</span>.<span class="title function_">reject</span>(e)</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> httpInstance</span><br></pre></td></tr></table></figure></div><div class="story post-story"><h2 id="封装请求函数并测试"><a href="#封装请求函数并测试" class="headerlink" title="封装请求函数并测试"></a>封装请求函数并测试</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> http <span class="keyword">from</span> <span class="string">&#x27;@/utils/http&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">function</span> <span class="title function_">getCategoryAPI</span> (<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="title function_">http</span>(&#123;</span><br><span class="line">    <span class="attr">url</span>: <span class="string">&#x27;home/category/head&#x27;</span></span><br><span class="line">  &#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="路由整体设计"><a href="#路由整体设计" class="headerlink" title="路由整体设计"></a>路由整体设计</h1><p>路由设计原则：找页面的切换方式，如果是整体切换，则为一级路由，如果是在一级路由的内部进行的内容切换，则为二级路由</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">template</span>&gt;</span></span><br><span class="line">  我是登录页</span><br><span class="line"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br></pre></td></tr></table></figure><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">template</span>&gt;</span></span><br><span class="line">  我是首页</span><br><span class="line"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br></pre></td></tr></table></figure><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">template</span>&gt;</span></span><br><span class="line">  我是home</span><br><span class="line"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br></pre></td></tr></table></figure><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">template</span>&gt;</span></span><br><span class="line">  我是分类</span><br><span class="line"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br></pre></td></tr></table></figure><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// createRouter：创建router实例对象</span></span><br><span class="line"><span class="comment">// createWebHistory：创建history模式的路由</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> &#123; createRouter, createWebHistory &#125; <span class="keyword">from</span> <span class="string">&#x27;vue-router&#x27;</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">Login</span> <span class="keyword">from</span> <span class="string">&#x27;@/views/Login/index.vue&#x27;</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">Layout</span> <span class="keyword">from</span> <span class="string">&#x27;@/views/Layout/index.vue&#x27;</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">Home</span> <span class="keyword">from</span> <span class="string">&#x27;@/views/Home/index.vue&#x27;</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">Category</span> <span class="keyword">from</span> <span class="string">&#x27;@/views/Category/index.vue&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> router = <span class="title function_">createRouter</span>(&#123;</span><br><span class="line">  <span class="attr">history</span>: <span class="title function_">createWebHistory</span>(<span class="keyword">import</span>.<span class="property">meta</span>.<span class="property">env</span>.<span class="property">BASE_URL</span>),</span><br><span class="line">  <span class="comment">// path和component对应关系的位置</span></span><br><span class="line">  <span class="attr">routes</span>: [</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="attr">path</span>: <span class="string">&#x27;/&#x27;</span>,</span><br><span class="line">      <span class="attr">component</span>: <span class="title class_">Layout</span>,</span><br><span class="line">      <span class="attr">children</span>: [</span><br><span class="line">        &#123;</span><br><span class="line">          <span class="attr">path</span>: <span class="string">&#x27;&#x27;</span>,</span><br><span class="line">          <span class="attr">component</span>: <span class="title class_">Home</span></span><br><span class="line">        &#125;,</span><br><span class="line">        &#123;</span><br><span class="line">          <span class="attr">path</span>: <span class="string">&#x27;category&#x27;</span>,</span><br><span class="line">          <span class="attr">component</span>: <span class="title class_">Category</span></span><br><span class="line">        &#125;</span><br><span class="line">      ]</span><br><span class="line">    &#125;,</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="attr">path</span>: <span class="string">&#x27;/login&#x27;</span>,</span><br><span class="line">      <span class="attr">component</span>: <span class="title class_">Login</span></span><br><span class="line">    &#125;</span><br><span class="line">  ]</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> router</span><br></pre></td></tr></table></figure><h1 id="静态资源引入和Error-Lens安装"><a href="#静态资源引入和Error-Lens安装" class="headerlink" title="静态资源引入和Error Lens安装"></a>静态资源引入和Error Lens安装</h1></div><div class="story post-story"><h2 id="静态资源引入"><a href="#静态资源引入" class="headerlink" title="静态资源引入"></a>静态资源引入</h2><ol><li>图片资源 - 把 images 文件夹放到 assets 目录下</li><li>样式资源 - 把 common.scss 文件放到 styles 目录下</li></ol></div><div class="story post-story"><h2 id="Error-Lens插件安装"><a href="#Error-Lens插件安装" class="headerlink" title="Error Lens插件安装"></a>Error Lens插件安装</h2><h1 id="scss变量自动导入"><a href="#scss变量自动导入" class="headerlink" title="scss变量自动导入"></a>scss变量自动导入</h1><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">//   <span class="attribute">src</span>/styles/<span class="selector-tag">var</span><span class="selector-class">.scss</span></span><br><span class="line">$xtxColor: <span class="number">#27ba9b</span>;</span><br><span class="line">$helpColor: <span class="number">#e26237</span>;</span><br><span class="line">$sucColor: <span class="number">#1dc779</span>;</span><br><span class="line">$warnColor: <span class="number">#ffb302</span>;</span><br><span class="line">$priceColor: <span class="number">#cf4444</span>;</span><br></pre></td></tr></table></figure><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">css<span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">    preprocessorOptions<span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">      scss<span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">        <span class="comment">// 自动导入scss文件</span></span><br><span class="line">        additionalData<span class="punctuation">:</span> `</span><br><span class="line">          @use <span class="string">&quot;@/styles/element/index.scss&quot;</span> as *;</span><br><span class="line">          @use <span class="string">&quot;@/styles/var.scss&quot;</span> as *;</span><br><span class="line">        `<span class="punctuation">,</span></span><br><span class="line">      <span class="punctuation">&#125;</span></span><br><span class="line">    <span class="punctuation">&#125;</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure><h1 id="懒加载指令实现"><a href="#懒加载指令实现" class="headerlink" title="懒加载指令实现"></a>懒加载指令实现</h1></div><div class="story post-story"><h2 id="封装全局指令"><a href="#封装全局指令" class="headerlink" title="封装全局指令"></a>封装全局指令</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; useIntersectionObserver &#125; <span class="keyword">from</span> <span class="string">&#x27;@vueuse/core&#x27;</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> lazyPlugin = &#123;</span><br><span class="line">    <span class="title function_">install</span>(<span class="params">app</span>) &#123;</span><br><span class="line">        app.<span class="title function_">directive</span>(<span class="string">&#x27;img-lazy&#x27;</span>, &#123;</span><br><span class="line">            <span class="title function_">mounted</span>(<span class="params">el, binding</span>) &#123;</span><br><span class="line">                <span class="comment">// el: 指令绑定的那个元素 img</span></span><br><span class="line">                <span class="comment">// binding: binding.value  指令等于号后面绑定的表达式的值  图片url</span></span><br><span class="line">                <span class="keyword">const</span> &#123; stop &#125; = <span class="title function_">useIntersectionObserver</span>(</span><br><span class="line">                    el,</span><br><span class="line">                    <span class="function">(<span class="params">[&#123; isIntersecting &#125;]</span>) =&gt;</span> &#123;</span><br><span class="line">                        <span class="keyword">if</span> (isIntersecting) &#123;</span><br><span class="line">                            el.<span class="property">src</span> = binding.<span class="property">value</span></span><br><span class="line">                            <span class="title function_">stop</span>()</span><br><span class="line">                        &#125;</span><br><span class="line">                    &#125;,</span><br><span class="line">                )</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">        &#125;)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div><div class="story post-story"><h2 id="注册全局指令"><a href="#注册全局指令" class="headerlink" title="注册全局指令"></a>注册全局指令</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 全局指令注册</span></span><br><span class="line"><span class="keyword">import</span> &#123; lazyPlugin &#125; <span class="keyword">from</span> <span class="string">&#x27;@/directives&#x27;</span></span><br><span class="line">app.<span class="title function_">use</span>(lazyPlugin)</span><br></pre></td></tr></table></figure></div><div class="story post-story"><h2 id="图片懒加载"><a href="#图片懒加载" class="headerlink" title="图片懒加载"></a>图片懒加载</h2><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;home-product&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">HomePanel</span> <span class="attr">:title</span>=<span class="string">&quot;cate.name&quot;</span> <span class="attr">v-for</span>=<span class="string">&quot;cate in goodsProduct&quot;</span> <span class="attr">:key</span>=<span class="string">&quot;cate.id&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;box&quot;</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">RouterLink</span> <span class="attr">class</span>=<span class="string">&quot;cover&quot;</span> <span class="attr">to</span>=<span class="string">&quot;/&quot;</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- 指令替换 --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">img</span> <span class="attr">v-img-lazy</span>=<span class="string">&quot;cate.picture&quot;</span> /&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">RouterLink</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">ul</span> <span class="attr">class</span>=<span class="string">&quot;goods-list&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">li</span> <span class="attr">v-for</span>=<span class="string">&quot;goods in cate.goods&quot;</span> <span class="attr">:key</span>=<span class="string">&quot;goods.id&quot;</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">RouterLink</span> <span class="attr">to</span>=<span class="string">&quot;/&quot;</span> <span class="attr">class</span>=<span class="string">&quot;goods-item&quot;</span>&gt;</span></span><br><span class="line">             <span class="comment">&lt;!-- 指令替换 --&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">img</span> <span class="attr">v-img-lazy</span>=<span class="string">&quot;goods.picture&quot;</span> <span class="attr">alt</span>=<span class="string">&quot;&quot;</span> /&gt;</span></span><br><span class="line">          <span class="tag">&lt;/<span class="name">RouterLink</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">HomePanel</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure><h1 id="路由缓存"><a href="#路由缓存" class="headerlink" title="路由缓存"></a>路由缓存</h1><p>路由缓存问题：路由只有参数变化时，会复用组件实例，导致页面不更新</p><p>解决方法：</p><ol><li>不在意性能，在RouterView标签里加key属性</li><li>选择路由的onBeforeRouteUpdate方法</li></ol><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_">onBeforeRouteUpdate</span>(<span class="function">(<span class="params">to</span>)=&gt;</span>&#123;</span><br><span class="line">    </span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><h1 id="路由切换自动滚动至顶部"><a href="#路由切换自动滚动至顶部" class="headerlink" title="路由切换自动滚动至顶部"></a>路由切换自动滚动至顶部</h1><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> router = <span class="title function_">createRouter</span>(&#123;</span><br><span class="line">  <span class="attr">history</span>: <span class="title function_">createWebHistory</span>(<span class="keyword">import</span>.<span class="property">meta</span>.<span class="property">env</span>.<span class="property">BASE_URL</span>),</span><br><span class="line">  <span class="attr">routes</span>: [...</span><br><span class="line">  ],</span><br><span class="line">  <span class="title function_">scrollBehavior</span>(<span class="params"></span>)&#123;</span><br><span class="line">    <span class="keyword">return</span> &#123;</span><br><span class="line">      <span class="attr">top</span>:<span class="number">0</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><h1 id="Pinia持久化存储"><a href="#Pinia持久化存储" class="headerlink" title="Pinia持久化存储"></a>Pinia持久化存储</h1><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; loginAPI &#125; <span class="keyword">from</span> <span class="string">&quot;@/apis/user&quot;</span></span><br><span class="line"><span class="keyword">import</span> &#123; defineStore &#125; <span class="keyword">from</span> <span class="string">&quot;pinia&quot;</span></span><br><span class="line"><span class="keyword">import</span> &#123; ref &#125; <span class="keyword">from</span> <span class="string">&quot;vue&quot;</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> useUserStore = <span class="title function_">defineStore</span>(<span class="string">&#x27;user&#x27;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">let</span> userInfo = <span class="title function_">ref</span>(&#123;&#125;)</span><br><span class="line">    <span class="keyword">const</span> <span class="title function_">getUserInfo</span> = <span class="keyword">async</span> (<span class="params">&#123; account, password &#125;</span>) =&gt; &#123;</span><br><span class="line">        <span class="keyword">const</span> res = <span class="keyword">await</span> <span class="title function_">loginAPI</span>(&#123; account, password &#125;)</span><br><span class="line">        userInfo.<span class="property">value</span> = res.<span class="property">result</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">const</span> <span class="title function_">clearUserInfo</span> = (<span class="params"></span>) =&gt; &#123;</span><br><span class="line">        userInfo.<span class="property">value</span> = &#123;&#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> &#123;</span><br><span class="line">        userInfo,</span><br><span class="line">        getUserInfo,</span><br><span class="line">        clearUserInfo</span><br><span class="line">    &#125;</span><br><span class="line">&#125;,</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="attr">persist</span>: <span class="literal">true</span>,</span><br><span class="line">    &#125;,</span><br><span class="line">)</span><br></pre></td></tr></table></figure></div><div class="story post-story"><h2 id="项目难点"><a href="#项目难点" class="headerlink" title="项目难点"></a>项目难点</h2><ol><li>对axios进行简单封装：首先使用axios的create方法创建axios实例，传入一个配置对象，对象包含baseURL还有超时时间等等。然后配置实例的请求拦截器和响应拦截器，这部分的代码基本框架比较重复，难点主要在业务逻辑。在请求拦截器中，如果token存在，则在请求头config.Header中添加一个Authorization字段,它的值就是bearer连接这个token,然后返回请求配置对象config。在响应拦截器中，配置请求出错时的错误处理函数，使用element-plus的ELMessage组件来显示服务器返回的错误信息，如果返回状态码为401表示未授权，就要进行token失效处理，这个时候需要清除用户信息并重定向到登录页面。</li><li>图片懒加载指令封装:首先查阅vueUse函数库发现有这么一个函数，叫做useIntersectionObserver，可以检测目标元素在窗口中是否可见。然后我就在项目的directives全局组件的文件夹里面定义懒加载插件,核心逻辑就是当图片进入到视口区域,就把url赋值给src,但是这样做会存在重复监听的问题,因为useIntersectionObserver对于元素的监听是一直存在的,除非手动停止监听,这样就存在一个内存浪费的问题，虽然图片已经加载完毕了,但是鼠标滑动时仍然在监听，这时要调用函数的返回对象的stop函数,让它对于已经加载好的图片不再重复监听。</li><li>使用pinia存储数据，主要分为三个部分，一个是用户的基本信息，输入账号密码登录之后后端会返回用户基本信息也包括token，相关的数据和方法要封装成一个独立的userStore给组件共用，用户信息用于展示，token用于配置请求拦截器和配置路由守卫。第二个是购物车，各个商品的添加、删除、计算总价这些，购物车信息需要存起来给多个组件使用。第三个是商品分类，主要是主页展示区域、顶部导航栏这些很多地方需要使用到商品的分类信息，如果每次都去请求后端，会造成很大的资源浪费，所以首次请求之后就存储起来，后面直接本地取数据就可以了。</li><li>支付宝第三方支付:提交订单，把购物车信息传到后端，返回订单id并跳转到待支付页面，这个地方做了一个倒计时,超时就关闭这个支付页面跳转回去。点击支付时需要把当前订单的id作为路由传参，点击支付调转到第三方支付页,支付成功后再跳转回来，并且携带支付状态信息。</li></ol></div>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;技术栈&quot;&gt;&lt;a href=&quot;#技术栈&quot; class=&quot;headerlink&quot; title=&quot;技术栈&quot;&gt;&lt;/a&gt;技术栈&lt;/h1&gt;&lt;p&gt;vue3+JavaScript+vue-router+pinia+element-plus+axios+echarts+vueuse</summary>
      
    
    
    
    <category term="项目" scheme="http://example.com/categories/%E9%A1%B9%E7%9B%AE/"/>
    
    
    <category term="vue" scheme="http://example.com/tags/vue/"/>
    
  </entry>
  
</feed>
